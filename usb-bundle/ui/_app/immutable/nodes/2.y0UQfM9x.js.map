{"version":3,"file":"2.y0UQfM9x.js","sources":["../../../../../../src/lib/map/style.ts","../../../../../../src/lib/map/shield.ts","../../../../../../src/lib/map/Map.svelte","../../../../../../src/lib/preprocessItinerary.ts","../../../../../../src/lib/i18n/bg.ts","../../../../../../src/lib/i18n/en.ts","../../../../../../src/lib/i18n/de.ts","../../../../../../src/lib/i18n/fr.ts","../../../../../../src/lib/i18n/pl.ts","../../../../../../src/lib/i18n/cs.ts","../../../../../../src/lib/i18n/translation.ts","../../../../../../src/lib/utils.ts","../../../../../../src/lib/map/Control.svelte","../../../../../../src/lib/components/ui/radio-group/radio-group.svelte","../../../../../../src/lib/components/ui/radio-group/radio-group-item.svelte","../../../../../../src/lib/components/ui/button/button.svelte","../../../../../../src/lib/components/ui/label/label.svelte","../../../../../../src/lib/Location.ts","../../../../../../src/lib/modeStyle.ts","../../../../../../src/lib/AddressTypeahead.svelte","../../../../../../src/lib/components/ui/select/select-item.svelte","../../../../../../src/lib/components/ui/select/select-content.svelte","../../../../../../src/lib/components/ui/select/select-trigger.svelte","../../../../../../src/lib/components/ui/separator/separator.svelte","../../../../../../src/lib/components/ui/select/select-scroll-down-button.svelte","../../../../../../src/lib/components/ui/select/select-scroll-up-button.svelte","../../../../../../src/lib/components/ui/select/index.ts","../../../../../../src/lib/components/ui/switch/switch.svelte","../../../../../../src/lib/defaults.ts","../../../../../../src/lib/formatDuration.ts","../../../../../../src/lib/Modes.ts","../../../../../../src/lib/NumberSelect.svelte","../../../../../../src/lib/map/rentals/assets.ts","../../../../../../src/lib/map/rentals/style.ts","../../../../../../src/lib/StreetModes.svelte","../../../../../../src/lib/TransitModeSelect.svelte","../../../../../../src/lib/generateTimes.ts","../../../../../../src/lib/ViaStopOptions.svelte","../../../../../../src/lib/AdvancedOptions.svelte","../../../../../../src/lib/DateInput.svelte","../../../../../../src/lib/SearchMask.svelte","../../../../../../src/lib/map/handleScroll.ts","../../../../../../src/lib/components/ui/card/card.svelte","../../../../../../src/lib/components/ui/card/card-content.svelte","../../../../../../src/lib/ErrorMessage.svelte","../../../../../../src/lib/toDateTime.ts","../../../../../../src/lib/Time.svelte","../../../../../../src/lib/DirectConnection.svelte","../../../../../../src/lib/ItineraryList.svelte","../../../../../../src/lib/Route.svelte","../../../../../../src/lib/components/ui/dialog/dialog-header.svelte","../../../../../../src/lib/components/ui/dialog/dialog-overlay.svelte","../../../../../../src/lib/components/ui/dialog/dialog-content.svelte","../../../../../../src/lib/components/ui/dialog/dialog-description.svelte","../../../../../../src/lib/components/ui/dialog/index.ts","../../../../../../src/lib/Alerts.svelte","../../../../../../src/lib/getModeName.ts","../../../../../../src/lib/map/getModeLabel.ts","../../../../../../src/lib/ConnectionDetail.svelte","../../../../../../src/lib/map/Layer.svelte","../../../../../../src/lib/map/GeoJSON.svelte","../../../../../../src/lib/map/itineraries/layerFilters.ts","../../../../../../src/lib/map/itineraries/itineraryLayers.ts","../../../../../../src/lib/map/itineraries/ItineraryGeoJSON.svelte","../../../../../../src/lib/components/ui/table/table.svelte","../../../../../../src/lib/components/ui/table/table-body.svelte","../../../../../../src/lib/components/ui/table/table-cell.svelte","../../../../../../src/lib/components/ui/table/table-head.svelte","../../../../../../src/lib/components/ui/table/table-header.svelte","../../../../../../src/lib/components/ui/table/table-row.svelte","../../../../../../src/lib/map/Marker.svelte","../../../../../../src/lib/map/Popup.svelte","../../../../../../src/lib/Debug.svelte","../../../../../../src/lib/lngLatToStr.ts","../../../../../../src/lib/constants.ts","../../../../../../src/lib/LevelSelect.svelte","../../../../../../src/lib/map/Drawer.svelte","../../../../../../src/lib/StopTimes.svelte","../../../../../../src/lib/components/ui/tabs/tabs-content.svelte","../../../../../../src/lib/components/ui/tabs/tabs-list.svelte","../../../../../../src/lib/components/ui/tabs/tabs-trigger.svelte","../../../../../../src/lib/components/ui/tabs/index.ts","../../../../../../src/lib/DeparturesMask.svelte","../../../../../../src/lib/map/IsochronesShared.ts","../../../../../../src/lib/map/Isochrones.svelte","../../../../../../src/lib/IsochronesInfo.svelte","../../../../../../src/lib/IsochronesMask.svelte","../../../../../../src/lib/map/rentals/StationPopup.svelte","../../../../../../src/lib/map/rentals/VehiclePopup.svelte","../../../../../../src/lib/map/rentals/ZonePopup.svelte","../../../../../../src/lib/map/rentals/zone-fill-layer.ts","../../../../../../src/lib/map/rentals/ZoneLayer.svelte","../../../../../../src/lib/map/rentals/Rentals.svelte","../../../../../../src/lib/map/stops/StopsGeoJSON.svelte","../../../../../../src/lib/map/createTripIcon.ts","../../../../../../src/lib/Color.ts","../../../../../../src/lib/RailViz.svelte","../../../../../../src/routes/+page.svelte"],"sourcesContent":["import type { StyleSpecification } from 'maplibre-gl';\nconst colors = {\n\tlight: {\n\t\tbackground: '#f8f4f0',\n\n\t\twater: '#99ddff',\n\t\trail: '#a8a8a8',\n\t\tpedestrian: '#e8e7eb',\n\t\tferryRoute: 'rgba(102, 102, 255, 0.5)',\n\n\t\tsport: '#d0f4be',\n\t\tsportOutline: '#b3e998',\n\n\t\tbuilding: '#ded7d3',\n\t\tbuildingOutline: '#cfc8c4',\n\n\t\tlanduseComplex: '#f0e6d1',\n\t\tlanduseCommercial: 'hsla(0, 60%, 87%, 0.23)',\n\t\tlanduseIndustrial: '#e0e2eb',\n\t\tlanduseResidential: '#ece7e4',\n\t\tlanduseRetail: 'hsla(0, 60%, 87%, 0.23)',\n\t\tlanduseConstruction: '#aaa69d',\n\n\t\tlandusePark: '#b8ebad',\n\t\tlanduseNatureLight: '#ddecd7',\n\t\tlanduseNatureHeavy: '#a3e39c',\n\t\tlanduseCemetery: '#e0e4dd',\n\t\tlanduseBeach: '#fffcd3',\n\n\t\tindoorCorridor: '#fdfcfa',\n\t\tindoor: '#d4edff',\n\t\tindoorOutline: '#808080',\n\t\tindoorText: '#333333',\n\n\t\tpublicTransport: 'rgba(218,140,140,0.3)',\n\n\t\tfootway: '#fff',\n\t\tsteps: '#ff4524',\n\n\t\televatorOutline: '#808080',\n\t\televator: '#bcf1ba',\n\n\t\troadBackResidential: '#ffffff',\n\t\troadBackNonResidential: '#ffffff',\n\n\t\tmotorway: '#ffb366',\n\t\tmotorwayLink: '#f7e06e',\n\t\tprimarySecondary: '#fffbf8',\n\t\tlinkTertiary: '#ffffff',\n\t\tresidential: '#ffffff',\n\t\troad: '#ffffff',\n\n\t\ttownText: '#333333',\n\t\ttownTextHalo: 'white',\n\t\ttext: '#333333',\n\t\ttextHalo: 'white',\n\t\tcitiesText: '#111111',\n\t\tcitiesTextHalo: 'white',\n\n\t\tshield: 'shield'\n\t},\n\tdark: {\n\t\tbackground: '#292929',\n\n\t\twater: '#1f2830',\n\t\trail: '#808080',\n\t\tpedestrian: '#292929',\n\t\tferryRoute: 'rgba(58, 77, 139, 0.5)',\n\n\t\tsport: '#272525',\n\t\tsportOutline: '#272525',\n\n\t\tbuilding: '#1F1F1F',\n\t\tbuildingOutline: '#1A1A1A',\n\n\t\tlanduseComplex: '#292929',\n\t\tlanduseCommercial: '#292929',\n\t\tlanduseIndustrial: '#353538',\n\t\tlanduseResidential: '#292929',\n\t\tlanduseRetail: '#292929',\n\t\tlanduseConstruction: 'red',\n\n\t\tlandusePark: '#18221f',\n\t\tlanduseNatureLight: '#1e2322',\n\t\tlanduseNatureHeavy: '#1a2020',\n\t\tlanduseCemetery: '#202423',\n\t\tlanduseBeach: '#4c4b3e',\n\n\t\tindoorCorridor: '#494949',\n\t\tindoor: '#1a1a1a',\n\t\tindoorOutline: '#0d0d0d',\n\t\tindoorText: '#eeeeee',\n\n\t\tpublicTransport: 'rgba(89, 45, 45, 0.405)',\n\n\t\tfootway: '#3D3D3D',\n\t\tsteps: '#70504b',\n\n\t\televatorOutline: '#808080',\n\t\televator: '#3b423b',\n\n\t\troadBackResidential: '#414141',\n\t\troadBackNonResidential: '#414141',\n\n\t\tmotorway: '#414141',\n\t\tmotorwayLink: '#414141',\n\t\tprimarySecondary: '#414141',\n\t\tlinkTertiary: '#414141',\n\t\tresidential: '#414141',\n\t\troad: '#414141',\n\n\t\ttext: '#9a9a9a',\n\t\ttextHalo: '#151515',\n\t\ttownText: '#bebebe',\n\t\ttownTextHalo: '#1A1A1A',\n\t\tcitiesText: '#bebebe',\n\t\tcitiesTextHalo: '#1A1A1A',\n\n\t\tshield: 'shield-dark'\n\t}\n};\n\nfunction getUrlBase(url: string): string {\n\tconst { origin, pathname } = new URL(url);\n\treturn origin + pathname.slice(0, pathname.lastIndexOf('/') + 1);\n}\n\n// this doesn't escape {}-parameters\nfunction getAbsoluteUrl(base: string, relative: string): string {\n\treturn getUrlBase(base) + relative;\n}\n\nexport const getStyle = (\n\ttheme: 'light' | 'dark',\n\tlevel: number,\n\tstaticBaseUrl: string,\n\tapiBaseUrl: string\n): StyleSpecification => {\n\tconst c = colors[theme];\n\treturn {\n\t\tversion: 8,\n\t\tsources: {\n\t\t\tosm: {\n\t\t\t\ttype: 'vector',\n\t\t\t\ttiles: [getAbsoluteUrl(apiBaseUrl, 'tiles/{z}/{x}/{y}.mvt')],\n\t\t\t\tmaxzoom: 20,\n\t\t\t\tattribution: ''\n\t\t\t}\n\t\t},\n\t\tglyphs: getAbsoluteUrl(apiBaseUrl, 'tiles/glyphs/{fontstack}/{range}.pbf'),\n\t\tsprite: getAbsoluteUrl(staticBaseUrl, 'sprite_sdf'),\n\t\tlayers: [\n\t\t\t{\n\t\t\t\tid: 'background',\n\t\t\t\ttype: 'background',\n\t\t\t\tpaint: { 'background-color': c.background }\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'coastline',\n\t\t\t\ttype: 'fill',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'coastline',\n\t\t\t\tpaint: { 'fill-color': c.water }\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'landuse_park',\n\t\t\t\ttype: 'fill',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'landuse',\n\t\t\t\tfilter: ['==', ['get', 'landuse'], 'park'],\n\t\t\t\tpaint: {\n\t\t\t\t\t'fill-color': c.landusePark\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'landuse',\n\t\t\t\ttype: 'fill',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'landuse',\n\t\t\t\tfilter: ['!in', 'landuse', 'park', 'public_transport'],\n\t\t\t\tpaint: {\n\t\t\t\t\t'fill-color': [\n\t\t\t\t\t\t'match',\n\t\t\t\t\t\t['get', 'landuse'],\n\t\t\t\t\t\t'complex',\n\t\t\t\t\t\tc.landuseComplex,\n\t\t\t\t\t\t'commercial',\n\t\t\t\t\t\tc.landuseCommercial,\n\t\t\t\t\t\t'industrial',\n\t\t\t\t\t\tc.landuseIndustrial,\n\t\t\t\t\t\t'residential',\n\t\t\t\t\t\tc.landuseResidential,\n\t\t\t\t\t\t'retail',\n\t\t\t\t\t\tc.landuseRetail,\n\t\t\t\t\t\t'construction',\n\t\t\t\t\t\tc.landuseConstruction,\n\n\t\t\t\t\t\t'nature_light',\n\t\t\t\t\t\tc.landuseNatureLight,\n\t\t\t\t\t\t'nature_heavy',\n\t\t\t\t\t\tc.landuseNatureHeavy,\n\t\t\t\t\t\t'cemetery',\n\t\t\t\t\t\tc.landuseCemetery,\n\t\t\t\t\t\t'beach',\n\t\t\t\t\t\tc.landuseBeach,\n\n\t\t\t\t\t\t'magenta'\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'water',\n\t\t\t\ttype: 'fill',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'water',\n\t\t\t\tpaint: { 'fill-color': c.water }\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'sport',\n\t\t\t\ttype: 'fill',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'sport',\n\t\t\t\tpaint: {\n\t\t\t\t\t'fill-color': c.sport,\n\t\t\t\t\t'fill-outline-color': c.sportOutline\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'pedestrian',\n\t\t\t\ttype: 'fill',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'pedestrian',\n\t\t\t\tpaint: { 'fill-color': c.pedestrian }\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'waterway',\n\t\t\t\ttype: 'line',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'waterway',\n\t\t\t\tpaint: { 'line-color': c.water }\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'building',\n\t\t\t\ttype: 'fill',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'building',\n\t\t\t\tpaint: {\n\t\t\t\t\t'fill-color': c.building,\n\t\t\t\t\t'fill-outline-color': c.buildingOutline,\n\t\t\t\t\t'fill-opacity': ['interpolate', ['linear'], ['zoom'], 14, 0, 16, 0.8]\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'indoor-corridor',\n\t\t\t\ttype: 'fill',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'indoor',\n\t\t\t\tfilter: ['all', ['==', 'indoor', 'corridor'], ['==', 'level', level]],\n\t\t\t\tpaint: {\n\t\t\t\t\t'fill-color': c.indoorCorridor,\n\t\t\t\t\t'fill-opacity': 0.8\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'indoor',\n\t\t\t\ttype: 'fill',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'indoor',\n\t\t\t\tfilter: ['all', ['!in', 'indoor', 'corridor', 'wall', 'elevator'], ['==', 'level', level]],\n\t\t\t\tpaint: {\n\t\t\t\t\t'fill-color': c.indoor,\n\t\t\t\t\t'fill-opacity': 0.8\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'indoor-outline',\n\t\t\t\ttype: 'line',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'indoor',\n\t\t\t\tfilter: ['all', ['!in', 'indoor', 'corridor', 'wall', 'elevator'], ['==', 'level', level]],\n\t\t\t\tminzoom: 18,\n\t\t\t\tpaint: {\n\t\t\t\t\t'line-color': c.indoorOutline,\n\t\t\t\t\t'line-width': 2\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'indoor-names',\n\t\t\t\ttype: 'symbol',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'indoor',\n\t\t\t\tminzoom: 18,\n\t\t\t\tfilter: ['any', ['!has', 'level'], ['==', 'level', level]],\n\t\t\t\tlayout: {\n\t\t\t\t\t'symbol-placement': 'point',\n\t\t\t\t\t'text-field': ['get', 'name'],\n\t\t\t\t\t'text-font': ['Noto Sans Regular'],\n\t\t\t\t\t'text-size': 12\n\t\t\t\t},\n\t\t\t\tpaint: {\n\t\t\t\t\t'text-color': c.indoorText\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'landuse-public-transport',\n\t\t\t\ttype: 'fill',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'landuse',\n\t\t\t\tfilter: [\n\t\t\t\t\t'all',\n\t\t\t\t\t['==', 'landuse', 'public_transport'],\n\t\t\t\t\t['any', ['!has', 'level'], ['==', 'level', level]]\n\t\t\t\t],\n\t\t\t\tpaint: {\n\t\t\t\t\t'fill-color': c.publicTransport\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'footway',\n\t\t\t\ttype: 'line',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'road',\n\t\t\t\tfilter: [\n\t\t\t\t\t'all',\n\t\t\t\t\t['in', 'highway', 'footway', 'track', 'cycleway', 'path', 'unclassified', 'service'],\n\t\t\t\t\tlevel === 0 ? ['any', ['!has', 'level'], ['==', 'level', level]] : ['==', 'level', level]\n\t\t\t\t],\n\t\t\t\tlayout: {\n\t\t\t\t\t'line-cap': 'round'\n\t\t\t\t},\n\t\t\t\tminzoom: 14,\n\t\t\t\tpaint: {\n\t\t\t\t\t'line-dasharray': [0.75, 1.5],\n\t\t\t\t\t'line-color': c.footway,\n\t\t\t\t\t'line-opacity': 0.5,\n\t\t\t\t\t'line-width': [\n\t\t\t\t\t\t'let',\n\t\t\t\t\t\t'base',\n\t\t\t\t\t\t0.4,\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t'interpolate',\n\t\t\t\t\t\t\t['linear'],\n\t\t\t\t\t\t\t['zoom'],\n\t\t\t\t\t\t\t5,\n\t\t\t\t\t\t\t['+', ['*', ['var', 'base'], 0.1], 1],\n\t\t\t\t\t\t\t9,\n\t\t\t\t\t\t\t['+', ['*', ['var', 'base'], 0.4], 1],\n\t\t\t\t\t\t\t12,\n\t\t\t\t\t\t\t['+', ['*', ['var', 'base'], 1], 1],\n\t\t\t\t\t\t\t16,\n\t\t\t\t\t\t\t['+', ['*', ['var', 'base'], 4], 1],\n\t\t\t\t\t\t\t20,\n\t\t\t\t\t\t\t['+', ['*', ['var', 'base'], 8], 1]\n\t\t\t\t\t\t]\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'stairs-ground',\n\t\t\t\ttype: 'line',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'road',\n\t\t\t\tminzoom: 18,\n\t\t\t\tfilter: [\n\t\t\t\t\t'all',\n\t\t\t\t\t['==', 'highway', 'steps'],\n\t\t\t\t\tlevel === 0\n\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t'any',\n\t\t\t\t\t\t\t\t['!has', 'from_level'],\n\t\t\t\t\t\t\t\t['any', ['==', 'from_level', level], ['==', 'to_level', level]]\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t: ['any', ['==', 'from_level', level], ['==', 'to_level', level]]\n\t\t\t\t],\n\t\t\t\tpaint: {\n\t\t\t\t\t'line-color': '#ddddddff',\n\t\t\t\t\t'line-width': [\n\t\t\t\t\t\t'interpolate',\n\t\t\t\t\t\t['exponential', 2],\n\t\t\t\t\t\t['zoom'],\n\t\t\t\t\t\t10,\n\t\t\t\t\t\t['*', 4, ['^', 2, -6]],\n\t\t\t\t\t\t24,\n\t\t\t\t\t\t['*', 4, ['^', 2, 8]]\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'stairs-steps',\n\t\t\t\ttype: 'line',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'road',\n\t\t\t\tminzoom: 18,\n\t\t\t\tfilter: [\n\t\t\t\t\t'all',\n\t\t\t\t\t['==', 'highway', 'steps'],\n\t\t\t\t\tlevel === 0\n\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t'any',\n\t\t\t\t\t\t\t\t['!has', 'from_level'],\n\t\t\t\t\t\t\t\t['any', ['==', 'from_level', level], ['==', 'to_level', level]]\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t: ['any', ['==', 'from_level', level], ['==', 'to_level', level]]\n\t\t\t\t],\n\t\t\t\tpaint: {\n\t\t\t\t\t'line-color': '#bfbfbf',\n\t\t\t\t\t'line-dasharray': ['literal', [0.01, 0.1]],\n\t\t\t\t\t'line-width': [\n\t\t\t\t\t\t'interpolate',\n\t\t\t\t\t\t['exponential', 2],\n\t\t\t\t\t\t['zoom'],\n\t\t\t\t\t\t10,\n\t\t\t\t\t\t['*', 4, ['^', 2, -6]],\n\t\t\t\t\t\t24,\n\t\t\t\t\t\t['*', 4, ['^', 2, 8]]\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'stairs-rail',\n\t\t\t\ttype: 'line',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'road',\n\t\t\t\tminzoom: 18,\n\t\t\t\tfilter: [\n\t\t\t\t\t'all',\n\t\t\t\t\t['==', 'highway', 'steps'],\n\t\t\t\t\tlevel === 0\n\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t'any',\n\t\t\t\t\t\t\t\t['!has', 'from_level'],\n\t\t\t\t\t\t\t\t['any', ['==', 'from_level', level], ['==', 'to_level', level]]\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t: ['any', ['==', 'from_level', level], ['==', 'to_level', level]]\n\t\t\t\t],\n\t\t\t\tpaint: {\n\t\t\t\t\t'line-color': '#808080',\n\t\t\t\t\t'line-width': [\n\t\t\t\t\t\t'interpolate',\n\t\t\t\t\t\t['exponential', 2],\n\t\t\t\t\t\t['zoom'],\n\t\t\t\t\t\t10,\n\t\t\t\t\t\t['*', 0.25, ['^', 2, -6]],\n\t\t\t\t\t\t24,\n\t\t\t\t\t\t['*', 0.25, ['^', 2, 8]]\n\t\t\t\t\t],\n\t\t\t\t\t'line-gap-width': [\n\t\t\t\t\t\t'interpolate',\n\t\t\t\t\t\t['exponential', 2],\n\t\t\t\t\t\t['zoom'],\n\t\t\t\t\t\t10,\n\t\t\t\t\t\t['*', 4, ['^', 2, -6]],\n\t\t\t\t\t\t24,\n\t\t\t\t\t\t['*', 4, ['^', 2, 8]]\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'indoor-elevator-outline',\n\t\t\t\ttype: 'circle',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'indoor',\n\t\t\t\tminzoom: 18,\n\t\t\t\tfilter: [\n\t\t\t\t\t'all',\n\t\t\t\t\t['==', 'indoor', 'elevator'],\n\t\t\t\t\t['<=', 'from_level', level],\n\t\t\t\t\t['>=', 'to_level', level]\n\t\t\t\t],\n\t\t\t\tpaint: {\n\t\t\t\t\t'circle-color': c.elevatorOutline,\n\t\t\t\t\t'circle-radius': 16\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'indoor-elevator',\n\t\t\t\ttype: 'circle',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'indoor',\n\t\t\t\tminzoom: 18,\n\t\t\t\tfilter: [\n\t\t\t\t\t'all',\n\t\t\t\t\t['==', 'indoor', 'elevator'],\n\t\t\t\t\t['<=', 'from_level', level],\n\t\t\t\t\t['>=', 'to_level', level]\n\t\t\t\t],\n\t\t\t\tpaint: {\n\t\t\t\t\t'circle-color': c.elevator,\n\t\t\t\t\t'circle-radius': 14\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'indoor-elevator-icon',\n\t\t\t\ttype: 'symbol',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'indoor',\n\t\t\t\tminzoom: 18,\n\t\t\t\tfilter: [\n\t\t\t\t\t'all',\n\t\t\t\t\t['==', 'indoor', 'elevator'],\n\t\t\t\t\t['<=', 'from_level', level],\n\t\t\t\t\t['>=', 'to_level', level]\n\t\t\t\t],\n\t\t\t\tlayout: {\n\t\t\t\t\t'icon-image': 'elevator',\n\t\t\t\t\t'icon-size': 0.9\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'road_back_residential',\n\t\t\t\ttype: 'line',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'road',\n\t\t\t\tfilter: ['==', 'highway', 'residential'],\n\t\t\t\tlayout: {\n\t\t\t\t\t'line-cap': 'round'\n\t\t\t\t},\n\t\t\t\tpaint: {\n\t\t\t\t\t'line-color': c.roadBackResidential,\n\t\t\t\t\t'line-width': ['interpolate', ['linear'], ['zoom'], 5, 0, 9, 0.5, 12, 1, 16, 4, 20, 20],\n\t\t\t\t\t'line-opacity': ['interpolate', ['linear'], ['zoom'], 12, 0.4, 15, 1]\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'road_back_non_residential',\n\t\t\t\ttype: 'line',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'road',\n\t\t\t\tfilter: [\n\t\t\t\t\t'!in',\n\t\t\t\t\t'highway',\n\t\t\t\t\t'footway',\n\t\t\t\t\t'track',\n\t\t\t\t\t'steps',\n\t\t\t\t\t'cycleway',\n\t\t\t\t\t'path',\n\t\t\t\t\t'unclassified',\n\t\t\t\t\t'residential',\n\t\t\t\t\t'service'\n\t\t\t\t],\n\t\t\t\tlayout: {\n\t\t\t\t\t'line-cap': 'round'\n\t\t\t\t},\n\t\t\t\tpaint: {\n\t\t\t\t\t'line-color': c.roadBackNonResidential,\n\t\t\t\t\t'line-width': [\n\t\t\t\t\t\t'let',\n\t\t\t\t\t\t'base',\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t'match',\n\t\t\t\t\t\t\t['get', 'highway'],\n\t\t\t\t\t\t\t'motorway',\n\t\t\t\t\t\t\t4,\n\t\t\t\t\t\t\t['trunk', 'motorway_link'],\n\t\t\t\t\t\t\t3.5,\n\t\t\t\t\t\t\t['primary', 'secondary', 'aeroway', 'trunk_link'],\n\t\t\t\t\t\t\t3,\n\t\t\t\t\t\t\t['primary_link', 'secondary_link', 'tertiary', 'tertiary_link'],\n\t\t\t\t\t\t\t1.75,\n\t\t\t\t\t\t\t0.0\n\t\t\t\t\t\t],\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t'interpolate',\n\t\t\t\t\t\t\t['linear'],\n\t\t\t\t\t\t\t['zoom'],\n\t\t\t\t\t\t\t5,\n\t\t\t\t\t\t\t['+', ['*', ['var', 'base'], 0.1], 1],\n\t\t\t\t\t\t\t9,\n\t\t\t\t\t\t\t['+', ['*', ['var', 'base'], 0.4], 1],\n\t\t\t\t\t\t\t12,\n\t\t\t\t\t\t\t['+', ['*', ['var', 'base'], 1], 1],\n\t\t\t\t\t\t\t16,\n\t\t\t\t\t\t\t['+', ['*', ['var', 'base'], 4], 1],\n\t\t\t\t\t\t\t20,\n\t\t\t\t\t\t\t['+', ['*', ['var', 'base'], 8], 1]\n\t\t\t\t\t\t]\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'road',\n\t\t\t\ttype: 'line',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'road',\n\t\t\t\tlayout: {\n\t\t\t\t\t'line-cap': 'round'\n\t\t\t\t},\n\t\t\t\tfilter: [\n\t\t\t\t\t'all',\n\t\t\t\t\t['has', 'ref'],\n\t\t\t\t\t[\n\t\t\t\t\t\t'any',\n\t\t\t\t\t\t['==', ['get', 'highway'], 'motorway'],\n\t\t\t\t\t\t['==', ['get', 'highway'], 'trunk'],\n\t\t\t\t\t\t['==', ['get', 'highway'], 'secondary'],\n\t\t\t\t\t\t['>', ['zoom'], 11]\n\t\t\t\t\t]\n\t\t\t\t],\n\t\t\t\tpaint: {\n\t\t\t\t\t'line-color': [\n\t\t\t\t\t\t'match',\n\t\t\t\t\t\t['get', 'highway'],\n\t\t\t\t\t\t'motorway',\n\t\t\t\t\t\tc.motorway,\n\t\t\t\t\t\t['trunk', 'motorway_link'],\n\t\t\t\t\t\tc.motorwayLink,\n\t\t\t\t\t\t['primary', 'secondary', 'aeroway', 'trunk_link'],\n\t\t\t\t\t\tc.primarySecondary,\n\t\t\t\t\t\t['primary_link', 'secondary_link', 'tertiary', 'tertiary_link'],\n\t\t\t\t\t\tc.linkTertiary,\n\t\t\t\t\t\t'residential',\n\t\t\t\t\t\tc.residential,\n\t\t\t\t\t\tc.road\n\t\t\t\t\t],\n\t\t\t\t\t'line-width': [\n\t\t\t\t\t\t'let',\n\t\t\t\t\t\t'base',\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t'match',\n\t\t\t\t\t\t\t['get', 'highway'],\n\t\t\t\t\t\t\t'motorway',\n\t\t\t\t\t\t\t3.5,\n\t\t\t\t\t\t\t['trunk', 'motorway_link'],\n\t\t\t\t\t\t\t3,\n\t\t\t\t\t\t\t['primary', 'secondary', 'aeroway', 'trunk_link'],\n\t\t\t\t\t\t\t2.5,\n\t\t\t\t\t\t\t['primary_link', 'secondary_link', 'tertiary', 'tertiary_link'],\n\t\t\t\t\t\t\t1.75,\n\t\t\t\t\t\t\t'residential',\n\t\t\t\t\t\t\t1.5,\n\t\t\t\t\t\t\t0.75\n\t\t\t\t\t\t],\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t'interpolate',\n\t\t\t\t\t\t\t['linear'],\n\t\t\t\t\t\t\t['zoom'],\n\t\t\t\t\t\t\t5,\n\t\t\t\t\t\t\t['*', ['var', 'base'], 0.5],\n\t\t\t\t\t\t\t9,\n\t\t\t\t\t\t\t['*', ['var', 'base'], 1],\n\t\t\t\t\t\t\t12,\n\t\t\t\t\t\t\t['*', ['var', 'base'], 2],\n\t\t\t\t\t\t\t16,\n\t\t\t\t\t\t\t['*', ['var', 'base'], 2.5],\n\t\t\t\t\t\t\t20,\n\t\t\t\t\t\t\t['*', ['var', 'base'], 3]\n\t\t\t\t\t\t]\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'ferry_routes',\n\t\t\t\ttype: 'line',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'ferry',\n\t\t\t\tpaint: {\n\t\t\t\t\t'line-width': 1.5,\n\t\t\t\t\t'line-dasharray': [2, 3],\n\t\t\t\t\t'line-color': c.ferryRoute\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'rail_detail',\n\t\t\t\ttype: 'line',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'rail',\n\t\t\t\tfilter: ['==', 'rail', 'detail'],\n\t\t\t\tpaint: {\n\t\t\t\t\t'line-color': c.rail\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'rail_secondary',\n\t\t\t\ttype: 'line',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'rail',\n\t\t\t\tfilter: [\n\t\t\t\t\t'all',\n\t\t\t\t\t['==', 'rail', 'secondary'],\n\t\t\t\t\t['any', ['!has', 'level'], ['==', 'level', level]]\n\t\t\t\t],\n\t\t\t\tpaint: {\n\t\t\t\t\t'line-color': c.rail,\n\t\t\t\t\t'line-width': 1.15\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'rail_primary',\n\t\t\t\ttype: 'line',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'rail',\n\t\t\t\tfilter: [\n\t\t\t\t\t'all',\n\t\t\t\t\t['==', 'rail', 'primary'],\n\t\t\t\t\t['any', ['!has', 'level'], ['==', 'level', level]]\n\t\t\t\t],\n\t\t\t\tpaint: {\n\t\t\t\t\t'line-color': c.rail,\n\t\t\t\t\t'line-width': 1.3\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'road-ref-shield',\n\t\t\t\ttype: 'symbol',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'road',\n\t\t\t\tminzoom: 6,\n\t\t\t\tfilter: [\n\t\t\t\t\t'all',\n\t\t\t\t\t['has', 'ref'],\n\t\t\t\t\t[\n\t\t\t\t\t\t'any',\n\t\t\t\t\t\t['==', ['get', 'highway'], 'motorway'],\n\t\t\t\t\t\t['==', ['get', 'highway'], 'trunk'],\n\t\t\t\t\t\t['==', ['get', 'highway'], 'secondary'],\n\t\t\t\t\t\t['>', ['zoom'], 11]\n\t\t\t\t\t]\n\t\t\t\t],\n\t\t\t\tlayout: {\n\t\t\t\t\t'symbol-placement': 'line',\n\t\t\t\t\t'text-field': ['get', 'ref'],\n\t\t\t\t\t'text-font': ['Noto Sans Regular'],\n\t\t\t\t\t'text-size': ['case', ['==', ['get', 'highway'], 'motorway'], 11, 10],\n\t\t\t\t\t'text-justify': 'center',\n\t\t\t\t\t'text-rotation-alignment': 'viewport',\n\t\t\t\t\t'text-pitch-alignment': 'viewport',\n\t\t\t\t\t'icon-image': c.shield,\n\t\t\t\t\t'icon-text-fit': 'both',\n\t\t\t\t\t'icon-text-fit-padding': [0.5, 4, 0.5, 4],\n\t\t\t\t\t'icon-rotation-alignment': 'viewport',\n\t\t\t\t\t'icon-pitch-alignment': 'viewport'\n\t\t\t\t},\n\t\t\t\tpaint: {\n\t\t\t\t\t'text-color': c.text\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'road-name-text',\n\t\t\t\ttype: 'symbol',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'road',\n\t\t\t\tminzoom: 14,\n\t\t\t\tlayout: {\n\t\t\t\t\t'symbol-placement': 'line',\n\t\t\t\t\t'text-field': ['get', 'name'],\n\t\t\t\t\t'text-font': ['Noto Sans Regular'],\n\t\t\t\t\t'text-size': 9\n\t\t\t\t},\n\t\t\t\tpaint: {\n\t\t\t\t\t'text-halo-width': 11,\n\t\t\t\t\t'text-halo-color': c.textHalo,\n\t\t\t\t\t'text-color': c.text\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'towns',\n\t\t\t\ttype: 'symbol',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'cities',\n\t\t\t\tfilter: ['!=', ['get', 'place'], 'city'],\n\t\t\t\tlayout: {\n\t\t\t\t\t// \"symbol-sort-key\": [\"get\", \"population\"],\n\t\t\t\t\t'text-field': ['get', 'name'],\n\t\t\t\t\t'text-font': ['Noto Sans Regular'],\n\t\t\t\t\t'text-size': 12\n\t\t\t\t},\n\t\t\t\tpaint: {\n\t\t\t\t\t'text-halo-width': 1,\n\t\t\t\t\t'text-halo-color': c.textHalo,\n\t\t\t\t\t'text-color': c.text\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'cities',\n\t\t\t\ttype: 'symbol',\n\t\t\t\tsource: 'osm',\n\t\t\t\t'source-layer': 'cities',\n\t\t\t\tfilter: ['==', ['get', 'place'], 'city'],\n\t\t\t\tlayout: {\n\t\t\t\t\t'symbol-sort-key': ['-', ['coalesce', ['get', 'population'], 0]],\n\t\t\t\t\t'text-field': ['get', 'name'],\n\t\t\t\t\t'text-font': ['Noto Sans Bold'],\n\t\t\t\t\t'text-size': ['interpolate', ['linear'], ['zoom'], 6, 12, 9, 16]\n\t\t\t\t},\n\t\t\t\tpaint: {\n\t\t\t\t\t'text-halo-width': 2,\n\t\t\t\t\t'text-halo-color': 'white',\n\t\t\t\t\t'text-color': 'hsl(0, 0%, 20%)'\n\t\t\t\t}\n\t\t\t\t// }, {\n\t\t\t\t//    \"id\": \"tiles_debug_info_bound\",\n\t\t\t\t//    \"type\": \"line\",\n\t\t\t\t//    \"source\": \"osm\",\n\t\t\t\t//    \"source-layer\": \"tiles_debug_info\",\n\t\t\t\t//    \"paint\": {\n\t\t\t\t//      \"line-color\": \"magenta\",\n\t\t\t\t//      \"line-width\": 1\n\t\t\t\t//    }\n\t\t\t\t// }, {\n\t\t\t\t//     \"id\": \"tiles_debug_info_name\",\n\t\t\t\t//     \"type\": \"symbol\",\n\t\t\t\t//     \"source\": \"osm\",\n\t\t\t\t//     \"source-layer\": \"tiles_debug_info\",\n\t\t\t\t//     \"layout\": {\n\t\t\t\t//       \"text-field\": [\"get\", \"tile_id\"],\n\t\t\t\t//       \"text-font\": [\"Noto Sans Bold\"],\n\t\t\t\t//       \"text-size\": 16,\n\t\t\t\t//     },\n\t\t\t\t//     \"paint\": {\n\t\t\t\t//       \"text-halo-width\": 2,\n\t\t\t\t//       \"text-halo-color\": \"white\",\n\t\t\t\t//       \"text-color\": \"hsl(0, 0%, 20%)\"\n\t\t\t\t//     }\n\t\t\t}\n\t\t]\n\t};\n};\n","import { browser } from '$app/environment';\nimport type { StyleImageMetadata } from 'maplibre-gl';\n\nclass ShieldOptions {\n\tfill!: string;\n\tstroke!: string;\n}\n\nexport function createShield(opt: ShieldOptions): [ImageData, Partial<StyleImageMetadata>] {\n\tif (!browser) {\n\t\tthrow 'not supported';\n\t}\n\n\tconst d = 32;\n\n\tconst cv = document.createElement('canvas');\n\tcv.width = d;\n\tcv.height = d;\n\tconst ctx = cv.getContext('2d')!;\n\n\t// coord of the line (front = near zero, back = opposite)\n\tconst l_front = 1;\n\tconst l_back = d - 1;\n\n\t// coord start of the arc\n\tconst lr_front = l_front + 2;\n\tconst lr_back = l_back - 2;\n\n\t// control point of the arc\n\tconst lp_front = l_front + 1;\n\tconst lp_back = l_back - 1;\n\n\tconst p = new Path2D();\n\tp.moveTo(lr_front, l_front);\n\n\t// top line\n\tp.lineTo(lr_back, l_front);\n\t// top right corner\n\tp.bezierCurveTo(lp_back, lp_front, lp_back, lp_front, l_back, lr_front);\n\t// right line\n\tp.lineTo(l_back, lr_back);\n\t// bottom right corner\n\tp.bezierCurveTo(lp_back, lp_back, lp_back, lp_back, lr_back, l_back);\n\t// bottom line\n\tp.lineTo(lr_front, l_back);\n\t// bottom left corner\n\tp.bezierCurveTo(lp_front, lp_back, lp_front, lp_back, l_front, lr_back);\n\t// left line\n\tp.lineTo(l_front, lr_front);\n\t// top left corner\n\tp.bezierCurveTo(lp_front, lp_front, lp_front, lp_front, lr_front, l_front);\n\n\tp.closePath();\n\n\tctx.fillStyle = opt.fill;\n\tctx.fill(p);\n\tctx.strokeStyle = opt.stroke;\n\tctx.stroke(p);\n\n\treturn [\n\t\tctx.getImageData(0, 0, d, d),\n\t\t{\n\t\t\tcontent: [lr_front, lr_front, lr_back, lr_back],\n\t\t\tstretchX: [[lr_front, lr_back]],\n\t\t\tstretchY: [[lr_front, lr_back]]\n\t\t}\n\t];\n}\n","<script lang=\"ts\">\n\timport maplibregl from 'maplibre-gl';\n\timport { setContext, type Snippet } from 'svelte';\n\timport 'maplibre-gl/dist/maplibre-gl.css';\n\timport { createShield } from './shield';\n\timport { browser } from '$app/environment';\n\tlet {\n\t\tmap = $bindable(),\n\t\tzoom = $bindable(),\n\t\tbounds = $bindable(),\n\t\tcenter = $bindable(),\n\t\tstyle,\n\t\tattribution,\n\t\ttransformRequest,\n\t\tchildren,\n\t\tclass: className\n\t}: {\n\t\tmap?: maplibregl.Map;\n\t\tstyle: maplibregl.StyleSpecification | undefined;\n\t\tattribution: string | undefined | false;\n\t\ttransformRequest?: maplibregl.RequestTransformFunction;\n\t\tcenter: maplibregl.LngLatLike;\n\t\tbounds?: maplibregl.LngLatBoundsLike | undefined;\n\t\tzoom: number;\n\t\tchildren?: Snippet;\n\t\tclass: string;\n\t} = $props();\n\n\tlet el: HTMLElement | null = null;\n\tlet currStyle: maplibregl.StyleSpecification | undefined = style;\n\tlet ctx = $state<{ map: maplibregl.Map | undefined }>({ map: undefined });\n\tsetContext('map', ctx);\n\n\tconst updateStyle = () => {\n\t\tif (style != currStyle) {\n\t\t\tif (!ctx.map && el) {\n\t\t\t\tcreateMap(el);\n\t\t\t} else if (ctx.map) {\n\t\t\t\tctx.map.setStyle(style || null);\n\t\t\t}\n\t\t\tcurrStyle = style;\n\t\t}\n\t};\n\tconst createMap = (container: HTMLElement) => {\n\t\tif (!style) {\n\t\t\treturn;\n\t\t}\n\t\tlet tmp: maplibregl.Map;\n\t\ttry {\n\t\t\ttmp = new maplibregl.Map({\n\t\t\t\tcontainer,\n\t\t\t\tzoom,\n\t\t\t\tbounds,\n\t\t\t\tcenter,\n\t\t\t\tstyle,\n\t\t\t\tpitchWithRotate: false,\n\t\t\t\tfadeDuration: 0,\n\t\t\t\ttransformRequest,\n\t\t\t\tattributionControl:\n\t\t\t\t\tattribution === false || attribution === undefined\n\t\t\t\t\t\t? attribution\n\t\t\t\t\t\t: { customAttribution: attribution }\n\t\t\t});\n\t\t\ttmp.addImage(\n\t\t\t\t'shield',\n\t\t\t\t...createShield({\n\t\t\t\t\tfill: 'hsl(0, 0%, 98%)',\n\t\t\t\t\tstroke: 'hsl(0, 0%, 75%)'\n\t\t\t\t})\n\t\t\t);\n\n\t\t\ttmp.addImage(\n\t\t\t\t'shield-dark',\n\t\t\t\t...createShield({\n\t\t\t\t\tfill: 'hsl(0, 0%, 16%)',\n\t\t\t\t\tstroke: 'hsl(0, 0%, 30%)'\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tconst scale = new maplibregl.ScaleControl({\n\t\t\t\tmaxWidth: 100,\n\t\t\t\tunit: 'metric'\n\t\t\t});\n\n\t\t\ttmp.addControl(scale, browser && window.innerWidth < 768 ? 'top-left' : 'bottom-left');\n\n\t\t\ttmp.on('load', () => {\n\t\t\t\tmap = tmp;\n\t\t\t\tctx.map = tmp;\n\t\t\t\tbounds = tmp.getBounds();\n\t\t\t\ttmp.on('moveend', () => {\n\t\t\t\t\tzoom = tmp.getZoom();\n\t\t\t\t\tcenter = tmp.getCenter();\n\t\t\t\t\tbounds = tmp.getBounds();\n\t\t\t\t});\n\t\t\t});\n\t\t} catch (e) {\n\t\t\tconsole.log(e);\n\t\t}\n\n\t\treturn {\n\t\t\tdestroy() {\n\t\t\t\ttmp?.remove();\n\t\t\t\tctx.map = undefined;\n\t\t\t}\n\t\t};\n\t};\n\n\t$effect(updateStyle);\n</script>\n\n<div use:createMap bind:this={el} class={className}>\n\t{#if children}\n\t\t{@render children()}\n\t{/if}\n</div>\n","import type {\n\tItinerary,\n\tPlace,\n\tPlanResponse,\n\tError as ApiError\n} from '@motis-project/motis-client';\nimport type { Location } from '$lib/Location';\nimport polyline from '@mapbox/polyline';\nimport type { RequestResult } from '@hey-api/client-fetch';\n\nexport const joinInterlinedLegs = (it: Itinerary) => {\n\tconst joinedLegs = [];\n\tfor (let i = 0; i < it.legs.length; i++) {\n\t\tif (it.legs[i].interlineWithPreviousLeg) {\n\t\t\tconst pred = joinedLegs[joinedLegs.length - 1];\n\t\t\tconst curr = it.legs[i];\n\t\t\tpred.intermediateStops!.push({ ...pred.to, switchTo: curr } as Place);\n\t\t\tpred.to = curr.to;\n\t\t\tpred.duration += curr.duration;\n\t\t\tpred.endTime = curr.endTime;\n\t\t\tpred.scheduledEndTime = curr.scheduledEndTime;\n\t\t\tpred.realTime ||= curr.realTime;\n\t\t\tpred.intermediateStops!.push(...curr.intermediateStops!);\n\t\t\tpred.legGeometry = {\n\t\t\t\tpoints: polyline.encode([\n\t\t\t\t\t...polyline.decode(pred.legGeometry.points),\n\t\t\t\t\t...polyline.decode(curr.legGeometry.points)\n\t\t\t\t]),\n\t\t\t\tprecision: pred.legGeometry.precision,\n\t\t\t\tlength: pred.legGeometry.length + curr.legGeometry.length\n\t\t\t};\n\t\t} else {\n\t\t\tjoinedLegs.push(it.legs[i]);\n\t\t}\n\t}\n\tit.legs = joinedLegs;\n};\n\nexport const preprocessItinerary = (from: Location, to: Location) => {\n\tconst updateItinerary = (it: Itinerary) => {\n\t\tif (it.legs[0].from.name === 'START') {\n\t\t\tit.legs[0].from.name = from.label!;\n\t\t}\n\t\tif (it.legs[it.legs.length - 1].to.name === 'END') {\n\t\t\tit.legs[it.legs.length - 1].to.name = to.label!;\n\t\t}\n\t\tjoinInterlinedLegs(it);\n\t};\n\n\treturn (r: Awaited<RequestResult<PlanResponse, ApiError, false>>): PlanResponse => {\n\t\tif (r.error) throw { error: r.error.error, status: r.response?.status };\n\t\tr.data.itineraries.forEach(updateItinerary);\n\t\tr.data.direct.forEach(updateItinerary);\n\n\t\treturn r.data;\n\t};\n};\n","import type { Translations } from './translation';\n\nconst translations: Translations = {\n\tticket: 'Билет',\n\tticketOptions: 'Опции за билет',\n\tincludedInTicket: 'Включено в билета',\n\tjourneyDetails: 'Детайли за пътуването',\n\ttransfers: 'прекачвания',\n\twalk: 'Пеша',\n\tbike: 'Велосипед',\n\tcargoBike: 'Товарен велосипед',\n\tscooterStanding: 'тротинетка',\n\tscooterSeated: 'тротинетка',\n\tcar: 'Автомобил',\n\ttaxi: 'Такси',\n\tmoped: 'Скутер',\n\tunknownVehicleType: 'Неизвестен тип превозно средство',\n\telectricAssist: 'Електрическа помощ',\n\telectric: 'Електрически',\n\tcombustion: 'Двигател с вътрешно горене',\n\tcombustionDiesel: 'Дизел',\n\thybrid: 'Хибрид',\n\tplugInHybrid: 'Зареждаем хибрид',\n\thydrogenFuelCell: 'Водородна горивна клетка',\n\tfrom: 'От',\n\tto: 'До',\n\tviaStop: 'Междинна спирка',\n\tviaStops: 'Междинни спирки',\n\taddViaStop: 'Добави междинна спирка',\n\tremoveViaStop: 'Премахни междинната спирка',\n\tviaStayDuration: 'Минимален престой',\n\tposition: 'местоположение',\n\tarrival: 'Пристигане',\n\tdeparture: 'Заминаване',\n\tduration: 'Продължителност',\n\tarrivals: 'Пристигания',\n\tlater: 'по-късно',\n\tearlier: 'по-рано',\n\tconnections: 'Връзки',\n\tdepartures: 'Заминавания',\n\tswitchToArrivals: 'Превключи към пристигания',\n\tswitchToDepartures: 'Превключи към заминавания',\n\ttrack: 'Коловоз',\n\tplatform: 'Перон',\n\ttrackAbr: 'Кол.',\n\tplatformAbr: 'Перон',\n\tarrivalOnTrack: 'Пристигане на коловоз',\n\ttripIntermediateStops: (n: number) => {\n\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\treturn 'Без междинни спирки';\n\t\t\tcase 1:\n\t\t\t\treturn '1 междинна спирка';\n\t\t\tdefault:\n\t\t\t\treturn `${n} междинни спирки`;\n\t\t}\n\t},\n\tsharingProvider: 'Оператор',\n\tsharingProviders: 'Оператори',\n\treturnOnlyAtStations: 'Превозното средство трябва да се върне на станция.',\n\troundtripStationReturnConstraint: 'Превозното средство трябва да се върне на началната станция.',\n\trentalStation: 'Станция',\n\trentalGeofencingZone: 'Зона',\n\tnoItinerariesFound: 'Не са намерени маршрути.',\n\tadvancedSearchOptions: 'Разширени настройки',\n\tselectTransitModes: 'Изберете видове транспорт',\n\tdefaultSelectedModes: 'Всички видове транспорт',\n\tdefaultSelectedProviders: 'Всички превозвачи',\n\tselectElevationCosts: 'Избягвай стръмни наклони.',\n\twheelchair: 'инвалидна количка',\n\tuseRoutedTransfers: 'Използвай посочените прекачвания',\n\tbikeRental: 'наемане на велосипед',\n\trequireBikeTransport: 'Превоз на велосипед',\n\trequireCarTransport: 'Превоз на автомобил',\n\tconsiderRentalReturnConstraints: 'Върни наетите превозни средства в рамките на пътуването',\n\tdefault: 'По подразбиране',\n\ttimetableSources: 'Източници на разписания',\n\ttripCancelled: 'Пътуването е отменено',\n\tstopCancelled: 'Спирката е отменена',\n\tinOutDisallowed: 'Качване/слизане не е позволено',\n\tinDisallowed: 'Качването не е позволено',\n\toutDisallowed: 'Слизането не е позволено',\n\tunscheduledTrip: 'извънреден курс',\n\talertsAvailable: 'налични известия',\n\tdataExpiredSince: 'Данните са остарели, последно валидни на',\n\tFLEX: 'По заявка',\n\tWALK: 'Пеша',\n\tBIKE: 'Велосипед',\n\tRENTAL: 'Нает',\n\tCAR: 'Автомобил',\n\tCAR_DROPOFF: 'Слизане от автомобила',\n\tCAR_PARKING: 'Паркинг (P+R)',\n\tTRANSIT: 'Градски транспорт',\n\tTRAM: 'Трамвай',\n\tSUBWAY: 'Метро',\n\tFERRY: 'Ферибот',\n\tAIRPLANE: 'Самолет',\n\tSUBURBAN: 'Градска железница',\n\tBUS: 'Автобус',\n\tCOACH: 'Междуградски автобус',\n\tRAIL: 'Влак',\n\tHIGHSPEED_RAIL: 'Високоскоростен влак',\n\tLONG_DISTANCE: 'Междуградски влак',\n\tNIGHT_RAIL: 'Нощен влак',\n\tREGIONAL_FAST_RAIL: 'Бърз регионален влак',\n\tREGIONAL_RAIL: 'Регионален влак',\n\tOTHER: 'Други',\n\troutingSegments: {\n\t\tmaxTransfers: 'Макс. прекачвания',\n\t\tmaxTravelTime: 'Макс. време за пътуване',\n\t\tfirstMile: 'Първи километър',\n\t\tlastMile: 'Последен километър',\n\t\tdirect: 'Директна връзка',\n\t\tmaxPreTransitTime: 'Максимално време преди транзит',\n\t\tmaxPostTransitTime: 'Максимално време след транзит',\n\t\tmaxDirectTime: 'Максимално време без транзит'\n\t},\n\televationCosts: {\n\t\tNONE: 'Без наклон',\n\t\tLOW: 'Лек наклон',\n\t\tHIGH: 'Голям наклон'\n\t},\n\tisochrones: {\n\t\ttitle: 'Достъпен периметър',\n\t\tdisplayLevel: 'Ниво на показване',\n\t\tmaxComputeLevel: 'Макс. ниво на изчисление',\n\t\tcanvasRects: 'Правоъгълници (слой)',\n\t\tcanvasCircles: 'Кръгове (слой)',\n\t\tgeojsonCircles: 'Кръгове (геометрия)',\n\t\tstyling: 'Стил',\n\t\tnoData: 'Няма данни',\n\t\trequestFailed: 'Заявката е неуспешна'\n\t},\n\talerts: {\n\t\tvalidFrom: 'Валидно от',\n\t\tuntil: 'до',\n\t\tinformation: 'Информация',\n\t\tmore: 'още'\n\t},\n\tRENTAL_BICYCLE: 'Споделен велосипед',\n\tRENTAL_CARGO_BICYCLE: 'Споделен товарен велосипед',\n\tRENTAL_CAR: 'Нает автомобил',\n\tRENTAL_MOPED: 'Споделен скутер',\n\tRENTAL_SCOOTER_STANDING: 'Споделена тротинетка',\n\tRENTAL_SCOOTER_SEATED: 'Споделена седяща тротинетка',\n\tRENTAL_OTHER: 'Друго споделено превозно средство',\n\tincline: 'Наклон',\n\tCABLE_CAR: 'Въжен лифт',\n\tFUNICULAR: 'Фуникулер',\n\tAERIAL_LIFT: 'Въздушен лифт',\n\ttoll: 'Внимание! Платен път.',\n\taccessRestriction: 'забранен достъп',\n\tcontinuesAs: 'Продължава като',\n\trent: 'Наем',\n\tcopyToClipboard: 'Копирай в клипборда',\n\trideThroughAllowed: 'Минаване е позволено',\n\trideThroughNotAllowed: 'Минаване не е позволено',\n\trideEndAllowed: 'Паркиране е позволено',\n\trideEndNotAllowed: 'Паркиране не е позволено'\n};\n\nexport default translations;\n","import type { Translations } from './translation';\n\nconst translations: Translations = {\n\tticket: 'Ticket',\n\tticketOptions: 'Ticket Options',\n\tincludedInTicket: 'Included in ticket',\n\tjourneyDetails: 'Journey Details',\n\ttransfers: 'transfers',\n\twalk: 'Walk',\n\tbike: 'Bike',\n\tcargoBike: 'Cargo bike',\n\tscooterStanding: 'Standing kick scooter',\n\tscooterSeated: 'Seated kick scooter',\n\tcar: 'Car',\n\ttaxi: 'Taxi',\n\tmoped: 'Moped',\n\tunknownVehicleType: 'Unknown vehicle type',\n\telectricAssist: 'Electric motor assist',\n\telectric: 'Electric',\n\tcombustion: 'Combustion',\n\tcombustionDiesel: 'Diesel',\n\thybrid: 'Hybrid',\n\tplugInHybrid: 'Plug-in hybrid',\n\thydrogenFuelCell: 'Hydrogen fuel cell',\n\tfrom: 'From',\n\tto: 'To',\n\tviaStop: 'Via stop',\n\tviaStops: 'Via stops',\n\taddViaStop: 'Add via stop',\n\tremoveViaStop: 'Remove via stop',\n\tviaStayDuration: 'Minimum stay',\n\tposition: 'Position',\n\tarrival: 'Arrival',\n\tdeparture: 'Departure',\n\tconnections: 'Connections',\n\tduration: 'Duration',\n\tarrivals: 'Arrivals',\n\tlater: 'later',\n\tearlier: 'earlier',\n\tdepartures: 'Departures',\n\tswitchToArrivals: 'Switch to arrivals',\n\tswitchToDepartures: 'Switch to departures',\n\ttrack: 'Platform',\n\tplatform: 'Platform',\n\ttrackAbr: 'Pl.',\n\tplatformAbr: 'Pl.',\n\tarrivalOnTrack: 'Arrival on track',\n\ttripIntermediateStops: (n: number) => {\n\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\treturn 'No intermediate stops';\n\t\t\tcase 1:\n\t\t\t\treturn '1 intermediate stop';\n\t\t\tdefault:\n\t\t\t\treturn `${n} intermediate stops`;\n\t\t}\n\t},\n\tsharingProvider: 'Provider',\n\tsharingProviders: 'Providers',\n\treturnOnlyAtStations: 'The vehicle must be returned at a station.',\n\troundtripStationReturnConstraint: 'The vehicle must be returned to the departure station.',\n\trentalStation: 'Station',\n\trentalGeofencingZone: 'Zone',\n\tnoItinerariesFound: 'No itineraries found.',\n\tadvancedSearchOptions: 'Options',\n\tselectTransitModes: 'Select transit modes',\n\tdefaultSelectedModes: 'All transit modes',\n\tdefaultSelectedProviders: 'All providers',\n\tselectElevationCosts: 'Avoid steep incline.',\n\tuseRoutedTransfers: 'Use routed transfers',\n\twheelchair: 'Accessible transfers',\n\tbikeRental: 'Allow usage of sharing vehicles',\n\trequireBikeTransport: 'Bike carriage',\n\trequireCarTransport: 'Car carriage',\n\tconsiderRentalReturnConstraints: 'Return rental vehicles within journey',\n\tdefault: 'Default',\n\ttimetableSources: 'Timetable sources',\n\ttripCancelled: 'Trip cancelled',\n\tstopCancelled: 'Stop cancelled',\n\tinOutDisallowed: 'Entry/exit not possible',\n\tinDisallowed: 'Entry not possible',\n\toutDisallowed: 'Exit not possible',\n\tunscheduledTrip: 'Additional service',\n\talertsAvailable: 'Service alerts present',\n\tdataExpiredSince: 'Warning: Expired data, last valid',\n\tFLEX: 'On-Demand',\n\tWALK: 'Walking',\n\tBIKE: 'Bike',\n\tRENTAL: 'Sharing',\n\tCAR: 'Car',\n\tCAR_PARKING: 'Car Parking',\n\tCAR_DROPOFF: 'Drop-off (car)',\n\tTRANSIT: 'Transit',\n\tTRAM: 'Tram',\n\tSUBWAY: 'Subway',\n\tFERRY: 'Ferry',\n\tAIRPLANE: 'Airplane',\n\tSUBURBAN: 'Suburban Rail',\n\tBUS: 'Bus',\n\tCOACH: 'Long Distance Bus / Coach',\n\tRAIL: 'Train',\n\tHIGHSPEED_RAIL: 'High Speed Rail',\n\tLONG_DISTANCE: 'Intercity Rail',\n\tNIGHT_RAIL: 'Night Rail',\n\tREGIONAL_FAST_RAIL: 'Fast Rail',\n\tREGIONAL_RAIL: 'Regional Rail',\n\tOTHER: 'Other',\n\tRENTAL_BICYCLE: 'Shared bike',\n\tRENTAL_CARGO_BICYCLE: 'Shared cargo bike',\n\tRENTAL_CAR: 'Shared car',\n\tRENTAL_MOPED: 'Shared moped',\n\tRENTAL_SCOOTER_STANDING: 'Shared standing scooter',\n\tRENTAL_SCOOTER_SEATED: 'Shared seated scooter',\n\tRENTAL_OTHER: 'Other shared vehicle',\n\tCABLE_CAR: 'Cable car',\n\tFUNICULAR: 'Funicular',\n\tAERIAL_LIFT: 'Aerial lift',\n\troutingSegments: {\n\t\tmaxTransfers: 'Max. transfers',\n\t\tmaxTravelTime: 'Max. travel time',\n\t\tfirstMile: 'First mile',\n\t\tlastMile: 'Last mile',\n\t\tdirect: 'Direct connection',\n\t\tmaxPreTransitTime: 'Max. pre-transit time',\n\t\tmaxPostTransitTime: 'Max. post-transit time',\n\t\tmaxDirectTime: 'Max. direct time'\n\t},\n\televationCosts: {\n\t\tNONE: 'No detours',\n\t\tLOW: 'Small detours',\n\t\tHIGH: 'Large detours'\n\t},\n\tisochrones: {\n\t\ttitle: 'Isochrones',\n\t\tdisplayLevel: 'Display level',\n\t\tmaxComputeLevel: 'Max. computation level',\n\t\tcanvasRects: 'Rects (Overlay)',\n\t\tcanvasCircles: 'Circles (Overlay)',\n\t\tgeojsonCircles: 'Circles (Geometry)',\n\t\tstyling: 'Isochrones styling',\n\t\tnoData: 'No data',\n\t\trequestFailed: 'Request failed'\n\t},\n\talerts: {\n\t\tvalidFrom: 'Valid from',\n\t\tuntil: 'until',\n\t\tinformation: 'Information',\n\t\tmore: 'more'\n\t},\n\tincline: 'Incline',\n\ttoll: 'Warning! A fee must be paid to use this route.',\n\taccessRestriction: 'No access',\n\tcontinuesAs: 'Continues as',\n\trent: 'Rent',\n\tcopyToClipboard: 'Copy to clipboard',\n\trideThroughAllowed: 'Riding through allowed',\n\trideThroughNotAllowed: 'Riding through not allowed',\n\trideEndAllowed: 'Parking allowed',\n\trideEndNotAllowed: 'Parking only at stations'\n};\n\nexport default translations;\n","import type { Translations } from './translation';\n\nconst translations: Translations = {\n\tticket: 'Fahrschein',\n\tticketOptions: 'Fahrscheinoptionen',\n\tincludedInTicket: 'Im Fahrschein enthalten',\n\tjourneyDetails: 'Verbindungsdetails',\n\ttransfers: 'Umstiege',\n\twalk: 'Fußweg',\n\tbike: 'Fahrrad',\n\tcargoBike: 'Lastenfahrrad',\n\tscooterStanding: 'Stehroller',\n\tscooterSeated: 'Sitzroller',\n\tcar: 'Auto',\n\ttaxi: 'Taxi',\n\tmoped: 'Moped',\n\tunknownVehicleType: 'Unbekannter Fahrzeugtyp',\n\telectricAssist: 'Elektromotorunterstützung',\n\telectric: 'Elektrisch',\n\tcombustion: 'Benzin',\n\tcombustionDiesel: 'Diesel',\n\thybrid: 'Hybrid',\n\tplugInHybrid: 'Plug-in Hybrid',\n\thydrogenFuelCell: 'Wasserstoff-Brennstoffzelle',\n\tfrom: 'Von',\n\tto: 'Nach',\n\tviaStop: 'Zwischenhalt',\n\tviaStops: 'Zwischenhalte',\n\taddViaStop: 'Zwischenhalt hinzufügen',\n\tremoveViaStop: 'Zwischenhalt entfernen',\n\tviaStayDuration: 'Mindestaufenthalt',\n\tposition: 'Position',\n\tarrival: 'Ankunft',\n\tdeparture: 'Abfahrt',\n\tduration: 'Dauer',\n\tarrivals: 'Ankünfte',\n\tconnections: 'Verbindungen',\n\tdepartures: 'Abfahrten',\n\tlater: 'später',\n\tearlier: 'früher',\n\ttrack: 'Gleis',\n\tplatform: 'Steig',\n\ttrackAbr: 'Gl.',\n\tplatformAbr: 'Stg.',\n\tarrivalOnTrack: 'Ankunft auf Gleis',\n\tswitchToArrivals: 'Wechsel zu Ankünften',\n\tswitchToDepartures: 'Wechsel zu Abfahrten',\n\ttripIntermediateStops: (n: number) => {\n\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\treturn 'Fahrt ohne Zwischenhalt';\n\t\t\tcase 1:\n\t\t\t\treturn 'Fahrt eine Station';\n\t\t\tdefault:\n\t\t\t\treturn `Fahrt ${n} Stationen`;\n\t\t}\n\t},\n\tsharingProvider: 'Anbieter',\n\tsharingProviders: 'Anbieter',\n\treturnOnlyAtStations: 'Das Fahrzeug muss an einer Station zurückgegeben werden.',\n\troundtripStationReturnConstraint:\n\t\t'Das Fahrzeug muss wieder an der Abfahrtsstation abgestellt werden.',\n\trentalStation: 'Station',\n\trentalGeofencingZone: 'Zone',\n\tnoItinerariesFound: 'Keine Verbindungen gefunden.',\n\tadvancedSearchOptions: 'Optionen',\n\tselectTransitModes: 'Öffentliche Verkehrsmittel auswählen',\n\tdefaultSelectedModes: 'Alle Verkehrsmittel',\n\tdefaultSelectedProviders: 'Alle Anbieter',\n\tselectElevationCosts: 'Steile Steigungen vermeiden.',\n\tuseRoutedTransfers: 'Geroutete Umstiege verwenden',\n\twheelchair: 'Barrierefreie Umstiege',\n\tbikeRental: 'Sharing-Fahrzeuge berücksichtigen',\n\trequireBikeTransport: 'Fahrradmitnahme',\n\trequireCarTransport: 'Automitnahme',\n\tconsiderRentalReturnConstraints: 'Leihfahrzeuge innerhalb der Reise zurückgeben',\n\tdefault: 'Vorgabe',\n\ttimetableSources: 'Fahrplandatenquellen',\n\ttripCancelled: 'Fahrt entfällt',\n\tstopCancelled: 'Halt entfällt',\n\tinOutDisallowed: 'Ein-/Ausstieg nicht möglich',\n\tinDisallowed: 'Einstieg nicht möglich',\n\toutDisallowed: 'Ausstieg nicht möglich',\n\tunscheduledTrip: 'Zusätzliche Fahrt',\n\talertsAvailable: 'Meldungen liegen vor',\n\tdataExpiredSince: 'Achtung: Veraltete Daten, zuletzt gültig am',\n\tFLEX: 'Bedarfsverkehr',\n\tWALK: 'Zu Fuß',\n\tBIKE: 'Fahrrad',\n\tRENTAL: 'Sharing',\n\tCAR: 'Auto',\n\tCAR_DROPOFF: 'Absetzen (Auto)',\n\tCAR_PARKING: 'P+R Park & Ride',\n\tTRANSIT: 'ÖPV',\n\tTRAM: 'Tram',\n\tSUBWAY: 'U-Bahn',\n\tFERRY: 'Fähre',\n\tAIRPLANE: 'Flugzeug',\n\tSUBURBAN: 'S-Bahn',\n\tBUS: 'Bus',\n\tCOACH: 'Reisebus',\n\tRAIL: 'Zug',\n\tHIGHSPEED_RAIL: 'Hochgeschwindigkeitszug',\n\tLONG_DISTANCE: 'Intercityzug',\n\tNIGHT_RAIL: 'Nachtzug',\n\tREGIONAL_FAST_RAIL: 'Schnellzug',\n\tREGIONAL_RAIL: 'Regionalzug',\n\tOTHER: 'Andere',\n\troutingSegments: {\n\t\tmaxTransfers: 'Max. Umstiege',\n\t\tmaxTravelTime: 'Max. Reisezeit',\n\t\tfirstMile: 'Erste Meile',\n\t\tlastMile: 'Letzte Meile',\n\t\tdirect: 'Direktverbindung',\n\t\tmaxPreTransitTime: 'Max. Vorlaufzeit',\n\t\tmaxPostTransitTime: 'Max. Nachlaufzeit',\n\t\tmaxDirectTime: 'Max. Direktzeit'\n\t},\n\televationCosts: { NONE: 'Keine Umwege', LOW: 'Kleine Umwege', HIGH: 'Große Umwege' },\n\tisochrones: {\n\t\ttitle: 'Isochronen',\n\t\tdisplayLevel: 'Darstellungsebene',\n\t\tmaxComputeLevel: 'Max. Berechnungsebene',\n\t\tcanvasRects: 'Rechtecke (Overlay)',\n\t\tcanvasCircles: 'Kreise (Overlay)',\n\t\tgeojsonCircles: 'Kreise (Geometrie)',\n\t\tstyling: 'Darstellung der Isochronen',\n\t\tnoData: 'Keine Daten',\n\t\trequestFailed: 'Anfrage fehlgeschlagen'\n\t},\n\talerts: {\n\t\tvalidFrom: 'Gültig von',\n\t\tuntil: 'bis',\n\t\tinformation: 'Informationen',\n\t\tmore: 'mehr'\n\t},\n\tRENTAL_BICYCLE: 'Bikesharing',\n\tRENTAL_CARGO_BICYCLE: 'Lastenrad Sharing',\n\tRENTAL_CAR: 'Car Sharing',\n\tRENTAL_MOPED: 'Moped Sharing',\n\tRENTAL_SCOOTER_STANDING: 'Scooter Sharing',\n\tRENTAL_SCOOTER_SEATED: 'Sitzroller Sharing',\n\tRENTAL_OTHER: 'Anderes sharing Fahrzeug',\n\tincline: 'Steigung',\n\tCABLE_CAR: 'Seilbahn',\n\tFUNICULAR: 'Standseilbahn',\n\tAERIAL_LIFT: 'Luftseilbahn',\n\ttoll: 'Achtung! Mautpflichtige Straße.',\n\taccessRestriction: 'Kein Zugang',\n\tcontinuesAs: 'Weiter als',\n\trent: 'Ausleihen',\n\tcopyToClipboard: 'In die Zwischenablage kopieren',\n\trideThroughAllowed: 'Durchfahrt erlaubt',\n\trideThroughNotAllowed: 'Durchfahrt verboten',\n\trideEndAllowed: 'Parken erlaubt',\n\trideEndNotAllowed: 'Parken nur an Stationen'\n};\n\nexport default translations;\n","import type { Translations } from './translation';\n\nconst translations: Translations = {\n\tticket: 'Billet',\n\tticketOptions: 'Options de billet',\n\tincludedInTicket: 'Inclus dans le billet',\n\tjourneyDetails: 'Détails du voyage',\n\twalk: 'à pied',\n\tbike: 'Vélo',\n\tcargoBike: 'Vélo Cargo',\n\tscooterStanding: 'Trottinette',\n\tscooterSeated: 'Trottinette avec siège',\n\tcar: 'Voiture',\n\ttaxi: 'Taxi',\n\tmoped: 'Mobylette',\n\tunknownVehicleType: 'Type de véhicule inconnu',\n\telectricAssist: 'Assistance moteur électrique',\n\telectric: 'Électrique',\n\tcombustion: 'Combustion',\n\tcombustionDiesel: 'Diesel',\n\thybrid: 'Hybride',\n\tplugInHybrid: 'Hybride rechargeable',\n\thydrogenFuelCell: 'Pile à combustible hydrogène',\n\tfrom: 'De',\n\tto: 'À',\n\tviaStop: 'Arrêt intermédiaire',\n\tviaStops: 'Arrêts intermédiaires',\n\taddViaStop: 'Ajouter un arrêt intermédiaire',\n\tremoveViaStop: \"Supprimer l'arrêt intermédiaire\",\n\tviaStayDuration: \"Durée minimale d'arrêt\",\n\tposition: 'Position',\n\tarrival: 'Arrivée',\n\tdeparture: 'Départ',\n\tduration: 'Durée',\n\tarrivals: 'Arrivées',\n\tlater: 'plus tard',\n\tearlier: 'plus tôt',\n\tdepartures: 'Départs',\n\tconnections: 'Itinéraires',\n\tswitchToArrivals: 'Afficher les arrivées',\n\tswitchToDepartures: 'Afficher les départs',\n\ttrack: 'Voie',\n\tplatform: 'Quai',\n\ttrackAbr: 'V.',\n\tplatformAbr: 'Q.',\n\tarrivalOnTrack: 'Arrivée sur la voie',\n\ttripIntermediateStops: (n: number) => {\n\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\treturn 'Aucun arrêt intermédiaire';\n\t\t\tcase 1:\n\t\t\t\treturn '1 arrêt intermédiaire';\n\t\t\tdefault:\n\t\t\t\treturn `${n} arrêts intermédiaires`;\n\t\t}\n\t},\n\tsharingProvider: 'Fournisseur',\n\tsharingProviders: 'Fournisseurs',\n\ttransfers: 'correspondances',\n\treturnOnlyAtStations: 'Le véhicule doit être retourné à une station.',\n\troundtripStationReturnConstraint: 'Le véhicule doit être retourné à la station de départ.',\n\trentalStation: 'Station',\n\trentalGeofencingZone: 'Zone',\n\tnoItinerariesFound: 'Aucun itinéraire trouvé.',\n\tadvancedSearchOptions: 'Options',\n\tselectTransitModes: 'Sélectionner les modes de transport en commun',\n\tdefaultSelectedModes: 'Tous les transports en commun',\n\tdefaultSelectedProviders: 'Tous les fournisseurs',\n\tselectElevationCosts: 'Évitez les pentes abruptes.', // TODO Online translated\n\twheelchair: 'Correspondances accessibles',\n\tuseRoutedTransfers: 'Utiliser les correspondances routées',\n\tbikeRental: 'Utiliser véhicules partagés',\n\trequireBikeTransport: 'Transport vélo',\n\trequireCarTransport: 'Transport voiture',\n\tconsiderRentalReturnConstraints: 'Retourner les véhicules partagés pendant le voyage',\n\tdefault: 'Faire défaut',\n\ttimetableSources: 'Sources des horaires',\n\ttripCancelled: 'Voyage annulé',\n\tstopCancelled: 'Arrêt supprimé',\n\tinOutDisallowed: 'Impossible de monter/descendre',\n\tinDisallowed: 'Impossible de monter',\n\toutDisallowed: 'Impossible de descendre',\n\tunscheduledTrip: 'Voyage supplémentaire',\n\talertsAvailable: 'Annonces disponibles',\n\tdataExpiredSince: 'Attention : Données expirées, valides jusqu’au',\n\tFLEX: 'Transport à la demande',\n\tWALK: 'À pied',\n\tBIKE: 'Vélo',\n\tRENTAL: 'Loué',\n\tCAR: 'Voiture',\n\tCAR_PARKING: 'Garage voiture',\n\tCAR_DROPOFF: 'Dépose (voiture)',\n\tTRANSIT: 'Transports en commun',\n\tTRAM: 'Tram',\n\tSUBWAY: 'Métro',\n\tFERRY: 'Ferry',\n\tAIRPLANE: 'Avion',\n\tSUBURBAN: 'RER',\n\tBUS: 'Bus',\n\tCOACH: 'Autocar',\n\tRAIL: 'Train',\n\tHIGHSPEED_RAIL: 'Train à grande vitesse',\n\tLONG_DISTANCE: 'Train intercité',\n\tNIGHT_RAIL: 'Train de nuit',\n\tREGIONAL_FAST_RAIL: 'Train express',\n\tREGIONAL_RAIL: 'Train régional',\n\tOTHER: 'Autres',\n\troutingSegments: {\n\t\tmaxTransfers: 'Max. de correspondances',\n\t\tmaxTravelTime: 'Temps de trajet max.',\n\t\tfirstMile: 'Premier kilomètre',\n\t\tlastMile: 'Dernier kilomètre',\n\t\tdirect: 'Connexion directe',\n\t\tmaxPreTransitTime: 'Durée max. avant transit',\n\t\tmaxPostTransitTime: 'Durée max. après transit',\n\t\tmaxDirectTime: 'Durée max. directe'\n\t},\n\televationCosts: {\n\t\tNONE: 'Pas de détours',\n\t\tLOW: 'Petits détours',\n\t\tHIGH: 'Grands détours'\n\t},\n\tisochrones: {\n\t\ttitle: 'Isochrones',\n\t\tdisplayLevel: 'Couche de présentation',\n\t\tmaxComputeLevel: 'Niveau de calcul max.',\n\t\tcanvasRects: 'Rectes (Superposer)',\n\t\tcanvasCircles: 'Cercles (Superposer)',\n\t\tgeojsonCircles: 'Circles (Géométrie)',\n\t\tstyling: 'Style pour Isochrone',\n\t\tnoData: 'Pas de données',\n\t\trequestFailed: 'Échec de la demande'\n\t},\n\talerts: {\n\t\tvalidFrom: 'Valable du',\n\t\tuntil: 'au',\n\t\tinformation: 'Informations',\n\t\tmore: 'de plus'\n\t},\n\tRENTAL_BICYCLE: 'Vélo partagé',\n\tRENTAL_CARGO_BICYCLE: 'Vélo cargo partagé',\n\tRENTAL_CAR: 'Voiture partagée',\n\tRENTAL_MOPED: 'Mobylette partagée',\n\tRENTAL_SCOOTER_STANDING: 'Trottinette debout partagée',\n\tRENTAL_SCOOTER_SEATED: 'Trottinette assise partagée',\n\tRENTAL_OTHER: 'Autre véhicule partagé',\n\tincline: 'Pente',\n\tCABLE_CAR: 'Téléphérique',\n\tFUNICULAR: 'Funiculaire',\n\tAERIAL_LIFT: 'Remontée mécanique',\n\ttoll: 'Attention ! Route à péage.',\n\taccessRestriction: 'Accès restreint',\n\tcontinuesAs: 'Continue comme',\n\trent: 'Louer',\n\tcopyToClipboard: 'Copier dans le presse-papiers',\n\trideThroughAllowed: 'Passage autorisé',\n\trideThroughNotAllowed: 'Passage non autorisé',\n\trideEndAllowed: 'Stationnement autorisé',\n\trideEndNotAllowed: 'Stationnement uniquement aux stations'\n};\n\nexport default translations;\n","import type { Translations } from './translation';\n\nconst translations: Translations = {\n\tticket: 'Bilet',\n\tticketOptions: 'Opcje biletu',\n\tincludedInTicket: 'Zawarte w ramach biletu',\n\tjourneyDetails: 'Szczegóły podróży',\n\ttransfers: 'przesiadki',\n\twalk: 'Pieszo',\n\tbike: 'Rower',\n\tcargoBike: 'Rower cargo',\n\tscooterStanding: 'Hulajnoga stojąca',\n\tscooterSeated: 'Hulajnoga z siedziskiem',\n\tcar: 'Samochód',\n\ttaxi: 'Taksówka',\n\tmoped: 'Skuter',\n\tunknownVehicleType: 'Nieznany typ pojazdu',\n\telectricAssist: 'Wspomaganie elektryczne',\n\telectric: 'Elektryczny',\n\tcombustion: 'Spalinowy',\n\tcombustionDiesel: 'Diesel',\n\thybrid: 'Hybrydowy',\n\tplugInHybrid: 'Hybryda plug-in',\n\thydrogenFuelCell: 'Ogniwo paliwowe na wodór',\n\tfrom: 'Z',\n\tto: 'Do',\n\tviaStop: 'Przystanek pośredni',\n\tviaStops: 'Przystanki pośrednie',\n\taddViaStop: 'Dodaj przystanek pośredni',\n\tremoveViaStop: 'Usuń przystanek pośredni',\n\tviaStayDuration: 'Minimalny postój',\n\tposition: 'Pozycja',\n\tarrival: 'Przyjazd',\n\tdeparture: 'Odjazd',\n\tduration: 'Czas trwania',\n\tarrivals: 'Przyjazdy',\n\tlater: 'później',\n\tearlier: 'wcześniej',\n\tdepartures: 'Odjazdy',\n\tconnections: 'Połączenia',\n\tswitchToArrivals: 'Przełącz na przyjazdy',\n\tswitchToDepartures: 'Przełącz na odjazdy',\n\ttrack: 'Tor',\n\tplatform: 'Peron',\n\ttrackAbr: 'T.',\n\tplatformAbr: 'Pr.',\n\tarrivalOnTrack: 'Przyjazd na tor',\n\ttripIntermediateStops: (n: number) => {\n\t\tif (n == 0) {\n\t\t\treturn 'Brak przystanków pośrednich';\n\t\t}\n\t\tif (n == 1) {\n\t\t\treturn '1 przystanek pośredni';\n\t\t}\n\t\tif (n % 10 > 1 && n % 10 < 5 && n != 12 && n != 13 && n != 14) {\n\t\t\treturn `${n} przystanki pośrednie`;\n\t\t}\n\t\treturn `${n} przystanków pośrednich`;\n\t},\n\tsharingProvider: 'Dostawca danych',\n\tsharingProviders: 'Dostawcy danych',\n\treturnOnlyAtStations: 'Pojazd musi zostać zwrócony na stacji.',\n\troundtripStationReturnConstraint: 'Pojazd musi zostać zwrócony do stacji początkowej.',\n\trentalStation: 'Stacja',\n\trentalGeofencingZone: 'Strefa',\n\tnoItinerariesFound: 'Nie znaleziono połączeń.',\n\tadvancedSearchOptions: 'Opcje',\n\tselectTransitModes: 'Wybierz środki transportu',\n\tdefaultSelectedModes: 'Wszystkie środki transportu',\n\tdefaultSelectedProviders: 'Wszyscy dostawcy',\n\tselectElevationCosts: 'Unikaj stromych nachyleń.',\n\twheelchair: 'Bezbarierowe przesiadki',\n\tuseRoutedTransfers: 'Wyznacz trasy dla przesiadek',\n\tbikeRental: 'Użyj pojazdów współdzielonych',\n\trequireBikeTransport: 'Przewóz roweru',\n\trequireCarTransport: 'Przewóz samochodu',\n\tconsiderRentalReturnConstraints: 'Zwróć pojazd współdzielony podczas podróży',\n\tdefault: 'Domyślne',\n\ttimetableSources: 'Źródła danych rozkładowych',\n\ttripCancelled: 'Kurs odwołany',\n\tstopCancelled: 'Przystanek nieobsługiwany',\n\tinOutDisallowed: 'Zabronione wejście i wyjście',\n\tinDisallowed: 'Zabronione wejście',\n\toutDisallowed: 'Zabronione wyjście',\n\tunscheduledTrip: 'Kurs dodatkowy',\n\talertsAvailable: 'Istnieją ogłoszenia',\n\tdataExpiredSince: 'Uwaga: Dane nieaktualne, ostatnio ważne',\n\tFLEX: 'Transport na żądanie',\n\tWALK: 'Pieszo',\n\tBIKE: 'Rower',\n\tRENTAL: 'Współdzielenie pojazdów',\n\tCAR: 'Samochód',\n\tCAR_PARKING: 'Samochód (użyj parkingów)',\n\tCAR_DROPOFF: 'Samochód (tylko zatrzymanie)',\n\tTRANSIT: 'Transport publiczny',\n\tTRAM: 'Tramwaj',\n\tSUBWAY: 'Metro',\n\tFERRY: 'Prom',\n\tAIRPLANE: 'Samolot',\n\tSUBURBAN: 'Kolej miejska',\n\tBUS: 'Autobus',\n\tCOACH: 'Autokar dalekobieżny',\n\tRAIL: 'Kolej',\n\tHIGHSPEED_RAIL: 'Kolej dużych prędkości',\n\tLONG_DISTANCE: 'Kolej dalekobieżna',\n\tNIGHT_RAIL: 'Nocne pociągi',\n\tREGIONAL_FAST_RAIL: 'Pociąg pospieszny',\n\tREGIONAL_RAIL: 'Kolej regionalna',\n\tOTHER: 'Inne',\n\troutingSegments: {\n\t\tmaxTransfers: 'Maks. ilość przesiadek',\n\t\tmaxTravelTime: 'Maks. czas podróży',\n\t\tfirstMile: 'Początek podróży',\n\t\tlastMile: 'Osiągnięcie celu',\n\t\tdirect: 'Połączenie bezpośrednie',\n\t\tmaxPreTransitTime: 'Maks. czas dotarcia',\n\t\tmaxPostTransitTime: 'Maks. czas dotarcia',\n\t\tmaxDirectTime: 'Maks. czas dotarcia'\n\t},\n\televationCosts: {\n\t\tNONE: 'Bez odchyleń od trasy',\n\t\tLOW: 'Małe odchylenia od trasy',\n\t\tHIGH: 'Duże odchylenia od trasy'\n\t},\n\tisochrones: {\n\t\ttitle: 'Izochrony',\n\t\tdisplayLevel: 'Poziom wyświetlania',\n\t\tmaxComputeLevel: 'Maks. poziom wyliczenia',\n\t\tcanvasRects: 'Kwadraty (warstwa)',\n\t\tcanvasCircles: 'Okręgi (warstwa)',\n\t\tgeojsonCircles: 'Okręgi (geometria)',\n\t\tstyling: 'Styl izochron',\n\t\tnoData: 'Brak danych',\n\t\trequestFailed: 'Błąd zapytania'\n\t},\n\talerts: {\n\t\tvalidFrom: 'Ważne od',\n\t\tuntil: 'do',\n\t\tinformation: 'Informacje',\n\t\tmore: 'więcej'\n\t},\n\tRENTAL_BICYCLE: 'Rower współdzielony',\n\tRENTAL_CARGO_BICYCLE: 'Rower cargo współdzielony',\n\tRENTAL_CAR: 'Samochód współdzielony',\n\tRENTAL_MOPED: 'Skuter współdzielony',\n\tRENTAL_SCOOTER_STANDING: 'Hulajnoga stojąca współdzielona',\n\tRENTAL_SCOOTER_SEATED: 'Hulajnoga z siedziskiem współdzielona',\n\tRENTAL_OTHER: 'Inny pojazd współdzielony',\n\tincline: 'Nachylenie',\n\tCABLE_CAR: 'Kolej linowa',\n\tFUNICULAR: 'Kolej linowo-terenowa',\n\tAERIAL_LIFT: 'Wyciąg krzesełkowy',\n\ttoll: 'Uwaga! Za przejazd tą trasą pobierana jest opłata.',\n\taccessRestriction: 'Ograniczony dostęp',\n\tcontinuesAs: 'Kontynuuje jako',\n\trent: 'Wypożycz',\n\tcopyToClipboard: 'Kopiuj do schowka',\n\trideThroughAllowed: 'Przejazd dozwolony',\n\trideThroughNotAllowed: 'Przejazd niedozwolony',\n\trideEndAllowed: 'Parkowanie dozwolone',\n\trideEndNotAllowed: 'Parkowanie tylko na stacjach'\n};\n\nexport default translations;\n","import type { Translations } from './translation';\n\nconst translations: Translations = {\n\tticket: 'Jízdenka',\n\tticketOptions: 'Možnosti jízdenky',\n\tincludedInTicket: 'Zahrnuté v jízdence',\n\tjourneyDetails: 'Detail cesty',\n\ttransfers: 'přestupy',\n\twalk: 'Pěšky',\n\tbike: 'Kolo',\n\tcargoBike: 'Nákladní kolo',\n\tscooterStanding: 'Koloběžka',\n\tscooterSeated: 'Koloběžka se sedačkou',\n\tcar: 'Auto',\n\ttaxi: 'Taxi',\n\tmoped: 'Skútr',\n\tunknownVehicleType: 'Neznámý typ vozidla',\n\telectricAssist: 'Elektrická podpora',\n\telectric: 'Elektrické',\n\tcombustion: 'Spalovací',\n\tcombustionDiesel: 'Diesel',\n\thybrid: 'Hybridní',\n\tplugInHybrid: 'Plug-in hybrid',\n\thydrogenFuelCell: 'Vodíkový palivový článek',\n\tfrom: 'Z',\n\tto: 'Do',\n\tviaStop: 'Mezizastávka',\n\tviaStops: 'Mezizastávky',\n\taddViaStop: 'Přidat mezizastávku',\n\tremoveViaStop: 'Odebrat mezizastávku',\n\tviaStayDuration: 'Minimální pobyt',\n\tposition: 'Pozice',\n\tarrival: 'Příjezd',\n\tdeparture: 'Odjezd',\n\tduration: 'Čas cesty',\n\tarrivals: 'Příjezdy',\n\tlater: 'později',\n\tearlier: 'dřive',\n\tdepartures: 'Odjezdy',\n\tconnections: 'Spoje',\n\tswitchToArrivals: 'Přepni na příjezdy',\n\tswitchToDepartures: 'Přepni na odjezdy',\n\ttrack: 'Kolej',\n\tplatform: 'Nástupiště',\n\tplatformAbr: 'Nást.',\n\ttrackAbr: 'K.',\n\tarrivalOnTrack: 'Příjezd na kolej',\n\ttripIntermediateStops: (n: number) => {\n\t\tif (n == 0) {\n\t\t\treturn 'Bez mezizastávek';\n\t\t}\n\t\tif (n == 1) {\n\t\t\treturn '1 mezizastávka';\n\t\t}\n\t\tif (n % 10 > 1 && n % 10 < 5 && n != 12 && n != 13 && n != 14) {\n\t\t\treturn `${n} mezizastávky`;\n\t\t}\n\t\treturn `${n} mezizastávek`;\n\t},\n\tsharingProvider: 'Poskytovatel dat',\n\tsharingProviders: 'Poskytovatelé dat',\n\treturnOnlyAtStations: 'Vozidlo musí být vráceno na stanici.',\n\troundtripStationReturnConstraint: 'Pojezd musí být vrácen k počáteční stanice',\n\trentalStation: 'Stanice',\n\trentalGeofencingZone: 'Zóna',\n\tnoItinerariesFound: 'Spojení nebylo nalezeno.',\n\tadvancedSearchOptions: 'Možnosti',\n\tselectTransitModes: 'Vyber dopravní prostředky',\n\tdefaultSelectedModes: 'Všechny dopravní prostředky',\n\tdefaultSelectedProviders: 'Všichni poskytovatelé',\n\tselectElevationCosts: 'Bez prudkého stoupání.',\n\twheelchair: 'Bezbariérové přestupy',\n\tuseRoutedTransfers: 'Počítej trasu pro přestupy',\n\tbikeRental: 'Povol použití sdílených vozidel',\n\trequireBikeTransport: 'Přeprava kola',\n\trequireCarTransport: 'Přeprava auta',\n\tconsiderRentalReturnConstraints: 'Vrať sdílené vozidla během cesty',\n\tdefault: 'default',\n\ttimetableSources: 'Zdroje dát JŘ',\n\ttripCancelled: 'Spoj odřeknut',\n\tstopCancelled: 'Zastávka bez obsluhy',\n\tinOutDisallowed: 'Vstup/výstup není povolen',\n\tinDisallowed: 'Vstup není povolen',\n\toutDisallowed: 'Výstup není povolen',\n\tunscheduledTrip: 'Doplňkový spoj',\n\talertsAvailable: 'Oznámení o provozu',\n\tdataExpiredSince: 'Pozor: Zastaralá data, platná naposledy',\n\tFLEX: 'Poptávková doprava',\n\tWALK: 'Chůze',\n\tBIKE: 'Kolo',\n\tRENTAL: 'Sdílené prostředky',\n\tCAR: 'Auto',\n\tCAR_PARKING: 'Auto (využití parkovíšť)',\n\tCAR_DROPOFF: 'Auto (pouze zastavení)',\n\tTRANSIT: 'Hromadná doprava',\n\tTRAM: 'Tramvaj',\n\tSUBWAY: 'Metro',\n\tFERRY: 'Přívoz',\n\tAIRPLANE: 'Letadlo',\n\tSUBURBAN: 'Městská železnice',\n\tBUS: 'Autobus',\n\tCOACH: 'Dálkový autokar',\n\tRAIL: 'Železnice',\n\tHIGHSPEED_RAIL: 'Vysokorychlostní železnice',\n\tLONG_DISTANCE: 'Dálková železnice',\n\tNIGHT_RAIL: 'Noční vlaky',\n\tREGIONAL_FAST_RAIL: 'Zrychlená železnice',\n\tREGIONAL_RAIL: 'Regionální železnice',\n\tOTHER: 'Jiné',\n\troutingSegments: {\n\t\tmaxTransfers: 'Max. počet přestupů',\n\t\tmaxTravelTime: 'Max. čas cesty',\n\t\tfirstMile: 'Přesun k první zastávce',\n\t\tlastMile: 'Přesun od poslední zastávky',\n\t\tdirect: 'Přímé spojení',\n\t\tmaxPreTransitTime: 'Max. čas přesunu',\n\t\tmaxPostTransitTime: 'Max. čas přesunu',\n\t\tmaxDirectTime: 'Max. čas přesunu'\n\t},\n\televationCosts: {\n\t\tNONE: 'Bez odklonů',\n\t\tLOW: 'Malé odklony',\n\t\tHIGH: 'Velké odklony'\n\t},\n\tisochrones: {\n\t\ttitle: 'Izochrony',\n\t\tdisplayLevel: 'Úroveň ukazování',\n\t\tmaxComputeLevel: 'Max. úroveň vypočítání',\n\t\tcanvasRects: 'Čtverce',\n\t\tcanvasCircles: 'Okruhy (zjednodušená projekce)',\n\t\tgeojsonCircles: 'Okruhy (pokročilá projekce)',\n\t\tstyling: 'Styl izochron',\n\t\tnoData: 'Žádné data',\n\t\trequestFailed: 'Chyba žádosti'\n\t},\n\talerts: {\n\t\tvalidFrom: 'Platí od',\n\t\tuntil: 'do',\n\t\tinformation: 'Informace',\n\t\tmore: 'více'\n\t},\n\tRENTAL_BICYCLE: 'Sdílené kolo',\n\tRENTAL_CARGO_BICYCLE: 'Sdílené nákladní kolo',\n\tRENTAL_CAR: 'Sdílené auto',\n\tRENTAL_MOPED: 'Sdílený skútr',\n\tRENTAL_SCOOTER_STANDING: 'Sdílená koloběžka',\n\tRENTAL_SCOOTER_SEATED: 'Sdílená koloběžka se sedačkou',\n\tRENTAL_OTHER: 'Jiné sdílené vozidla',\n\tincline: 'Sklon',\n\tCABLE_CAR: 'Lanová dráha',\n\tFUNICULAR: 'Lanová dráha',\n\tAERIAL_LIFT: 'Lanová dráha',\n\ttoll: 'Pozor! Průjezd tuto trasou je placený.',\n\taccessRestriction: 'Omezený dostup',\n\tcontinuesAs: 'Pokračuje jako',\n\trent: 'Půjčit si',\n\tcopyToClipboard: 'Kopírovat do schránky',\n\trideThroughAllowed: 'Průjezd povolen',\n\trideThroughNotAllowed: 'Průjezd zakázán',\n\trideEndAllowed: 'Parkování povoleno',\n\trideEndNotAllowed: 'Parkování pouze na stanicích'\n};\n\nexport default translations;\n","import { browser } from '$app/environment';\nimport bg from './bg';\nimport en from './en';\nimport de from './de';\nimport fr from './fr';\nimport pl from './pl';\nimport cs from './cs';\n\nexport type Translations = {\n\tticket: string;\n\tticketOptions: string;\n\tincludedInTicket: string;\n\tjourneyDetails: string;\n\ttransfers: string;\n\twalk: string;\n\tbike: string;\n\tcargoBike: string;\n\tscooterStanding: string;\n\tscooterSeated: string;\n\tcar: string;\n\ttaxi: string;\n\tmoped: string;\n\tunknownVehicleType: string;\n\telectricAssist: string;\n\telectric: string;\n\tcombustion: string;\n\tcombustionDiesel: string;\n\thybrid: string;\n\tplugInHybrid: string;\n\thydrogenFuelCell: string;\n\tfrom: string;\n\tto: string;\n\tviaStop: string;\n\tviaStops: string;\n\taddViaStop: string;\n\tremoveViaStop: string;\n\tviaStayDuration: string;\n\tposition: string;\n\tarrival: string;\n\tdeparture: string;\n\tduration: string;\n\tlater: string;\n\tearlier: string;\n\tarrivals: string;\n\tdepartures: string;\n\tconnections: string;\n\tswitchToArrivals: string;\n\tswitchToDepartures: string;\n\tarrivalOnTrack: string;\n\ttrack: string;\n\tplatform: string;\n\ttrackAbr: string;\n\tplatformAbr: string;\n\ttripIntermediateStops: (n: number) => string;\n\tsharingProvider: string;\n\tsharingProviders: string;\n\treturnOnlyAtStations: string;\n\troundtripStationReturnConstraint: string;\n\trentalStation: string;\n\trentalGeofencingZone: string;\n\tnoItinerariesFound: string;\n\tadvancedSearchOptions: string;\n\tselectTransitModes: string;\n\tdefaultSelectedModes: string;\n\tdefaultSelectedProviders: string;\n\tselectElevationCosts: string;\n\twheelchair: string;\n\tuseRoutedTransfers: string;\n\tbikeRental: string;\n\trequireBikeTransport: string;\n\trequireCarTransport: string;\n\tconsiderRentalReturnConstraints: string;\n\tdefault: string;\n\ttimetableSources: string;\n\ttripCancelled: string;\n\tstopCancelled: string;\n\tinOutDisallowed: string;\n\tinDisallowed: string;\n\toutDisallowed: string;\n\tunscheduledTrip: string;\n\talertsAvailable: string;\n\tdataExpiredSince: string;\n\tFLEX: string;\n\tWALK: string;\n\tBIKE: string;\n\tRENTAL: string;\n\tCAR: string;\n\tCAR_DROPOFF: string;\n\tCAR_PARKING: string;\n\tTRANSIT: string;\n\tTRAM: string;\n\tSUBWAY: string;\n\tFERRY: string;\n\tAIRPLANE: string;\n\tSUBURBAN: string;\n\tBUS: string;\n\tCOACH: string;\n\tRAIL: string;\n\tHIGHSPEED_RAIL: string;\n\tLONG_DISTANCE: string;\n\tNIGHT_RAIL: string;\n\tREGIONAL_FAST_RAIL: string;\n\tREGIONAL_RAIL: string;\n\tOTHER: string;\n\troutingSegments: {\n\t\tmaxTransfers: string;\n\t\tmaxTravelTime: string;\n\t\tfirstMile: string;\n\t\tlastMile: string;\n\t\tdirect: string;\n\t\tmaxPreTransitTime: string;\n\t\tmaxPostTransitTime: string;\n\t\tmaxDirectTime: string;\n\t};\n\televationCosts: {\n\t\tNONE: string;\n\t\tLOW: string;\n\t\tHIGH: string;\n\t};\n\tisochrones: {\n\t\ttitle: string;\n\t\tdisplayLevel: string;\n\t\tmaxComputeLevel: string;\n\t\tcanvasRects: string;\n\t\tcanvasCircles: string;\n\t\tgeojsonCircles: string;\n\t\tstyling: string;\n\t\tnoData: string;\n\t\trequestFailed: string;\n\t};\n\talerts: {\n\t\tvalidFrom: string;\n\t\tuntil: string;\n\t\tinformation: string;\n\t\tmore: string;\n\t};\n\tRENTAL_BICYCLE: string;\n\tRENTAL_CARGO_BICYCLE: string;\n\tRENTAL_CAR: string;\n\tRENTAL_MOPED: string;\n\tRENTAL_SCOOTER_STANDING: string;\n\tRENTAL_SCOOTER_SEATED: string;\n\tRENTAL_OTHER: string;\n\tincline: string;\n\tCABLE_CAR: string;\n\tFUNICULAR: string;\n\tAERIAL_LIFT: string;\n\ttoll: string;\n\taccessRestriction: string;\n\tcontinuesAs: string;\n\trent: string;\n\tcopyToClipboard: string;\n\trideThroughAllowed: string;\n\trideThroughNotAllowed: string;\n\trideEndAllowed: string;\n\trideEndNotAllowed: string;\n};\n\nconst translations: Map<string, Translations> = new Map(\n\tObject.entries({\n\t\tbg,\n\t\tpl,\n\t\ten,\n\t\tde,\n\t\tfr,\n\t\tcs\n\t})\n);\n\nconst urlLanguage = browser\n\t? new URLSearchParams(window.location.search).get('language')\n\t: undefined;\n\nconst translationsKey = (\n\turlLanguage && translations.get(urlLanguage ?? '')\n\t\t? urlLanguage\n\t\t: browser\n\t\t\t? (navigator.languages.find((l) => translations.has(l.slice(0, 2))) ?? 'en')\n\t\t\t: 'en'\n)?.slice(0, 2);\n\nexport const language = urlLanguage ?? translationsKey;\nexport const t = translationsKey ? translations.get(translationsKey)! : en;\n","import { type ClassValue, clsx } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\nimport { browser } from '$app/environment';\nimport { pushState, replaceState } from '$app/navigation';\nimport { page } from '$app/state';\nimport { trip } from '@motis-project/motis-client';\nimport { joinInterlinedLegs } from './preprocessItinerary';\nimport { language } from './i18n/translation';\nimport { tick } from 'svelte';\n\nexport function cn(...inputs: ClassValue[]) {\n\treturn twMerge(clsx(inputs));\n}\n\nconst urlParams = browser ? new URLSearchParams(window.location.search) : undefined;\n\nexport const getUrlArray = (key: string, defaultValue?: string[]): string[] => {\n\tif (urlParams) {\n\t\tconst value = urlParams.get(key);\n\t\tif (value != null) {\n\t\t\treturn value.split(',').filter((m) => m.length);\n\t\t}\n\t}\n\tif (defaultValue) {\n\t\treturn defaultValue;\n\t}\n\treturn [];\n};\n\nexport const preserveFromUrl = (\n\t// eslint-disable-next-line\n\tqueryParams: Record<string, any>,\n\tfield: string\n) => {\n\tif (urlParams?.has(field)) {\n\t\tqueryParams[field] = urlParams.get(field);\n\t}\n};\n\nexport const pushStateWithQueryString = async (\n\t// eslint-disable-next-line\n\tqueryParams: Record<string, any>,\n\n\tnewState: App.PageState,\n\treplace: boolean = false\n) => {\n\tpreserveFromUrl(queryParams, 'debug');\n\tpreserveFromUrl(queryParams, 'dark');\n\tpreserveFromUrl(queryParams, 'light');\n\tpreserveFromUrl(queryParams, 'motis');\n\tpreserveFromUrl(queryParams, 'language');\n\tconst params = new URLSearchParams(queryParams);\n\tconst updateState = replace ? replaceState : pushState;\n\ttry {\n\t\tupdateState('?' + params.toString(), newState);\n\t} catch (e) {\n\t\tconsole.log(e);\n\t\tawait tick();\n\t\tupdateState('?' + params.toString(), newState);\n\t}\n};\n\nexport const closeItinerary = () => {\n\tif (page.state.selectedStop) {\n\t\tonClickStop(\n\t\t\tpage.state.selectedStop.name,\n\t\t\tpage.state.selectedStop.stopId,\n\t\t\tpage.state.selectedStop.time,\n\t\t\tpage.state.stopArriveBy ?? false,\n\t\t\ttrue\n\t\t);\n\t\treturn;\n\t}\n\n\tpushStateWithQueryString({}, {});\n};\n\nexport const onClickStop = (\n\tname: string,\n\tstopId: string,\n\ttime: Date,\n\tarriveBy: boolean = false,\n\treplace: boolean = false\n) => {\n\tpushStateWithQueryString(\n\t\t{ stopArriveBy: arriveBy, stopId, time: time.toISOString() },\n\t\t{\n\t\t\tstopArriveBy: arriveBy,\n\t\t\tselectedStop: { name, stopId, time },\n\t\t\tselectedItinerary: replace ? undefined : page.state.selectedItinerary,\n\t\t\ttripId: replace ? undefined : page.state.tripId,\n\t\t\tactiveTab: 'departures'\n\t\t},\n\t\treplace\n\t);\n};\n\nexport const onClickTrip = async (tripId: string, replace: boolean = false) => {\n\tconst { data: itinerary, error } = await trip({\n\t\tquery: { tripId, joinInterlinedLegs: false, language: [language] }\n\t});\n\tif (error) {\n\t\tconsole.log(error);\n\t\talert(String((error as Record<string, unknown>).error?.toString() ?? error));\n\t\treturn;\n\t}\n\tjoinInterlinedLegs(itinerary!);\n\tpushStateWithQueryString(\n\t\t{ tripId },\n\t\t{\n\t\t\tselectedItinerary: itinerary,\n\t\t\ttripId: tripId,\n\t\t\tselectedStop: replace ? undefined : page.state.selectedStop,\n\t\t\tactiveTab: 'connections'\n\t\t},\n\t\treplace\n\t);\n};\n","<script lang=\"ts\">\n\timport { cn } from '$lib/utils';\n\timport type { Map, ControlPosition, IControl } from 'maplibre-gl';\n\timport { getContext, onDestroy, type Snippet } from 'svelte';\n\n\tlet {\n\t\tchildren,\n\t\tposition,\n\t\tclass: className\n\t}: {\n\t\tchildren?: Snippet;\n\t\tposition?: ControlPosition;\n\t\tclass?: string;\n\t} = $props();\n\tlet el: HTMLElement | null = null;\n\tlet initialized = $state(false);\n\n\tclass Control implements IControl {\n\t\t/* eslint-disable-next-line */\n\t\tonAdd(map: Map): HTMLElement {\n\t\t\treturn el!;\n\t\t}\n\t\t/* eslint-disable-next-line */\n\t\tonRemove(map: Map): void {\n\t\t\tel?.parentNode?.removeChild(el);\n\t\t}\n\t\tgetDefaultPosition?: (() => ControlPosition) | undefined;\n\t}\n\n\tlet ctrl = new Control();\n\tlet ctx: { map: Map | null } = getContext('map');\n\n\t$effect(() => {\n\t\tif (ctx.map && el && position != undefined) {\n\t\t\tctx.map.addControl(ctrl, position);\n\t\t\tinitialized = true;\n\t\t}\n\t});\n\n\tonDestroy(() => ctx.map?.removeControl(ctrl));\n</script>\n\n<div\n\tclass:hidden={!initialized && position != undefined}\n\tclass={cn('clear-both pointer-events-auto pt-2 md:pt-4 px-2 md:px-4 max-w-full', className)}\n\tbind:this={el}\n>\n\t{#if children}\n\t\t{@render children()}\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\timport { RadioGroup as RadioGroupPrimitive } from \"bits-ui\";\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\tvalue = $bindable(),\n\t\t...restProps\n\t}: RadioGroupPrimitive.RootProps = $props();\n\n\texport { className as class };\n</script>\n\n<RadioGroupPrimitive.Root bind:value class={cn(\"grid gap-1\", className)} {...restProps} bind:ref />\n","<script lang=\"ts\">\n\timport { RadioGroup as RadioGroupPrimitive, type WithoutChildrenOrChild } from 'bits-ui';\n\timport { Circle } from '@lucide/svelte';\n\timport { cn } from '$lib/utils.js';\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\t...restProps\n\t}: WithoutChildrenOrChild<RadioGroupPrimitive.ItemProps> & {\n\t\tvalue: string;\n\t} = $props();\n</script>\n\n<RadioGroupPrimitive.Item\n\tbind:ref\n\tclass={cn(\n\t\t'border-primary text-primary focus-visible:ring-ring aspect-square size-4 rounded-full border shadow focus:outline-none focus-visible:ring-1 disabled:cursor-not-allowed disabled:opacity-50',\n\t\tclassName\n\t)}\n\t{...restProps}\n>\n\t{#snippet children({ checked }: { checked: boolean })}\n\t\t<div class=\"flex items-center justify-center\">\n\t\t\t{#if checked}\n\t\t\t\t<Circle class=\"fill-primary size-3.5\" />\n\t\t\t{/if}\n\t\t</div>\n\t{/snippet}\n</RadioGroupPrimitive.Item>\n","<script lang=\"ts\" module>\n\timport type { WithElementRef } from \"bits-ui\";\n\timport type { HTMLAnchorAttributes, HTMLButtonAttributes } from \"svelte/elements\";\n\timport { type VariantProps, tv } from \"tailwind-variants\";\n\n\texport const buttonVariants = tv({\n\t\tbase: \"focus-visible:ring-ring inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n\t\tvariants: {\n\t\t\tvariant: {\n\t\t\t\tdefault: \"bg-primary text-primary-foreground hover:bg-primary/90 shadow\",\n\t\t\t\tdestructive:\n\t\t\t\t\t\"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm\",\n\t\t\t\toutline:\n\t\t\t\t\t\"border-input bg-background hover:bg-accent hover:text-accent-foreground border shadow-sm\",\n\t\t\t\tsecondary: \"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm\",\n\t\t\t\tghost: \"hover:bg-accent hover:text-accent-foreground\",\n\t\t\t\tlink: \"text-primary underline-offset-4 hover:underline\",\n\t\t\t\tchild: \"\",\n\t\t\t},\n\t\t\tsize: {\n\t\t\t\tdefault: \"px-4 py-2\",\n\t\t\t\tsm: \"h-8 rounded-md px-3 text-xs\",\n\t\t\t\tlg: \"h-10 rounded-md px-8\",\n\t\t\t\ticon: \"h-9 w-9\",\n\t\t\t},\n\t\t},\n\t\tdefaultVariants: {\n\t\t\tvariant: \"default\",\n\t\t\tsize: \"default\",\n\t\t},\n\t});\n\n\texport type ButtonVariant = VariantProps<typeof buttonVariants>[\"variant\"];\n\texport type ButtonSize = VariantProps<typeof buttonVariants>[\"size\"];\n\n\texport type ButtonProps = WithElementRef<HTMLButtonAttributes> &\n\t\tWithElementRef<HTMLAnchorAttributes> & {\n\t\t\tvariant?: ButtonVariant;\n\t\t\tsize?: ButtonSize;\n\t\t};\n</script>\n\n<script lang=\"ts\">\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tclass: className,\n\t\tvariant = \"default\",\n\t\tsize = \"default\",\n\t\tref = $bindable(null),\n\t\thref = undefined,\n\t\ttype = \"button\",\n\t\tchildren,\n\t\t...restProps\n\t}: ButtonProps = $props();\n</script>\n\n{#if href}\n\t<a\n\t\tbind:this={ref}\n\t\tclass={cn(buttonVariants({ variant, size }), className)}\n\t\t{href}\n\t\t{...restProps}\n\t>\n\t\t{@render children?.()}\n\t</a>\n{:else}\n\t<button\n\t\tbind:this={ref}\n\t\tclass={cn(buttonVariants({ variant, size }), className)}\n\t\t{type}\n\t\t{...restProps}\n\t>\n\t\t{@render children?.()}\n\t</button>\n{/if}\n","<script lang=\"ts\">\n\timport { Label as LabelPrimitive } from \"bits-ui\";\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\t...restProps\n\t}: LabelPrimitive.RootProps = $props();\n</script>\n\n<LabelPrimitive.Root\n\tbind:ref\n\tclass={cn(\n\t\t\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\",\n\t\tclassName\n\t)}\n\t{...restProps}\n/>\n","import maplibregl from 'maplibre-gl';\nimport type { Match } from '@motis-project/motis-client';\n\nconst COORD_LVL_REGEX = /^([+-]?\\d+(\\.\\d+)?)\\s*,\\s*([+-]?\\d+(\\.\\d+)?)\\s*,\\s*([+-]?\\d+(\\.\\d+)?)$/;\nconst COORD_REGEX = /^([+-]?\\d+(\\.\\d+)?)\\s*,\\s*([+-]?\\d+(\\.\\d+)?)$/;\n\nexport type Location = {\n\tlabel: string;\n\tmatch?: Match;\n};\n\nexport const parseCoordinatesToLocation = (str?: string): Location | undefined => {\n\tif (!str) {\n\t\treturn undefined;\n\t}\n\tconst coordinateWithLevel = str.match(COORD_LVL_REGEX);\n\tif (coordinateWithLevel) {\n\t\treturn posToLocation(\n\t\t\t[Number(coordinateWithLevel[3]), Number(coordinateWithLevel[1])],\n\t\t\tNumber(coordinateWithLevel[5])\n\t\t);\n\t}\n\n\tconst coordinate = str.match(COORD_REGEX);\n\tif (coordinate) {\n\t\treturn posToLocation([Number(coordinate[3]), Number(coordinate[1])]);\n\t}\n\n\treturn undefined;\n};\n\nexport function posToLocation(pos: maplibregl.LngLatLike, level?: number): Location {\n\tconst { lat, lng } = maplibregl.LngLat.convert(pos);\n\tconst label = level == undefined ? `${lat},${lng}` : `${lat},${lng},${level}`;\n\treturn {\n\t\tlabel,\n\t\tmatch: {\n\t\t\tlat,\n\t\t\tlon: lng,\n\t\t\tlevel,\n\t\t\tid: '',\n\t\t\tareas: [],\n\t\t\ttype: 'PLACE',\n\t\t\tname: label,\n\t\t\ttokens: [],\n\t\t\tscore: 0\n\t\t}\n\t};\n}\n\nexport const parseLocation = (\n\tplace?: string | null | undefined,\n\tname?: string | null | undefined\n): Location => {\n\tif (!place || place.trim() === '') {\n\t\treturn { label: '', match: undefined };\n\t}\n\n\tconst coord = parseCoordinatesToLocation(place);\n\tif (coord) {\n\t\tif (name) {\n\t\t\tcoord.label = name;\n\t\t\tcoord.match!.name = name;\n\t\t}\n\t\treturn coord;\n\t}\n\treturn {\n\t\tlabel: name || '',\n\t\tmatch: {\n\t\t\tlat: 0.0,\n\t\t\tlon: 0.0,\n\t\t\tlevel: 0.0,\n\t\t\tid: place,\n\t\t\tareas: [],\n\t\t\ttype: 'STOP',\n\t\t\tname: name || '',\n\t\t\ttokens: [],\n\t\t\tscore: 0\n\t\t}\n\t};\n};\n","import type { Mode, Rental } from '@motis-project/motis-client';\n\nexport type Colorable = { routeColor?: string; routeTextColor?: string; mode: Mode };\n\nexport type TripInfo = { tripId?: string; displayName?: string };\n\nexport type RentalInfo = { rental?: Rental };\n\nexport type LegLike = Colorable & TripInfo & RentalInfo;\n\nexport const getModeStyle = (l: LegLike): [string, string, string] => {\n\tswitch (l.mode) {\n\t\tcase 'WALK':\n\t\t\treturn ['walk', 'hsl(var(--foreground) / 1)', 'hsl(var(--background) / 1)'];\n\t\tcase 'BIKE':\n\t\t\treturn ['bike', 'hsl(var(--foreground) / 1)', 'hsl(var(--background) / 1)'];\n\n\t\tcase 'RENTAL':\n\t\t\tswitch (l.rental?.formFactor) {\n\t\t\t\tcase 'BICYCLE':\n\t\t\t\t\treturn ['bike', '#075985', 'white'];\n\t\t\t\tcase 'CARGO_BICYCLE':\n\t\t\t\t\treturn ['cargo_bike', '#075985', 'white'];\n\t\t\t\tcase 'CAR':\n\t\t\t\t\treturn ['car', '#4c4947', 'white'];\n\t\t\t\tcase 'MOPED':\n\t\t\t\t\treturn ['moped', '#075985', 'white'];\n\t\t\t\tcase 'SCOOTER_SEATED':\n\t\t\t\t\treturn ['seated_scooter', '#075985', 'white'];\n\t\t\t\tcase 'SCOOTER_STANDING':\n\t\t\t\t\treturn ['scooter', '#075985', 'white'];\n\t\t\t\tcase 'OTHER':\n\t\t\t\tdefault:\n\t\t\t\t\treturn ['other', '#075985', 'white'];\n\t\t\t}\n\n\t\tcase 'CAR':\n\t\tcase 'CAR_PARKING':\n\t\t\treturn ['car', '#4c4947', 'white'];\n\n\t\tcase 'FLEX':\n\t\tcase 'ODM':\n\t\t\treturn ['taxi', '#fdb813', 'white'];\n\n\t\tcase 'TRANSIT':\n\t\tcase 'BUS':\n\t\t\treturn ['bus', '#ff9800', 'white'];\n\t\tcase 'COACH':\n\t\t\treturn ['bus', '#9ccc65', 'black'];\n\n\t\tcase 'TRAM':\n\t\t\treturn ['tram', '#ebe717', 'white'];\n\n\t\tcase 'SUBURBAN':\n\t\t\treturn ['sbahn', '#4caf50', 'white'];\n\n\t\tcase 'SUBWAY':\n\t\t\treturn ['ubahn', '#3f51b5', 'white'];\n\n\t\tcase 'FERRY':\n\t\t\treturn ['ship', '#00acc1', 'white'];\n\n\t\tcase 'AIRPLANE':\n\t\t\treturn ['plane', '#90a4ae', 'white'];\n\n\t\tcase 'HIGHSPEED_RAIL':\n\t\t\treturn ['train', '#9c27b0', 'white'];\n\n\t\tcase 'LONG_DISTANCE':\n\t\t\treturn ['train', '#e91e63', 'white'];\n\n\t\tcase 'NIGHT_RAIL':\n\t\t\treturn ['train', '#1a237e', 'white'];\n\n\t\tcase 'REGIONAL_FAST_RAIL':\n\t\tcase 'REGIONAL_RAIL':\n\t\tcase 'RAIL':\n\t\t\treturn ['train', '#f44336', 'white'];\n\n\t\tcase 'FUNICULAR':\n\t\t\treturn ['funicular', '#795548', 'white'];\n\n\t\tcase 'CABLE_CAR':\n\t\t\treturn ['tram', '#795548', 'white'];\n\n\t\tcase 'AERIAL_LIFT':\n\t\t\treturn ['aerial_lift', '#795548', 'white'];\n\t}\n\n\treturn ['train', '#000000', 'white'];\n};\n\nexport const getColor = (l: Colorable): [string, string] => {\n\tconst [_, defaultColor, defaultTextColor] = getModeStyle(l);\n\tif (!l.routeColor) {\n\t\treturn [defaultColor, defaultTextColor];\n\t}\n\treturn [`#${l.routeColor}`, `#${l.routeTextColor}`];\n};\n\nexport const routeBorderColor = (l: Colorable) => {\n\treturn `border-color: ${getColor(l)[0]}`;\n};\n\nexport const routeColor = (l: Colorable) => {\n\tconst [color, textColor] = getColor(l);\n\treturn `background-color: ${color}; color: ${textColor}; fill: ${textColor}`;\n};\n","<script lang=\"ts\">\n\timport { Combobox } from 'bits-ui';\n\timport { geocode, type LocationType, type Match, type Mode } from '@motis-project/motis-client';\n\timport { MapPinHouse as House, MapPin as Place } from '@lucide/svelte';\n\timport { parseCoordinatesToLocation, type Location } from './Location';\n\timport { language } from './i18n/translation';\n\timport maplibregl from 'maplibre-gl';\n\timport { getModeStyle, type LegLike } from './modeStyle';\n\n\tlet {\n\t\titems = $bindable([]),\n\t\tselected = $bindable(),\n\t\tplaceholder,\n\t\tname,\n\t\tplace,\n\t\ttype,\n\t\ttransitModes,\n\t\tonChange = () => {}\n\t}: {\n\t\titems?: Array<Location>;\n\t\tselected: Location;\n\t\tplaceholder?: string;\n\t\tname?: string;\n\t\tplace?: maplibregl.LngLatLike;\n\t\ttype?: undefined | LocationType;\n\t\ttransitModes?: Mode[];\n\t\tonChange?: (location: Location) => void;\n\t} = $props();\n\n\tlet inputValue = $state('');\n\tlet match = $state('');\n\n\tconst getDisplayArea = (match: Match | undefined) => {\n\t\tif (match) {\n\t\t\tconst matchedArea = match.areas.find((a) => a.matched);\n\t\t\tconst defaultArea = match.areas.find((a) => a.default);\n\t\t\tif (matchedArea?.name.match(/^[0-9]*$/)) {\n\t\t\t\tmatchedArea.name += ' ' + defaultArea?.name;\n\t\t\t}\n\t\t\tlet area = (matchedArea ?? defaultArea)?.name;\n\t\t\tif (area == match.name) {\n\t\t\t\tarea = match.areas[0]!.name;\n\t\t\t}\n\n\t\t\t/* eslint-disable-next-line svelte/prefer-svelte-reactivity */\n\t\t\tconst areas = new Set<number>();\n\t\t\tmatch.areas.forEach((a, i) => {\n\t\t\t\tif (a.matched || a.unique || a.default) {\n\t\t\t\t\tareas.add(i);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst sorted = Array.from(areas);\n\t\t\tsorted.sort((a, b) => b - a);\n\n\t\t\treturn sorted.map((a) => match.areas[a].name).join(', ');\n\t\t}\n\t\treturn '';\n\t};\n\n\tconst getLabel = (match: Match) => {\n\t\tconst displayArea = getDisplayArea(match);\n\t\treturn displayArea ? match.name + ', ' + displayArea : match.name;\n\t};\n\n\tconst updateGuesses = async () => {\n\t\tconst coord = parseCoordinatesToLocation(inputValue);\n\t\tif (coord) {\n\t\t\tselected = coord;\n\t\t\titems = [];\n\t\t\tonChange(selected);\n\t\t\treturn;\n\t\t}\n\n\t\tconst pos = place ? maplibregl.LngLat.convert(place) : undefined;\n\t\tconst biasPlace = pos ? { place: `${pos.lat},${pos.lng}` } : {};\n\t\tconst { data: matches, error } = await geocode({\n\t\t\tquery: {\n\t\t\t\t...biasPlace,\n\t\t\t\ttext: inputValue,\n\t\t\t\tlanguage: [language],\n\t\t\t\tmode: transitModes,\n\t\t\t\ttype\n\t\t\t}\n\t\t});\n\t\tif (error) {\n\t\t\tconsole.error('TYPEAHEAD ERROR: ', error);\n\t\t\treturn;\n\t\t}\n\t\titems = matches!.map((match: Match): Location => {\n\t\t\treturn {\n\t\t\t\tlabel: getLabel(match),\n\t\t\t\tmatch\n\t\t\t};\n\t\t});\n\t\t/* eslint-disable-next-line svelte/prefer-svelte-reactivity */\n\t\tconst shown = new Set<string>();\n\t\titems = items.filter((x) => {\n\t\t\tconst entry = x.match?.type + x.label!;\n\t\t\tif (shown.has(entry)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tshown.add(entry);\n\t\t\treturn true;\n\t\t});\n\t};\n\n\tconst deserialize = (s: string): Location => {\n\t\tconst x = JSON.parse(s);\n\t\treturn {\n\t\t\tmatch: x,\n\t\t\tlabel: getLabel(x)\n\t\t};\n\t};\n\n\t$effect(() => {\n\t\tif (selected) {\n\t\t\tmatch = JSON.stringify(selected.match);\n\t\t\tinputValue = selected.label!;\n\t\t}\n\t});\n\n\tlet ref = $state<HTMLElement | null>(null);\n\t$effect(() => {\n\t\tif (ref && inputValue) {\n\t\t\t(ref as HTMLInputElement).value = inputValue;\n\t\t}\n\t});\n\n\tlet timer: number;\n\t$effect(() => {\n\t\tif (inputValue) {\n\t\t\tclearTimeout(timer);\n\t\t\ttimer = setTimeout(() => {\n\t\t\t\tupdateGuesses();\n\t\t\t}, 150);\n\t\t}\n\t});\n</script>\n\n{#snippet modeCircle(mode: Mode)}\n\t{@const modeIcon = getModeStyle({ mode } as LegLike)[0]}\n\t{@const modeColor = getModeStyle({ mode } as LegLike)[1]}\n\t<div\n\t\tclass=\"rounded-full flex items-center justify-center p-1\"\n\t\tstyle=\"background-color: {modeColor}; fill: white;\"\n\t>\n\t\t<svg class=\"relative size-4 rounded-full\">\n\t\t\t<use xlink:href={`#${modeIcon}`}></use>\n\t\t</svg>\n\t</div>\n{/snippet}\n\n<Combobox.Root\n\ttype=\"single\"\n\tallowDeselect={false}\n\tvalue={match}\n\tonValueChange={(e: string) => {\n\t\tif (e) {\n\t\t\tselected = deserialize(e);\n\t\t\tinputValue = selected.label!;\n\t\t\tonChange(selected);\n\t\t}\n\t}}\n>\n\t<Combobox.Input\n\t\t{placeholder}\n\t\t{name}\n\t\tbind:ref\n\t\tclass=\"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\"\n\t\tautocomplete=\"off\"\n\t\toninput={(e: Event) => (inputValue = (e.currentTarget as HTMLInputElement).value)}\n\t\taria-label={placeholder}\n\t\tdata-combobox-input={inputValue}\n\t/>\n\t{#if items.length !== 0}\n\t\t<Combobox.Portal>\n\t\t\t<Combobox.Content\n\t\t\t\talign=\"start\"\n\t\t\t\tclass=\"absolute top-2 w-[var(--bits-combobox-anchor-width)] z-10 overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md outline-none\"\n\t\t\t>\n\t\t\t\t{#each items as item (item.match)}\n\t\t\t\t\t<Combobox.Item\n\t\t\t\t\t\tclass=\"flex w-full cursor-default select-none rounded-sm py-4 pl-4 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[highlighted]:bg-accent data-[highlighted]:text-accent-foreground data-[disabled]:opacity-50\"\n\t\t\t\t\t\tvalue={JSON.stringify(item.match)}\n\t\t\t\t\t\tlabel={item.label}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex items-center grow\">\n\t\t\t\t\t\t\t{#if item.match?.type == 'STOP'}\n\t\t\t\t\t\t\t\t{@render modeCircle(item.match.modes?.length ? item.match.modes![0] : 'BUS')}\n\t\t\t\t\t\t\t{:else if item.match?.type == 'ADDRESS'}\n\t\t\t\t\t\t\t\t<House class=\"size-5\" />\n\t\t\t\t\t\t\t{:else if item.match?.type == 'PLACE'}\n\t\t\t\t\t\t\t\t{#if !item.match?.category || item.match?.category == 'none'}\n\t\t\t\t\t\t\t\t\t<Place class=\"size-5\" />\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\tsrc={`icons/${item.match?.category}.svg`}\n\t\t\t\t\t\t\t\t\t\talt={item.match?.category}\n\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t<div class=\"flex flex-col ml-4\">\n\t\t\t\t\t\t\t\t<span class=\"font-semibold text-nowrap text-ellipsis overflow-hidden\">\n\t\t\t\t\t\t\t\t\t{item.match?.name}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"text-muted-foreground text-nowrap text-ellipsis overflow-hidden\">\n\t\t\t\t\t\t\t\t\t{getDisplayArea(item.match)}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{#if item.match?.type == 'STOP'}\n\t\t\t\t\t\t\t<div class=\"mt-1 ml-4 flex flex-row gap-1.5 items-center\">\n\t\t\t\t\t\t\t\t{#each item.match.modes! as mode, i (i)}\n\t\t\t\t\t\t\t\t\t{@render modeCircle(mode)}\n\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</Combobox.Item>\n\t\t\t\t{/each}\n\t\t\t</Combobox.Content>\n\t\t</Combobox.Portal>\n\t{/if}\n</Combobox.Root>\n","<script lang=\"ts\">\n\timport { Select as SelectPrimitive, type WithoutChild } from 'bits-ui';\n\timport { Check } from '@lucide/svelte';\n\timport { cn } from '$lib/utils.js';\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\tvalue,\n\t\tlabel,\n\t\tchildren: childrenProp,\n\t\t...restProps\n\t}: WithoutChild<SelectPrimitive.ItemProps> = $props();\n</script>\n\n<SelectPrimitive.Item\n\tbind:ref\n\t{value}\n\tclass={cn(\n\t\t'data-[highlighted]:bg-accent data-[highlighted]:text-accent-foreground relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50',\n\t\tclassName\n\t)}\n\t{...restProps}\n>\n\t{#snippet children({ selected, highlighted }: { selected: boolean; highlighted: boolean })}\n\t\t<span class=\"absolute right-2 flex size-3.5 items-center justify-center\">\n\t\t\t{#if selected}\n\t\t\t\t<Check class=\"size-4\" />\n\t\t\t{/if}\n\t\t</span>\n\t\t{#if childrenProp}\n\t\t\t{@render childrenProp({ selected, highlighted })}\n\t\t{:else}\n\t\t\t{label || value}\n\t\t{/if}\n\t{/snippet}\n</SelectPrimitive.Item>\n","<script lang=\"ts\">\n\timport { Select as SelectPrimitive, type WithoutChild } from \"bits-ui\";\n\timport * as Select from \"./index.js\";\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\tsideOffset = 4,\n\t\tportalProps,\n\t\tchildren,\n\t\t...restProps\n\t}: WithoutChild<SelectPrimitive.ContentProps> & {\n\t\tportalProps?: SelectPrimitive.PortalProps;\n\t} = $props();\n</script>\n\n<SelectPrimitive.Portal {...portalProps}>\n\t<SelectPrimitive.Content\n\t\tbind:ref\n\t\t{sideOffset}\n\t\tclass={cn(\n\t\t\t\"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 bg-popover text-popover-foreground relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n\t\t\tclassName\n\t\t)}\n\t\t{...restProps}\n\t>\n\t\t<Select.ScrollUpButton />\n\t\t<SelectPrimitive.Viewport\n\t\t\tclass={cn(\n\t\t\t\t\"h-[var(--bits-select-anchor-height)] w-full min-w-[var(--bits-select-anchor-width)] p-1\"\n\t\t\t)}\n\t\t>\n\t\t\t{@render children?.()}\n\t\t</SelectPrimitive.Viewport>\n\t\t<Select.ScrollDownButton />\n\t</SelectPrimitive.Content>\n</SelectPrimitive.Portal>\n","<script lang=\"ts\">\n\timport { Select as SelectPrimitive, type WithoutChild } from 'bits-ui';\n\timport { ChevronDown } from '@lucide/svelte';\n\timport { cn } from '$lib/utils.js';\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\tchildren,\n\t\t...restProps\n\t}: WithoutChild<SelectPrimitive.TriggerProps> = $props();\n</script>\n\n<SelectPrimitive.Trigger\n\tbind:ref\n\tclass={cn(\n\t\t'border-input ring-offset-background data-[placeholder]:text-muted-foreground focus:ring-ring flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border bg-transparent px-3 py-2 text-sm shadow-sm focus:outline-none focus:ring-1 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1',\n\t\tclassName\n\t)}\n\t{...restProps}\n>\n\t{@render children?.()}\n\t<ChevronDown class=\"size-4 opacity-50\" />\n</SelectPrimitive.Trigger>\n","<script lang=\"ts\">\n\timport { Separator as SeparatorPrimitive } from \"bits-ui\";\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\torientation = \"horizontal\",\n\t\t...restProps\n\t}: SeparatorPrimitive.RootProps = $props();\n</script>\n\n<SeparatorPrimitive.Root\n\tbind:ref\n\tclass={cn(\n\t\t\"bg-border shrink-0\",\n\t\torientation === \"horizontal\" ? \"h-[1px] w-full\" : \"min-h-full w-[1px]\",\n\t\tclassName\n\t)}\n\t{orientation}\n\t{...restProps}\n/>\n","<script lang=\"ts\">\n\timport { ChevronDown } from '@lucide/svelte';\n\timport { Select as SelectPrimitive, type WithoutChildrenOrChild } from 'bits-ui';\n\timport { cn } from '$lib/utils.js';\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\t...restProps\n\t}: WithoutChildrenOrChild<SelectPrimitive.ScrollDownButtonProps> = $props();\n</script>\n\n<SelectPrimitive.ScrollDownButton\n\tbind:ref\n\tclass={cn('flex cursor-default items-center justify-center py-1', className)}\n\t{...restProps}\n>\n\t<ChevronDown class=\"size-4\" />\n</SelectPrimitive.ScrollDownButton>\n","<script lang=\"ts\">\n\timport { ChevronUp } from '@lucide/svelte';\n\timport { Select as SelectPrimitive, type WithoutChildrenOrChild } from 'bits-ui';\n\timport { cn } from '$lib/utils.js';\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\t...restProps\n\t}: WithoutChildrenOrChild<SelectPrimitive.ScrollDownButtonProps> = $props();\n</script>\n\n<SelectPrimitive.ScrollUpButton\n\tbind:ref\n\tclass={cn('flex cursor-default items-center justify-center py-1', className)}\n\t{...restProps}\n>\n\t<ChevronUp class=\"size-4\" />\n</SelectPrimitive.ScrollUpButton>\n","import { Select as SelectPrimitive } from \"bits-ui\";\n\nimport GroupHeading from \"./select-group-heading.svelte\";\nimport Item from \"./select-item.svelte\";\nimport Content from \"./select-content.svelte\";\nimport Trigger from \"./select-trigger.svelte\";\nimport Separator from \"./select-separator.svelte\";\nimport ScrollDownButton from \"./select-scroll-down-button.svelte\";\nimport ScrollUpButton from \"./select-scroll-up-button.svelte\";\n\nconst Root = SelectPrimitive.Root;\nconst Group = SelectPrimitive.Group;\n\nexport {\n\tRoot,\n\tItem,\n\tGroup,\n\tGroupHeading,\n\tContent,\n\tTrigger,\n\tSeparator,\n\tScrollDownButton,\n\tScrollUpButton,\n\t//\n\tRoot as Select,\n\tItem as SelectItem,\n\tGroup as SelectGroup,\n\tGroupHeading as SelectGroupHeading,\n\tContent as SelectContent,\n\tTrigger as SelectTrigger,\n\tSeparator as SelectSeparator,\n\tScrollDownButton as SelectScrollDownButton,\n\tScrollUpButton as SelectScrollUpButton,\n};\n","<script lang=\"ts\">\n\timport { Label, Switch } from 'bits-ui';\n\timport { cn } from '$lib/utils.js';\n\n\tlet {\n\t\tchecked = $bindable(false),\n\t\tdisabled,\n\t\tlabel,\n\t\tid,\n\t\tclass: className,\n\t\tonCheckedChange: onCheckedChange\n\t}: {\n\t\tchecked: boolean;\n\t\tdisabled?: boolean;\n\t\tlabel: string;\n\t\tid: string;\n\t\tclass?: string;\n\t\tonCheckedChange?: (checked: boolean) => void;\n\t} = $props();\n</script>\n\n<div class=\"flex items-center space-x-3 my-2\">\n\t<Switch.Root\n\t\t{id}\n\t\t{disabled}\n\t\tbind:checked\n\t\tclass={cn(\n\t\t\t'peer inline-flex h-[21px] min-h-[21px] w-[45px] shrink-0 cursor-pointer items-center rounded-full px-[3px] transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-foreground data-[state=unchecked]:bg-border data-[state=unchecked]:shadow-mini-inset dark:data-[state=checked]:bg-foreground',\n\t\t\tclassName\n\t\t)}\n\t\tonCheckedChange={onCheckedChange}\n\t>\n\t\t<Switch.Thumb\n\t\t\tclass=\"pointer-events-none block size-[15px] shrink-0 rounded-full bg-background transition-transform data-[state=checked]:translate-x-6 data-[state=unchecked]:translate-x-0 data-[state=unchecked]:shadow-mini dark:border dark:border-background/30 dark:bg-foreground dark:shadow-popover dark:data-[state=unchecked]:border\"\n\t\t/>\n\t</Switch.Root>\n\t<Label.Root for={id} class=\"text-sm font-medium\">{label}</Label.Root>\n</div>\n","import type { PlanData } from '@motis-project/motis-client';\n\nexport const defaultQuery = {\n\ttime: undefined,\n\tfromPlace: undefined,\n\ttoPlace: undefined,\n\tvia: undefined,\n\tviaMinimumStay: undefined,\n\tarriveBy: false,\n\ttimetableView: true,\n\twithFares: false,\n\tsearchWindow: 900,\n\tpedestrianProfile: 'FOOT',\n\ttransitModes: ['TRANSIT'],\n\tpreTransitModes: ['WALK'],\n\tpostTransitModes: ['WALK'],\n\tdirectModes: ['WALK'],\n\tpreTransitRentalFormFactors: [],\n\tpostTransitRentalFormFactors: [],\n\tdirectRentalFormFactors: [],\n\tpreTransitRentalProviderGroups: [],\n\tpostTransitRentalProviderGroups: [],\n\tdirectRentalProviderGroups: [],\n\tpreTransitRentalPropulsionTypes: [],\n\tpostTransitRentalPropulsionTypes: [],\n\tdirectRentalPropulsionTypes: [],\n\tignorePreTransitRentalReturnConstraints: false,\n\tignorePostTransitRentalReturnConstraints: false,\n\tignoreDirectRentalReturnConstraints: false,\n\trequireBikeTransport: false,\n\trequireCarTransport: false,\n\televationCosts: 'NONE',\n\tuseRoutedTransfers: false,\n\tjoinInterlinedLegs: true,\n\tmaxMatchingDistance: 25,\n\tmaxTransfers: 14,\n\tmaxTravelTime: 30 * 60,\n\tmaxPreTransitTime: 900,\n\tmaxPostTransitTime: 900,\n\tmaxDirectTime: 1800,\n\tfastestDirectFactor: 1.0,\n\tadditionalTransferTime: 0,\n\ttransferTimeFactor: 1,\n\tnumItineraries: 5,\n\tcircleResolution: undefined,\n\tmaxItineraries: undefined,\n\tpassengers: 1,\n\tluggage: 0,\n\tslowDirect: false,\n\tisochronesDisplayLevel: 'GEOMETRY_CIRCLES',\n\tisochronesColor: '#ffff00',\n\tisochronesOpacity: 250,\n\talgorithm: 'PONG'\n};\n\nexport const omitDefaults = (query: PlanData['query']): PlanData['query'] => {\n\tconst queryCopy: PlanData['query'] = { ...query };\n\tObject.keys(queryCopy).forEach((key) => {\n\t\tif (key in defaultQuery) {\n\t\t\tconst value = queryCopy[key as keyof PlanData['query']];\n\t\t\tconst defaultValue = defaultQuery[key as keyof typeof defaultQuery];\n\t\t\tif (JSON.stringify(value) === JSON.stringify(defaultValue)) {\n\t\t\t\tdelete queryCopy[key as keyof PlanData['query']];\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn(`Unknown query parameter: ${key}`);\n\t\t}\n\t});\n\treturn queryCopy;\n};\n","export const formatDurationMin = (t: number): string => {\n\tlet hours = Math.floor(t / 60);\n\tlet minutes = Math.ceil(t - hours * 60);\n\tif (minutes === 60) {\n\t\thours += 1;\n\t\tminutes = 0;\n\t}\n\tconst str = [\n\t\thours !== 0 ? hours + ' h' : '',\n\t\tminutes !== 0 || hours === 0 ? minutes + ' min' : ''\n\t]\n\t\t.join(' ')\n\t\t.trim();\n\treturn str;\n};\n\nexport const formatDurationSec = (t: number): string => {\n\tlet hours = Math.floor(t / 3600);\n\tlet minutes = Math.ceil((t - hours * 3600) / 60);\n\tif (minutes === 60) {\n\t\thours += 1;\n\t\tminutes = 0;\n\t}\n\tconst str = [\n\t\thours !== 0 ? hours + ' h' : '',\n\t\tminutes !== 0 || hours === 0 ? minutes + ' min' : ''\n\t]\n\t\t.join(' ')\n\t\t.trim();\n\treturn str;\n};\n\nexport const formatDistanceMeters = (m: number | undefined): string => {\n\tif (!m) return '';\n\tconst kilometers = Math.floor(m / 1000);\n\tconst meters = kilometers > 5 ? 0 : Math.ceil(m - kilometers * 1000);\n\tconst str = [kilometers !== 0 ? kilometers + ' km' : '', meters !== 0 ? meters + ' m' : '']\n\t\t.join(' ')\n\t\t.trim();\n\treturn str;\n};\n","import type { Mode, RentalFormFactor } from '@motis-project/motis-client';\n\nexport const prePostDirectModes = [\n\t'WALK',\n\t'BIKE',\n\t'CAR',\n\t'FLEX',\n\t'CAR_DROPOFF',\n\t'CAR_PARKING',\n\t'RENTAL_BICYCLE',\n\t'RENTAL_CARGO_BICYCLE',\n\t'RENTAL_CAR',\n\t'RENTAL_MOPED',\n\t'RENTAL_SCOOTER_STANDING',\n\t'RENTAL_SCOOTER_SEATED',\n\t'RENTAL_OTHER'\n] as const;\nexport type PrePostDirectMode = (typeof prePostDirectModes)[number];\n\nexport const getPrePostDirectModes = (\n\tmodes: Mode[],\n\tformFactors: RentalFormFactor[]\n): PrePostDirectMode[] => {\n\treturn modes\n\t\t.filter((mode) => prePostDirectModes.includes(mode as PrePostDirectMode))\n\t\t.map((mode) => mode as PrePostDirectMode)\n\t\t.concat(formFactors.map((formFactor) => `RENTAL_${formFactor}` as PrePostDirectMode));\n};\n\nexport const getFormFactors = (modes: PrePostDirectMode[]): RentalFormFactor[] => {\n\treturn modes\n\t\t.filter((mode) => mode.startsWith('RENTAL_'))\n\t\t.map((mode) => mode.replace('RENTAL_', '')) as RentalFormFactor[];\n};\n\nexport const prePostModesToModes = (modes: PrePostDirectMode[]): Mode[] => {\n\tconst rentalMode: Mode[] = modes.some((mode) => mode.startsWith('RENTAL_')) ? ['RENTAL'] : [];\n\tconst nonRentalModes = modes.filter((mode) => !mode.startsWith('RENTAL_'));\n\treturn [...nonRentalModes, ...rentalMode].map((mode) => mode as Mode);\n};\n\nexport const possibleTransitModes = [\n\t'AIRPLANE',\n\t'HIGHSPEED_RAIL',\n\t'LONG_DISTANCE',\n\t'NIGHT_RAIL',\n\t'COACH',\n\t'REGIONAL_FAST_RAIL',\n\t'REGIONAL_RAIL',\n\t'SUBURBAN',\n\t'SUBWAY',\n\t'TRAM',\n\t'BUS',\n\t'FERRY',\n\t'ODM',\n\t'FUNICULAR',\n\t'AERIAL_LIFT',\n\t'OTHER'\n];\nexport type TransitMode = (typeof possibleTransitModes)[number];\n","<script lang=\"ts\">\n\timport * as Select from '$lib/components/ui/select';\n\n\texport type NumberSelectOption = { value: string; label: string };\n\n\tlet {\n\t\tvalue = $bindable(),\n\t\tpossibleValues,\n\t\tlabelFormatter = (v) => v.toString()\n\t}: {\n\t\tvalue: number;\n\t\tpossibleValues: NumberSelectOption[];\n\t\tlabelFormatter?: (v: number) => string;\n\t} = $props();\n</script>\n\n<Select.Root\n\ttype=\"single\"\n\tbind:value={() => value.toString(), (v) => (value = parseInt(v))}\n\titems={possibleValues}\n>\n\t<Select.Trigger class=\"flex items-center w-full overflow-hidden\" aria-label=\"max travel time\">\n\t\t<div class=\"w-full text-right pr-4\">{labelFormatter(value)}</div>\n\t</Select.Trigger>\n\t<Select.Content align=\"end\">\n\t\t{#each possibleValues as option, i (i + option.value)}\n\t\t\t<Select.Item value={option.value} label={option.label}>\n\t\t\t\t<div class=\"w-full text-right pr-2\">{option.label}</div>\n\t\t\t</Select.Item>\n\t\t{/each}\n\t</Select.Content>\n</Select.Root>\n","import { browser } from '$app/environment';\nimport type {\n\tRentalFormFactor,\n\tRentalPropulsionType,\n\tRentalReturnConstraint\n} from '@motis-project/motis-client';\nimport {\n\tFlagTriangleLeft,\n\tFuel,\n\tPlugZap,\n\tRefreshCcw,\n\tZap,\n\ttype Icon as LucideIcon\n} from '@lucide/svelte';\nimport { t } from '$lib/i18n/translation';\n\nexport type FormFactorAssets = {\n\tsvg: string;\n\tstation: string;\n\tvehicle: string;\n\tcluster: string;\n\tlabel: string;\n};\n\ntype IconDimensions = {\n\twidth: number;\n\theight: number;\n};\n\nexport type MapLibreImageSource = ImageBitmap | HTMLImageElement;\n\nexport const DEFAULT_FORM_FACTOR: RentalFormFactor = 'BICYCLE';\n\nexport const ICON_TYPES = ['station', 'vehicle', 'cluster'] as const;\nexport type IconType = (typeof ICON_TYPES)[number];\n\nexport const ICON_BASE_PATH = 'icons/rental/';\n\nexport const formFactorAssets: Record<RentalFormFactor, FormFactorAssets> = {\n\tBICYCLE: {\n\t\tsvg: 'bike',\n\t\tstation: 'bike_station',\n\t\tvehicle: 'floating_bike',\n\t\tcluster: 'floating_bike_cluster',\n\t\tlabel: t.bike\n\t},\n\tCARGO_BICYCLE: {\n\t\tsvg: 'cargo_bike',\n\t\tstation: 'cargo_bike_station',\n\t\tvehicle: 'floating_cargo_bike',\n\t\tcluster: 'floating_cargo_bike_cluster',\n\t\tlabel: t.cargoBike\n\t},\n\tCAR: {\n\t\tsvg: 'car',\n\t\tstation: 'car_station',\n\t\tvehicle: 'floating_car',\n\t\tcluster: 'floating_car_cluster',\n\t\tlabel: t.car\n\t},\n\tMOPED: {\n\t\tsvg: 'moped',\n\t\tstation: 'moped_station',\n\t\tvehicle: 'floating_moped',\n\t\tcluster: 'floating_moped_cluster',\n\t\tlabel: t.moped\n\t},\n\tSCOOTER_SEATED: {\n\t\tsvg: 'seated_scooter',\n\t\tstation: 'seated_scooter_station',\n\t\tvehicle: 'floating_seated_scooter',\n\t\tcluster: 'floating_seated_scooter_cluster',\n\t\tlabel: t.scooterSeated\n\t},\n\tSCOOTER_STANDING: {\n\t\tsvg: 'scooter',\n\t\tstation: 'scooter_station',\n\t\tvehicle: 'floating_scooter',\n\t\tcluster: 'floating_scooter_cluster',\n\t\tlabel: t.scooterStanding\n\t},\n\tOTHER: {\n\t\tsvg: 'other',\n\t\tstation: 'other_station',\n\t\tvehicle: 'floating_other',\n\t\tcluster: 'floating_other_cluster',\n\t\tlabel: t.unknownVehicleType\n\t}\n};\n\nexport const propulsionTypes: Record<\n\tRentalPropulsionType,\n\t{ component: typeof LucideIcon; title: string } | null\n> = {\n\tELECTRIC: { component: Zap, title: t.electric },\n\tELECTRIC_ASSIST: { component: Zap, title: t.electricAssist },\n\tHYBRID: { component: PlugZap, title: t.hybrid },\n\tPLUG_IN_HYBRID: { component: PlugZap, title: t.plugInHybrid },\n\tCOMBUSTION: { component: Fuel, title: t.combustion },\n\tCOMBUSTION_DIESEL: { component: Fuel, title: t.combustionDiesel },\n\tHYDROGEN_FUEL_CELL: { component: Fuel, title: t.hydrogenFuelCell },\n\tHUMAN: null\n};\n\nexport const returnConstraints: Record<\n\tRentalReturnConstraint,\n\t{ component: typeof LucideIcon; title: string } | null\n> = {\n\tANY_STATION: { component: FlagTriangleLeft, title: t.returnOnlyAtStations },\n\tROUNDTRIP_STATION: { component: RefreshCcw, title: t.roundtripStationReturnConstraint },\n\tNONE: null\n};\n\nexport const getIconBaseName = (formFactor: RentalFormFactor, type: IconType) =>\n\tformFactorAssets[formFactor][type];\n\nexport const getIconUrl = (formFactor: RentalFormFactor, type: IconType) =>\n\t`${ICON_BASE_PATH}${getIconBaseName(formFactor, type)}.svg`;\n\nconst iconTypeDimensions: Record<IconType, IconDimensions> = {\n\tstation: { width: 43, height: 44 },\n\tvehicle: { width: 27, height: 27 },\n\tcluster: { width: 35, height: 36 }\n};\n\nexport const getIconDimensions = (type: IconType): IconDimensions => iconTypeDimensions[type];\n\nexport async function colorizeIcon(\n\tsvgUrl: string,\n\tcolor: string,\n\tdimensions: IconDimensions\n): Promise<MapLibreImageSource> {\n\tif (!browser) {\n\t\tthrow new Error('colorizeIcon is not supported in this environment');\n\t}\n\n\tconst response = await fetch(svgUrl);\n\tif (!response.ok) {\n\t\tthrow new Error(`Failed to load icon: ${response.status} ${response.statusText}`);\n\t}\n\n\tconst svgContent = await response.text();\n\tconst parser = new DOMParser();\n\tconst svgDoc = parser.parseFromString(svgContent, 'image/svg+xml');\n\n\tif (svgDoc.getElementsByTagName('parsererror').length > 0) {\n\t\tthrow new Error('Invalid SVG content');\n\t}\n\n\tconst rootElement = svgDoc.documentElement;\n\tif (!(rootElement instanceof SVGSVGElement)) {\n\t\tthrow new Error('Provided file is not an SVG');\n\t}\n\tconst svgRoot = rootElement;\n\n\tif (!svgRoot.getAttribute('xmlns')) {\n\t\tsvgRoot.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n\t}\n\n\tconst existingStyle = svgRoot.getAttribute('style');\n\tconst colorStyle = `color: ${color}`;\n\tconst mergedStyle = existingStyle ? `${existingStyle};${colorStyle}` : colorStyle;\n\tsvgRoot.setAttribute('style', mergedStyle);\n\tsvgRoot.setAttribute('color', color);\n\tsvgRoot.setAttribute('width', `${dimensions.width}`);\n\tsvgRoot.setAttribute('height', `${dimensions.height}`);\n\n\tconst serializer = new XMLSerializer();\n\tconst serialized = serializer.serializeToString(svgDoc);\n\tconst blob = new Blob([serialized], { type: 'image/svg+xml;charset=utf-8' });\n\n\tif (typeof createImageBitmap === 'function') {\n\t\ttry {\n\t\t\tconst bitmap = await createImageBitmap(blob);\n\t\t\treturn bitmap;\n\t\t} catch (_error) {} // eslint-disable-line\n\t}\n\n\treturn await new Promise<MapLibreImageSource>((resolve, reject) => {\n\t\tconst blob_url = URL.createObjectURL(blob);\n\t\tconst image = new Image();\n\t\timage.crossOrigin = 'anonymous';\n\t\timage.decoding = 'async';\n\t\timage.onload = () => {\n\t\t\tURL.revokeObjectURL(blob_url);\n\t\t\tif (dimensions) {\n\t\t\t\timage.width = dimensions.width;\n\t\t\t\timage.height = dimensions.height;\n\t\t\t}\n\t\t\tresolve(image);\n\t\t};\n\t\timage.onerror = () => {\n\t\t\tURL.revokeObjectURL(blob_url);\n\t\t\treject(new Error('Failed to load generated image'));\n\t\t};\n\t\timage.src = blob_url;\n\t});\n}\n","import type { ExpressionSpecification } from 'maplibre-gl';\n\nexport const createZoomScaledSize = (baseSize: number): ExpressionSpecification => [\n\t'interpolate',\n\t['linear'],\n\t['zoom'],\n\t14,\n\tbaseSize * 0.6,\n\t18,\n\tbaseSize\n];\n\nexport const zoomScaledIconSize = createZoomScaledSize(1);\nexport const zoomScaledTextSizeMedium = createZoomScaledSize(12);\nexport const zoomScaledTextSizeSmall = createZoomScaledSize(10);\n\nexport const createZoomScaledTextOffset = (\n\tbaseOffset: [number, number]\n): ExpressionSpecification => [\n\t'interpolate',\n\t['linear'],\n\t['zoom'],\n\t14,\n\t['literal', [baseOffset[0] * 0.8, baseOffset[1] * 0.9]],\n\t18,\n\t['literal', baseOffset]\n];\n\nexport const zoomScaledTextOffset = createZoomScaledTextOffset([0.8, -1.25]);\n\nexport const DEFAULT_COLOR = '#2563eb';\nexport const DEFAULT_CONTRAST_COLOR = '#ffffff';\n","<script lang=\"ts\">\n\timport { t } from '$lib/i18n/translation';\n\timport { cn } from '$lib/utils';\n\timport * as Select from '$lib/components/ui/select';\n\timport { Switch } from '$lib/components/ui/switch';\n\timport { formatDurationSec } from '$lib/formatDuration';\n\timport { type PrePostDirectMode, getFormFactors } from '$lib/Modes';\n\timport { formFactorAssets } from '$lib/map/rentals/assets';\n\timport { DEFAULT_COLOR } from '$lib/map/rentals/style';\n\timport { rentals, type RentalFormFactor } from '@motis-project/motis-client';\n\timport { createQuery } from '@tanstack/svelte-query';\n\n\tlet {\n\t\tlabel,\n\t\tdisabled,\n\t\tmodes = $bindable(),\n\t\tmaxTransitTime = $bindable(),\n\t\tpossibleModes,\n\t\tpossibleMaxTransitTime,\n\t\tignoreRentalReturnConstraints = $bindable(),\n\t\tproviderGroups = $bindable()\n\t}: {\n\t\tlabel: string;\n\t\tdisabled?: boolean;\n\t\tmodes: PrePostDirectMode[];\n\t\tmaxTransitTime: number;\n\t\tpossibleModes: readonly PrePostDirectMode[];\n\t\tpossibleMaxTransitTime: number[];\n\t\tignoreRentalReturnConstraints: boolean;\n\t\tproviderGroups: string[];\n\t} = $props();\n\n\ttype TranslationKey = keyof typeof t;\n\n\tconst availableModes = possibleModes.map((value) => ({\n\t\tvalue,\n\t\tlabel: t[value as TranslationKey] as string\n\t}));\n\n\ttype ProviderOption = {\n\t\tid: string;\n\t\tname: string;\n\t\tcolor: string;\n\t\tformFactors: RentalFormFactor[];\n\t};\n\n\tconst providerGroupsQuery = createQuery(() => ({\n\t\tqueryKey: ['rentalProviderGroups'],\n\t\tqueryFn: async () => {\n\t\t\tconst { data, error } = await rentals({ query: { withProviders: false } });\n\t\t\tif (error) {\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t\treturn data;\n\t\t},\n\t\tstaleTime: 0\n\t}));\n\n\tconst allProviderGroupOptions = $derived.by((): ProviderOption[] => {\n\t\treturn (providerGroupsQuery.data?.providerGroups || [])\n\t\t\t.map((group) => ({\n\t\t\t\tid: group.id,\n\t\t\t\tname: group.name,\n\t\t\t\tcolor: group.color ?? DEFAULT_COLOR,\n\t\t\t\tformFactors: group.formFactors\n\t\t\t}))\n\t\t\t.sort((a, b) => a.name.localeCompare(b.name));\n\t});\n\n\tconst selectedRentalFormFactors = $derived(getFormFactors(modes));\n\n\tconst providerGroupOptions = $derived.by((): ProviderOption[] => {\n\t\tif (selectedRentalFormFactors.length === 0) {\n\t\t\treturn allProviderGroupOptions;\n\t\t}\n\t\treturn allProviderGroupOptions.filter((option) => {\n\t\t\treturn option.formFactors.some((formFactor) =>\n\t\t\t\tselectedRentalFormFactors.includes(formFactor)\n\t\t\t);\n\t\t});\n\t});\n\n\tconst containsRental = (modes: PrePostDirectMode[]) =>\n\t\tmodes.some((mode) => mode.startsWith('RENTAL_'));\n\n\tconst showRental = $derived(containsRental(modes));\n\n\t$effect(() => {\n\t\tif (!providerGroupOptions.length) {\n\t\t\treturn;\n\t\t}\n\t\tconst deduped = Array.from(new Set(providerGroups));\n\t\tif (deduped.length !== providerGroups.length) {\n\t\t\tproviderGroups = deduped;\n\t\t\treturn;\n\t\t}\n\t\tconst validIds = new Set(providerGroupOptions.map((option) => option.id));\n\t\tconst filtered = deduped.filter((id) => validIds.has(id));\n\t\tif (filtered.length !== deduped.length) {\n\t\t\tproviderGroups = filtered;\n\t\t\treturn;\n\t\t}\n\t\tif (filtered.length && filtered.length === validIds.size) {\n\t\t\tproviderGroups = [];\n\t\t}\n\t});\n\n\tconst selectedModesLabel = $derived(\n\t\tavailableModes\n\t\t\t.filter((m) => modes?.includes(m.value))\n\t\t\t.map((m) => m.label)\n\t\t\t.join(', ')\n\t);\n\n\tconst selectedProviderGroupsLabel = $derived.by(() => {\n\t\tconst names = providerGroupOptions\n\t\t\t.filter((option) => providerGroups.includes(option.id))\n\t\t\t.map((option) => option.name);\n\t\treturn names.length ? names.join(', ') : t.defaultSelectedProviders;\n\t});\n</script>\n\n<div class=\"grid grid-cols-[1fr_2fr_1fr] items-center gap-2\">\n\t<div class=\"text-sm\">\n\t\t{label}\n\t</div>\n\t<Select.Root {disabled} type=\"multiple\" bind:value={modes}>\n\t\t<Select.Trigger class=\"flex items-center w-full overflow-hidden\" aria-label={label}>\n\t\t\t<span>{selectedModesLabel}</span>\n\t\t</Select.Trigger>\n\t\t<Select.Content sideOffset={10}>\n\t\t\t{#each possibleModes as mode, i (i + mode)}\n\t\t\t\t<Select.Item value={mode} label={t[mode as TranslationKey] as string}>\n\t\t\t\t\t{t[mode as TranslationKey]}\n\t\t\t\t</Select.Item>\n\t\t\t{/each}\n\t\t</Select.Content>\n\t</Select.Root>\n\t<Select.Root\n\t\t{disabled}\n\t\ttype=\"single\"\n\t\tbind:value={() => maxTransitTime.toString(), (v) => (maxTransitTime = parseInt(v))}\n\t>\n\t\t<Select.Trigger\n\t\t\tclass=\"flex items-center w-full overflow-hidden\"\n\t\t\taria-label={t.routingSegments.maxPreTransitTime}\n\t\t>\n\t\t\t{formatDurationSec(maxTransitTime)}\n\t\t</Select.Trigger>\n\t\t<Select.Content sideOffset={10}>\n\t\t\t{#each possibleMaxTransitTime as duration (duration)}\n\t\t\t\t<Select.Item value={`${duration}`} label={formatDurationSec(duration)}>\n\t\t\t\t\t{formatDurationSec(duration)}\n\t\t\t\t</Select.Item>\n\t\t\t{/each}\n\t\t</Select.Content>\n\t</Select.Root>\n\t<div class={cn('text-sm', showRental || 'hidden')}>\n\t\t{t.sharingProviders}\n\t</div>\n\t<div class={cn('col-span-2 col-start-2', showRental || 'hidden')}>\n\t\t<Select.Root {disabled} type=\"multiple\" bind:value={providerGroups}>\n\t\t\t<Select.Trigger\n\t\t\t\tclass=\"flex items-center w-full overflow-hidden\"\n\t\t\t\taria-label={t.sharingProviders}\n\t\t\t>\n\t\t\t\t<span>{selectedProviderGroupsLabel}</span>\n\t\t\t</Select.Trigger>\n\t\t\t<Select.Content sideOffset={10} class=\"max-w-[100svw]\">\n\t\t\t\t{#each providerGroupOptions as option (option.id)}\n\t\t\t\t\t<Select.Item value={option.id} label={option.name}>\n\t\t\t\t\t\t<div class=\"flex w-full items-center justify-between gap-2\">\n\t\t\t\t\t\t\t<span class=\"truncate\">{option.name}</span>\n\t\t\t\t\t\t\t{#if option.formFactors.length}\n\t\t\t\t\t\t\t\t<div class=\"flex items-center gap-1\" style={`color: ${option.color}`}>\n\t\t\t\t\t\t\t\t\t{#each Array.from(new Set(option.formFactors.map((ff) => formFactorAssets[ff].svg))).sort() as icon (icon)}\n\t\t\t\t\t\t\t\t\t\t<svg class=\"h-4 w-4 fill-current\" aria-hidden=\"true\" focusable=\"false\">\n\t\t\t\t\t\t\t\t\t\t\t<use href={`#${icon}`} />\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Select.Item>\n\t\t\t\t{/each}\n\t\t\t</Select.Content>\n\t\t</Select.Root>\n\t</div>\n\t<div class={cn('col-span-2 col-start-2', showRental || 'hidden')}>\n\t\t<Switch\n\t\t\t{disabled}\n\t\t\tbind:checked={\n\t\t\t\t() => !ignoreRentalReturnConstraints, (v) => (ignoreRentalReturnConstraints = !v)\n\t\t\t}\n\t\t\tlabel={t.considerRentalReturnConstraints}\n\t\t\tid=\"ignorePreTransitRentalReturnConstraints\"\n\t\t/>\n\t</div>\n</div>\n","<script lang=\"ts\">\n\timport { t } from '$lib/i18n/translation';\n\timport { BusFront } from '@lucide/svelte';\n\timport * as Select from '$lib/components/ui/select';\n\timport { possibleTransitModes, type TransitMode } from '$lib/Modes';\n\n\tlet {\n\t\ttransitModes = $bindable()\n\t}: {\n\t\ttransitModes: TransitMode[];\n\t} = $props();\n\n\ttype TranslationKey = keyof typeof t;\n\n\tconst availableTransitModes = possibleTransitModes.map((value) => ({\n\t\tvalue,\n\t\tlabel: t[value as TranslationKey] as string\n\t}));\n\n\tconst selectTransitModesLabel = $derived(\n\t\ttransitModes.length == possibleTransitModes.length || transitModes.includes('TRANSIT')\n\t\t\t? t.defaultSelectedModes\n\t\t\t: availableTransitModes\n\t\t\t\t\t.filter((m) => transitModes?.includes(m.value))\n\t\t\t\t\t.map((m) => m.label)\n\t\t\t\t\t.join(', ')\n\t);\n</script>\n\n<Select.Root type=\"multiple\" bind:value={transitModes}>\n\t<Select.Trigger\n\t\tclass=\"flex items-center w-full overflow-hidden\"\n\t\taria-label={t.selectTransitModes}\n\t>\n\t\t<BusFront class=\"mr-[9px] size-6 text-muted-foreground shrink-0\" />\n\t\t{selectTransitModesLabel}\n\t</Select.Trigger>\n\t<Select.Content sideOffset={10}>\n\t\t{#each availableTransitModes as mode, i (i + mode.value)}\n\t\t\t<Select.Item value={mode.value} label={mode.label}>\n\t\t\t\t{mode.label}\n\t\t\t</Select.Item>\n\t\t{/each}\n\t</Select.Content>\n</Select.Root>\n","export const generateTimes = (limit: number): number[] => {\n\tconst times: number[] = [];\n\tlet t = 1;\n\twhile (t <= limit / 60) {\n\t\ttimes.push(t * 60);\n\t\tif (t < 5) {\n\t\t\tt += 4;\n\t\t} else if (t < 30) {\n\t\t\tt += 5;\n\t\t} else if (t < 60) {\n\t\t\tt += 10;\n\t\t} else if (t < 120) {\n\t\t\tt += 30;\n\t\t} else {\n\t\t\tt += 60;\n\t\t}\n\t}\n\tif (times[times.length - 1] !== limit) {\n\t\ttimes.push(limit);\n\t}\n\n\treturn times;\n};\n","<script lang=\"ts\">\n\timport { X } from '@lucide/svelte';\n\timport AddressTypeahead from '$lib/AddressTypeahead.svelte';\n\timport { Button } from './components/ui/button';\n\timport NumberSelect from './NumberSelect.svelte';\n\timport { t } from './i18n/translation';\n\timport type { Location } from '$lib/Location';\n\timport { generateTimes } from './generateTimes';\n\timport { formatDurationMin } from './formatDuration';\n\n\tlet {\n\t\tvia = $bindable(),\n\t\tviaMinimumStay = $bindable(),\n\t\tviaLabels = $bindable()\n\t}: {\n\t\tvia: undefined | Location[];\n\t\tviaMinimumStay: undefined | number[];\n\t\tviaLabels: Record<string, string>;\n\t} = $props();\n\n\tconst possibleViaStayDurations = $derived([0, ...generateTimes(2 * 60 * 60)]);\n\tconst viaMinimumStayOptions = $derived(\n\t\tpossibleViaStayDurations.map((duration) => ({\n\t\t\tvalue: (duration / 60).toString(),\n\t\t\tlabel: formatDurationMin(duration / 60)\n\t\t}))\n\t);\n\n\ttype Via = {\n\t\tmatch: Location;\n\t\tstay: number;\n\t};\n\tlet vias = $state<Via[]>(\n\t\tvia?.map(\n\t\t\t(_, i): Via => ({\n\t\t\t\tmatch: via![i],\n\t\t\t\tstay: viaMinimumStay?.[i] ?? 0\n\t\t\t})\n\t\t) ?? []\n\t);\n\tconst add = () => {\n\t\tvias.push({ stay: 0, match: { label: '', match: undefined } });\n\t};\n\tconst remove = (index: number) => {\n\t\tvias = vias.filter((_, i) => i !== index);\n\t};\n\n\t$effect(() => {\n\t\tconst filtered = vias.filter((v) => v.match?.match?.id).map((v) => $state.snapshot(v));\n\n\t\tconst oldVia = $state.snapshot(via);\n\t\tconst nextVia = filtered.length > 0 ? filtered.map((f) => f.match) : undefined;\n\t\tif (JSON.stringify(nextVia) != JSON.stringify(oldVia)) {\n\t\t\tvia = nextVia;\n\t\t}\n\n\t\tconst oldViaMinimumStay = $state.snapshot(viaMinimumStay);\n\t\tconst nextViaMinimumStay = filtered.length > 0 ? filtered.map((f) => f.stay) : undefined;\n\t\tif (JSON.stringify(nextViaMinimumStay) != JSON.stringify(oldViaMinimumStay)) {\n\t\t\tviaMinimumStay = nextViaMinimumStay;\n\t\t}\n\n\t\tconst nextViaLabels: Record<string, string> = {};\n\t\tfiltered.forEach((f, i) => {\n\t\t\tnextViaLabels[`viaLabel${i}`] = f.match.label;\n\t\t});\n\t\tObject.keys(viaLabels).forEach((key) => {\n\t\t\tif (!(key in nextViaLabels)) {\n\t\t\t\tdelete viaLabels[key];\n\t\t\t}\n\t\t});\n\t\tObject.keys(nextViaLabels).forEach((key) => {\n\t\t\tif (viaLabels[key] !== nextViaLabels[key]) {\n\t\t\t\tviaLabels[key] = nextViaLabels[key];\n\t\t\t}\n\t\t});\n\t});\n</script>\n\n<div class=\"space-y-2\">\n\t<div class=\"flex items-center justify-between\">\n\t\t<div class=\"text-sm\">\n\t\t\t{t.viaStops}\n\t\t</div>\n\t\t<Button variant=\"outline\" onclick={add} disabled={vias.length >= 2}>\n\t\t\t{t.addViaStop}\n\t\t</Button>\n\t</div>\n\t<div class=\"space-y-2\">\n\t\t{#each vias as _viaStop, index (index)}\n\t\t\t<div class=\"flex gap-2 items-start\">\n\t\t\t\t<div class=\"grow flex flex-col gap-1\">\n\t\t\t\t\t<div class=\"flex gap-2\">\n\t\t\t\t\t\t<div class=\"grow\">\n\t\t\t\t\t\t\t<AddressTypeahead\n\t\t\t\t\t\t\t\tplaceholder={t.viaStop}\n\t\t\t\t\t\t\t\tname={`via-${index}`}\n\t\t\t\t\t\t\t\tbind:selected={vias[index].match}\n\t\t\t\t\t\t\t\ttype=\"STOP\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"w-24\">\n\t\t\t\t\t\t\t<NumberSelect\n\t\t\t\t\t\t\t\tbind:value={vias[index].stay}\n\t\t\t\t\t\t\t\tpossibleValues={viaMinimumStayOptions}\n\t\t\t\t\t\t\t\tlabelFormatter={formatDurationMin}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\tonclick={() => remove(index)}\n\t\t\t\t\taria-label={t.removeViaStop}\n\t\t\t\t>\n\t\t\t\t\t<X class=\"size-4\" />\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t{/each}\n\t</div>\n</div>\n","<script lang=\"ts\">\n\timport type { Snippet } from 'svelte';\n\timport Button from '$lib/components/ui/button/button.svelte';\n\timport { t } from '$lib/i18n/translation';\n\timport * as Select from '$lib/components/ui/select';\n\timport { ChevronUp, ChevronDown } from '@lucide/svelte';\n\timport { Switch } from './components/ui/switch';\n\timport type { ElevationCosts, ServerConfig } from '@motis-project/motis-client';\n\timport { defaultQuery } from '$lib/defaults';\n\timport type { Location } from '$lib/Location';\n\timport { formatDurationSec } from './formatDuration';\n\timport {\n\t\tpossibleTransitModes,\n\t\tprePostDirectModes,\n\t\ttype PrePostDirectMode,\n\t\ttype TransitMode\n\t} from './Modes';\n\timport NumberSelect from '$lib/NumberSelect.svelte';\n\timport StreetModes from '$lib/StreetModes.svelte';\n\timport TransitModeSelect from '$lib/TransitModeSelect.svelte';\n\timport { type NumberSelectOption } from '$lib/NumberSelect.svelte';\n\timport { generateTimes } from './generateTimes';\n\timport ViaStopOptions from './ViaStopOptions.svelte';\n\n\tlet {\n\t\tuseRoutedTransfers = $bindable(),\n\t\tserverConfig,\n\t\twheelchair = $bindable(),\n\t\trequireBikeTransport = $bindable(),\n\t\trequireCarTransport = $bindable(),\n\t\ttransitModes = $bindable(),\n\t\tmaxTransfers = $bindable(),\n\t\tmaxTravelTime = $bindable(undefined),\n\t\tpossibleMaxTravelTimes = [],\n\t\tpreTransitModes = $bindable(),\n\t\tpostTransitModes = $bindable(),\n\t\tdirectModes = $bindable(undefined),\n\t\tmaxPreTransitTime = $bindable(),\n\t\tmaxPostTransitTime = $bindable(),\n\t\tmaxDirectTime = $bindable(undefined),\n\t\televationCosts = $bindable(),\n\t\tignorePreTransitRentalReturnConstraints = $bindable(),\n\t\tignorePostTransitRentalReturnConstraints = $bindable(),\n\t\tignoreDirectRentalReturnConstraints = $bindable(),\n\t\tpreTransitProviderGroups = $bindable(),\n\t\tpostTransitProviderGroups = $bindable(),\n\t\tdirectProviderGroups = $bindable(),\n\t\tvia = $bindable(),\n\t\tviaMinimumStay = $bindable(),\n\t\tviaLabels = $bindable(),\n\t\tadditionalComponents\n\t}: {\n\t\tuseRoutedTransfers: boolean;\n\t\tserverConfig: ServerConfig | undefined;\n\t\twheelchair: boolean;\n\t\trequireBikeTransport: boolean;\n\t\trequireCarTransport: boolean;\n\t\ttransitModes: TransitMode[];\n\t\tmaxTransfers: number;\n\t\tmaxTravelTime: number | undefined;\n\t\tpossibleMaxTravelTimes?: NumberSelectOption[];\n\t\tpreTransitModes: PrePostDirectMode[];\n\t\tpostTransitModes: PrePostDirectMode[];\n\t\tdirectModes: PrePostDirectMode[] | undefined;\n\t\tmaxPreTransitTime: number;\n\t\tmaxPostTransitTime: number;\n\t\tmaxDirectTime: number | undefined;\n\t\televationCosts: ElevationCosts;\n\t\tignorePreTransitRentalReturnConstraints: boolean;\n\t\tignorePostTransitRentalReturnConstraints: boolean;\n\t\tignoreDirectRentalReturnConstraints: boolean | undefined;\n\t\tpreTransitProviderGroups: string[];\n\t\tpostTransitProviderGroups: string[];\n\t\tdirectProviderGroups: string[];\n\t\tvia: undefined | Location[];\n\t\tviaMinimumStay: undefined | number[];\n\t\tviaLabels: Record<string, string>;\n\t\tadditionalComponents?: Snippet;\n\t} = $props();\n\n\tconst possibleMaxTransfers = [...Array(defaultQuery.maxTransfers + 1).keys()].map((i) => ({\n\t\tvalue: i.toString(),\n\t\tlabel: i.toString()\n\t}));\n\n\tconst possibleDirectDurations = $derived(\n\t\tgenerateTimes(serverConfig?.maxDirectTimeLimit ?? 60 * 60)\n\t);\n\tconst possiblePrePostDurations = $derived(\n\t\tgenerateTimes(serverConfig?.maxPrePostTransitTimeLimit ?? 60 * 60)\n\t);\n\n\tfunction setModes(mode: PrePostDirectMode) {\n\t\treturn function (checked: boolean) {\n\t\t\tif (checked) {\n\t\t\t\tpreTransitModes = [mode];\n\t\t\t\tpostTransitModes = [mode];\n\t\t\t\tdirectModes = [mode];\n\t\t\t}\n\t\t};\n\t}\n\tif (transitModes.includes('TRANSIT')) {\n\t\ttransitModes = [...possibleTransitModes];\n\t}\n\tif (requireBikeTransport) {\n\t\tsetModes('BIKE')(true);\n\t}\n\tif (requireCarTransport) {\n\t\tsetModes('CAR')(true);\n\t}\n\n\tconst possibleElevationCosts = [\n\t\t{ value: 'NONE' as ElevationCosts, label: t.elevationCosts.NONE },\n\t\t{ value: 'LOW' as ElevationCosts, label: t.elevationCosts.LOW },\n\t\t{ value: 'HIGH' as ElevationCosts, label: t.elevationCosts.HIGH }\n\t];\n\tlet expanded = $state<boolean>(false);\n\tlet allowElevationCosts = $derived(\n\t\tserverConfig?.hasElevation &&\n\t\t\t(requireBikeTransport ||\n\t\t\t\tpreTransitModes.includes('BIKE') ||\n\t\t\t\tpostTransitModes.includes('BIKE') ||\n\t\t\t\tdirectModes?.includes('BIKE'))\n\t);\n\tlet allowStreetRouting = $derived(serverConfig?.hasStreetRouting);\n\tlet allowRoutedTransfers = $derived(serverConfig?.hasRoutedTransfers);\n</script>\n\n<Button variant=\"ghost\" onclick={() => (expanded = !expanded)}>\n\t{t.advancedSearchOptions}\n\t{#if expanded}\n\t\t<ChevronUp class=\"size-[18px]\" />\n\t{:else}\n\t\t<ChevronDown class=\"size-[18px]\" />\n\t{/if}\n</Button>\n\n{#if expanded}\n\t<div class=\"w-full space-y-4\">\n\t\t<TransitModeSelect bind:transitModes />\n\n\t\t<div class=\"space-y-2\">\n\t\t\t<Switch\n\t\t\t\tbind:checked={useRoutedTransfers}\n\t\t\t\tdisabled={!allowRoutedTransfers}\n\t\t\t\tlabel={t.useRoutedTransfers}\n\t\t\t\tid=\"useRoutedTransfers\"\n\t\t\t\tonCheckedChange={(checked) => {\n\t\t\t\t\tif (wheelchair && !checked) {\n\t\t\t\t\t\twheelchair = false;\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t/>\n\n\t\t\t<Switch\n\t\t\t\tbind:checked={wheelchair}\n\t\t\t\tdisabled={!allowRoutedTransfers}\n\t\t\t\tlabel={t.wheelchair}\n\t\t\t\tid=\"wheelchair\"\n\t\t\t\tonCheckedChange={(checked) => {\n\t\t\t\t\tif (checked && !useRoutedTransfers) {\n\t\t\t\t\t\tuseRoutedTransfers = true;\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<Switch\n\t\t\t\tbind:checked={requireBikeTransport}\n\t\t\t\tlabel={t.requireBikeTransport}\n\t\t\t\tonCheckedChange={setModes('BIKE')}\n\t\t\t\tid=\"requireBikeTransport\"\n\t\t\t/>\n\t\t\t<Switch\n\t\t\t\tbind:checked={requireCarTransport}\n\t\t\t\tdisabled={!allowRoutedTransfers}\n\t\t\t\tlabel={t.requireCarTransport}\n\t\t\t\tid=\"requireCarTransport\"\n\t\t\t\tonCheckedChange={(checked) => {\n\t\t\t\t\tif (checked && !useRoutedTransfers && allowRoutedTransfers) {\n\t\t\t\t\t\tuseRoutedTransfers = true;\n\t\t\t\t\t}\n\t\t\t\t\tsetModes('CAR')(checked);\n\t\t\t\t}}\n\t\t\t/>\n\n\t\t\t<ViaStopOptions bind:via bind:viaMinimumStay bind:viaLabels />\n\n\t\t\t<div\n\t\t\t\tclass=\"grid {maxTravelTime === undefined\n\t\t\t\t\t? 'grid-cols-2'\n\t\t\t\t\t: 'grid-cols-4'} items-center gap-2\"\n\t\t\t>\n\t\t\t\t<div class=\"text-sm\">\n\t\t\t\t\t{t.routingSegments.maxTransfers}\n\t\t\t\t</div>\n\t\t\t\t<NumberSelect bind:value={maxTransfers} possibleValues={possibleMaxTransfers} />\n\t\t\t\t{#if maxTravelTime !== undefined}\n\t\t\t\t\t<div class=\"text-sm\">\n\t\t\t\t\t\t{t.routingSegments.maxTravelTime}\n\t\t\t\t\t</div>\n\t\t\t\t\t<NumberSelect\n\t\t\t\t\t\tbind:value={maxTravelTime}\n\t\t\t\t\t\tpossibleValues={possibleMaxTravelTimes}\n\t\t\t\t\t\tlabelFormatter={formatDurationSec}\n\t\t\t\t\t/>\n\t\t\t\t{/if}\n\t\t\t</div>\n\n\t\t\t<!-- First mile -->\n\t\t\t<StreetModes\n\t\t\t\tlabel={t.routingSegments.firstMile}\n\t\t\t\tdisabled={!allowStreetRouting}\n\t\t\t\tbind:modes={preTransitModes}\n\t\t\t\tbind:maxTransitTime={maxPreTransitTime}\n\t\t\t\tpossibleModes={prePostDirectModes}\n\t\t\t\tpossibleMaxTransitTime={possiblePrePostDurations}\n\t\t\t\tbind:ignoreRentalReturnConstraints={ignorePreTransitRentalReturnConstraints}\n\t\t\t\tbind:providerGroups={preTransitProviderGroups}\n\t\t\t></StreetModes>\n\n\t\t\t<!-- Last mile -->\n\t\t\t<StreetModes\n\t\t\t\tlabel={t.routingSegments.lastMile}\n\t\t\t\tdisabled={!allowStreetRouting}\n\t\t\t\tbind:modes={postTransitModes}\n\t\t\t\tbind:maxTransitTime={maxPostTransitTime}\n\t\t\t\tpossibleModes={prePostDirectModes}\n\t\t\t\tpossibleMaxTransitTime={possiblePrePostDurations}\n\t\t\t\tbind:ignoreRentalReturnConstraints={ignorePostTransitRentalReturnConstraints}\n\t\t\t\tbind:providerGroups={postTransitProviderGroups}\n\t\t\t></StreetModes>\n\n\t\t\t<!-- Direct -->\n\t\t\t{#if directModes !== undefined && maxDirectTime !== undefined && ignoreDirectRentalReturnConstraints !== undefined}\n\t\t\t\t<StreetModes\n\t\t\t\t\tlabel={t.routingSegments.direct}\n\t\t\t\t\tdisabled={!allowStreetRouting}\n\t\t\t\t\tbind:modes={directModes}\n\t\t\t\t\tbind:maxTransitTime={maxDirectTime}\n\t\t\t\t\tpossibleModes={prePostDirectModes}\n\t\t\t\t\tpossibleMaxTransitTime={possibleDirectDurations}\n\t\t\t\t\tbind:ignoreRentalReturnConstraints={ignoreDirectRentalReturnConstraints}\n\t\t\t\t\tbind:providerGroups={directProviderGroups}\n\t\t\t\t></StreetModes>\n\t\t\t{/if}\n\t\t</div>\n\n\t\t<!-- Elevation Costs -->\n\t\t<div class=\"grid grid-cols-2 items-center\">\n\t\t\t<div class=\"text-sm\">\n\t\t\t\t{t.selectElevationCosts}\n\t\t\t</div>\n\t\t\t<Select.Root\n\t\t\t\tdisabled={!allowElevationCosts || !allowStreetRouting}\n\t\t\t\ttype=\"single\"\n\t\t\t\tbind:value={elevationCosts}\n\t\t\t>\n\t\t\t\t<Select.Trigger aria-label={t.selectElevationCosts}>\n\t\t\t\t\t{t.elevationCosts[elevationCosts]}\n\t\t\t\t</Select.Trigger>\n\t\t\t\t<Select.Content sideOffset={10}>\n\t\t\t\t\t{#each possibleElevationCosts as costs, i (i + costs.value)}\n\t\t\t\t\t\t<Select.Item value={costs.value} label={costs.label}>\n\t\t\t\t\t\t\t{costs.label}\n\t\t\t\t\t\t</Select.Item>\n\t\t\t\t\t{/each}\n\t\t\t\t</Select.Content>\n\t\t\t</Select.Root>\n\t\t</div>\n\t\t{#if additionalComponents}\n\t\t\t{@render additionalComponents()}\n\t\t{/if}\n\t</div>\n{/if}\n","<script lang=\"ts\">\n\timport { cn } from './utils';\n\n\tlet {\n\t\tvalue = $bindable(),\n\t\tclass: className\n\t}: {\n\t\tvalue: Date;\n\t\tclass?: string;\n\t} = $props();\n\n\tlet el: undefined | HTMLInputElement;\n\n\t$effect(() => {\n\t\tif (el !== undefined) {\n\t\t\tvalue.setSeconds(0, 0);\n\t\t\tconst dateTimeLocalValue = new Date(value.getTime() - value.getTimezoneOffset() * 60000)\n\t\t\t\t.toISOString()\n\t\t\t\t.slice(0, -1);\n\t\t\tel.value = dateTimeLocalValue;\n\t\t}\n\t});\n</script>\n\n<input\n\ttype=\"datetime-local\"\n\tclass={cn(\n\t\t'flex h-9 rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50',\n\t\tclassName\n\t)}\n\tbind:this={el}\n\tonchange={(e) => {\n\t\t// @ts-expect-error target exists, value exists\n\t\tconst dateTimeLocalValue = e.target!.value!;\n\t\tconst fakeUtcTime = new Date(`${dateTimeLocalValue}Z`);\n\t\tif (!isNaN(fakeUtcTime.getTime())) {\n\t\t\t/* eslint-disable-next-line svelte/prefer-svelte-reactivity */\n\t\t\tvalue = new Date(fakeUtcTime.getTime() + fakeUtcTime.getTimezoneOffset() * 60000);\n\t\t}\n\t}}\n/>\n","<script lang=\"ts\">\n\timport { t } from '$lib/i18n/translation';\n\timport { ArrowUpDown, LocateFixed } from '@lucide/svelte';\n\timport maplibregl from 'maplibre-gl';\n\timport * as RadioGroup from '$lib/components/ui/radio-group';\n\timport Button from '$lib/components/ui/button/button.svelte';\n\timport { Label } from '$lib/components/ui/label';\n\timport type {\n\t\tElevationCosts,\n\t\tMode,\n\t\tPedestrianProfile,\n\t\tServerConfig\n\t} from '@motis-project/motis-client';\n\timport AddressTypeahead from '$lib/AddressTypeahead.svelte';\n\timport AdvancedOptions from '$lib/AdvancedOptions.svelte';\n\timport DateInput from '$lib/DateInput.svelte';\n\timport { posToLocation, type Location } from '$lib/Location';\n\timport type { PrePostDirectMode } from '$lib/Modes';\n\n\tlet {\n\t\tgeocodingBiasPlace,\n\t\tserverConfig,\n\t\tfrom = $bindable(),\n\t\tto = $bindable(),\n\t\ttime = $bindable(),\n\t\tarriveBy = $bindable(),\n\t\tpedestrianProfile = $bindable(),\n\t\tuseRoutedTransfers = $bindable(),\n\t\tmaxTransfers = $bindable(),\n\t\trequireCarTransport = $bindable(),\n\t\trequireBikeTransport = $bindable(),\n\t\ttransitModes = $bindable(),\n\t\tpreTransitModes = $bindable(),\n\t\tpostTransitModes = $bindable(),\n\t\tdirectModes = $bindable(),\n\t\televationCosts = $bindable(),\n\t\tmaxPreTransitTime = $bindable(),\n\t\tmaxPostTransitTime = $bindable(),\n\t\tmaxDirectTime = $bindable(),\n\t\tignorePreTransitRentalReturnConstraints = $bindable(),\n\t\tignorePostTransitRentalReturnConstraints = $bindable(),\n\t\tignoreDirectRentalReturnConstraints = $bindable(),\n\t\tpreTransitProviderGroups = $bindable(),\n\t\tpostTransitProviderGroups = $bindable(),\n\t\tdirectProviderGroups = $bindable(),\n\t\tvia = $bindable(),\n\t\tviaMinimumStay = $bindable(),\n\t\tviaLabels = $bindable()\n\t}: {\n\t\tgeocodingBiasPlace?: maplibregl.LngLatLike;\n\t\tserverConfig: ServerConfig | undefined;\n\t\tfrom: Location;\n\t\tto: Location;\n\t\ttime: Date;\n\t\tarriveBy: boolean;\n\t\tpedestrianProfile: PedestrianProfile;\n\t\tuseRoutedTransfers: boolean;\n\t\tmaxTransfers: number;\n\t\trequireCarTransport: boolean;\n\t\trequireBikeTransport: boolean;\n\t\ttransitModes: Mode[];\n\t\tpreTransitModes: PrePostDirectMode[];\n\t\tpostTransitModes: PrePostDirectMode[];\n\t\tdirectModes: PrePostDirectMode[];\n\t\televationCosts: ElevationCosts;\n\t\tmaxPreTransitTime: number;\n\t\tmaxPostTransitTime: number;\n\t\tmaxDirectTime: number;\n\t\tignorePreTransitRentalReturnConstraints: boolean;\n\t\tignorePostTransitRentalReturnConstraints: boolean;\n\t\tignoreDirectRentalReturnConstraints: boolean;\n\t\tpreTransitProviderGroups: string[];\n\t\tpostTransitProviderGroups: string[];\n\t\tdirectProviderGroups: string[];\n\t\tvia: undefined | Location[];\n\t\tviaMinimumStay: undefined | number[];\n\t\tviaLabels: Record<string, string>;\n\t} = $props();\n\n\tlet fromItems = $state<Array<Location>>([]);\n\tlet toItems = $state<Array<Location>>([]);\n\n\tconst getLocation = () => {\n\t\tif (navigator && navigator.geolocation) {\n\t\t\tnavigator.geolocation.getCurrentPosition(applyPosition, (e) => console.log(e), {\n\t\t\t\tenableHighAccuracy: true\n\t\t\t});\n\t\t}\n\t};\n\n\tconst applyPosition = (position: { coords: { latitude: number; longitude: number } }) => {\n\t\tfrom = posToLocation({ lat: position.coords.latitude, lon: position.coords.longitude }, 0);\n\t};\n</script>\n\n<div id=\"searchmask-container\" class=\"flex flex-col space-y-4 p-4 relative\">\n\t<AddressTypeahead\n\t\tplace={geocodingBiasPlace}\n\t\tname=\"from\"\n\t\tplaceholder={t.from}\n\t\tbind:selected={from}\n\t\tbind:items={fromItems}\n\t\t{transitModes}\n\t/>\n\t<AddressTypeahead\n\t\tplace={geocodingBiasPlace}\n\t\tname=\"to\"\n\t\tplaceholder={t.to}\n\t\tbind:selected={to}\n\t\tbind:items={toItems}\n\t\t{transitModes}\n\t/>\n\t<Button\n\t\tvariant=\"ghost\"\n\t\tclass=\"absolute z-10 right-4 top-0\"\n\t\tsize=\"icon\"\n\t\tonclick={() => getLocation()}\n\t>\n\t\t<LocateFixed class=\"w-5 h-5\" />\n\t</Button>\n\t<Button\n\t\tclass=\"absolute z-10 right-14 top-6\"\n\t\tvariant=\"outline\"\n\t\tsize=\"icon\"\n\t\tonclick={() => {\n\t\t\tconst tmp = to;\n\t\t\tto = from;\n\t\t\tfrom = tmp;\n\n\t\t\tconst tmpItems = toItems;\n\t\t\ttoItems = fromItems;\n\t\t\tfromItems = tmpItems;\n\t\t}}\n\t>\n\t\t<ArrowUpDown class=\"w-5 h-5\" />\n\t</Button>\n\t<div class=\"flex flex-row gap-2 flex-wrap\">\n\t\t<DateInput bind:value={time} />\n\t\t<RadioGroup.Root\n\t\t\tclass=\"flex\"\n\t\t\tbind:value={() => (arriveBy ? 'arrival' : 'departure'), (v) => (arriveBy = v === 'arrival')}\n\t\t>\n\t\t\t<Label\n\t\t\t\tfor=\"departure\"\n\t\t\t\tclass=\"flex items-center rounded-md border-2 border-muted bg-popover p-1 px-2 hover:bg-accent hover:text-accent-foreground [&:has([data-state=checked])]:border-blue-600 hover:cursor-pointer\"\n\t\t\t>\n\t\t\t\t<RadioGroup.Item\n\t\t\t\t\tvalue=\"departure\"\n\t\t\t\t\tid=\"departure\"\n\t\t\t\t\tclass=\"sr-only\"\n\t\t\t\t\taria-label={t.departure}\n\t\t\t\t/>\n\t\t\t\t<span>{t.departure}</span>\n\t\t\t</Label>\n\t\t\t<Label\n\t\t\t\tfor=\"arrival\"\n\t\t\t\tclass=\"flex items-center rounded-md border-2 border-muted bg-popover p-1 px-2 hover:bg-accent hover:text-accent-foreground [&:has([data-state=checked])]:border-blue-600 hover:cursor-pointer\"\n\t\t\t>\n\t\t\t\t<RadioGroup.Item value=\"arrival\" id=\"arrival\" class=\"sr-only\" aria-label={t.arrival} />\n\t\t\t\t<span>{t.arrival}</span>\n\t\t\t</Label>\n\t\t</RadioGroup.Root>\n\t\t<AdvancedOptions\n\t\t\t{serverConfig}\n\t\t\tbind:useRoutedTransfers\n\t\t\tbind:wheelchair={\n\t\t\t\t() => pedestrianProfile === 'WHEELCHAIR',\n\t\t\t\t(v) => (pedestrianProfile = v ? 'WHEELCHAIR' : 'FOOT')\n\t\t\t}\n\t\t\tbind:requireCarTransport\n\t\t\tbind:maxTransfers\n\t\t\tmaxTravelTime={undefined}\n\t\t\tbind:requireBikeTransport\n\t\t\tbind:transitModes\n\t\t\tbind:preTransitModes\n\t\t\tbind:postTransitModes\n\t\t\tbind:directModes\n\t\t\tbind:maxPreTransitTime\n\t\t\tbind:maxPostTransitTime\n\t\t\tbind:maxDirectTime\n\t\t\tbind:elevationCosts\n\t\t\tbind:ignorePreTransitRentalReturnConstraints\n\t\t\tbind:ignorePostTransitRentalReturnConstraints\n\t\t\tbind:ignoreDirectRentalReturnConstraints\n\t\t\tbind:preTransitProviderGroups\n\t\t\tbind:postTransitProviderGroups\n\t\t\tbind:directProviderGroups\n\t\t\tbind:via\n\t\t\tbind:viaMinimumStay\n\t\t\tbind:viaLabels\n\t\t/>\n\t</div>\n</div>\n","import { page } from '$app/state';\nimport { replaceState } from '$app/navigation';\n\nexport const restoreScroll = (container: HTMLElement) => {\n\tconst saveScroll = () => {\n\t\tpage.state.scrollY = container.scrollTop;\n\t\treplaceState('', page.state);\n\t};\n\n\tconst handlePopState = (event: PopStateEvent) => {\n\t\trequestAnimationFrame(() => {\n\t\t\tcontainer.scrollTop = event.state?.['sveltekit:states']?.scrollY ?? 0;\n\t\t});\n\t};\n\n\tcontainer.addEventListener('scrollend', saveScroll);\n\twindow.addEventListener('popstate', handlePopState);\n\n\treturn () => {\n\t\tcontainer.removeEventListener('scrollend', saveScroll);\n\t\twindow.removeEventListener('popstate', handlePopState);\n\t};\n};\n\nexport const resetScroll = (container: HTMLElement) => {\n\tif (page.state.scrollY == undefined) {\n\t\tcontainer.scrollTop = 0;\n\t}\n};\n","<script lang=\"ts\">\n\timport type { WithElementRef } from \"bits-ui\";\n\timport type { HTMLAttributes } from \"svelte/elements\";\n\timport { cn } from \"$lib/utils.js\";\n\timport {onMount } from \"svelte\";\n\timport { restoreScroll} from \"$lib/map/handleScroll\";\n\timport { browser } from \"$app/environment\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\tchildren,\n\t\t...restProps\n\t}: WithElementRef<HTMLAttributes<HTMLDivElement>> = $props();\n\t\n\tonMount(\n\t\t() => {\n\t\t\tif (!(browser && window.innerWidth < 768) && ref!.classList.contains(\"scrollable\")) {\n\t\t\t\tconst cleanup = restoreScroll(ref!);\n\t\t\t\treturn cleanup;\n\t\t\t}\t\n\t\t}\n\t);\n\n</script>\n\n<div\n\tbind:this={ref}\n\tclass={cn(\"bg-card text-card-foreground rounded-xl border shadow max-w-full\", className)}\n\t{...restProps}\n>\n\t{@render children?.()}\n</div>\n","<script lang=\"ts\">\n\timport type { WithElementRef } from \"bits-ui\";\n\timport type { HTMLAttributes } from \"svelte/elements\";\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\tchildren,\n\t\t...restProps\n\t}: WithElementRef<HTMLAttributes<HTMLDivElement>> = $props();\n</script>\n\n<div bind:this={ref} class={cn(\"p-6\", className)} {...restProps}>\n\t{@render children?.()}\n</div>\n","<script lang=\"ts\">\n\timport { CircleAlert, CircleCheck, SearchX, ServerCrash } from '@lucide/svelte';\n\n\tlet {\n\t\tmessage,\n\t\tstatus\n\t}: {\n\t\tmessage: string;\n\t\tstatus: number | undefined;\n\t} = $props();\n\n\tconst getErrorType = (status: number) => {\n\t\tswitch (status) {\n\t\t\tcase 200:\n\t\t\t\treturn 'OK';\n\t\t\tcase 400:\n\t\t\t\treturn 'Bad Request';\n\t\t\tcase 404:\n\t\t\t\treturn 'Not Found';\n\t\t\tcase 500:\n\t\t\t\treturn 'Internal Server Error';\n\t\t\tcase 422:\n\t\t\t\treturn 'Unprocessable Entity';\n\t\t\tdefault:\n\t\t\t\treturn 'Unknown';\n\t\t}\n\t};\n\n\tconst getErrorIcon = (status: number) => {\n\t\tswitch (status) {\n\t\t\tcase 200:\n\t\t\t\treturn CircleCheck;\n\t\t\tcase 400:\n\t\t\t\treturn CircleAlert;\n\t\t\tcase 404:\n\t\t\t\treturn SearchX;\n\t\t\tcase 422:\n\t\t\tcase 500:\n\t\t\t\treturn ServerCrash;\n\t\t\tdefault:\n\t\t\t\treturn SearchX;\n\t\t}\n\t};\n\tlet Icon = $state(getErrorIcon(status ?? 404));\n</script>\n\n<div\n\tclass=\"p-4 my-4 mx-auto min-w-96 max-w-fit flex flex-col items-center gap-5 rounded-lg border border-destructive/20\"\n>\n\t<div class=\"flex items-center gap-4 mx-auto\">\n\t\t<Icon class=\"h-7 w-7 text-destructive\" />\n\t\t<h2 class=\"text-xl font-semibold text-destructive\">\n\t\t\t{status}\n\t\t\t{getErrorType(status ?? 404)}\n\t\t</h2>\n\t</div>\n\t<p class=\"text-lg text-muted-foreground max-w-[40ch] break-words\">\n\t\t{message}\n\t</p>\n</div>\n","import { language } from './i18n/translation';\n\nexport const formatTime = (d: Date, timeZone: string | undefined): string => {\n\treturn d.toLocaleTimeString(language, {\n\t\thour: 'numeric',\n\t\tminute: 'numeric',\n\t\ttimeZone,\n\t\thour12: false\n\t});\n};\n\nexport const formatDate = (d: Date, timeZone: string | undefined): string => {\n\treturn d.toLocaleDateString(language, {\n\t\tday: 'numeric',\n\t\tmonth: 'numeric',\n\t\tyear: 'numeric',\n\t\ttimeZone\n\t});\n};\n\nexport const formatDateTime = (d: Date, timeZone: string | undefined): string => {\n\treturn d.toLocaleDateString(language, {\n\t\tday: 'numeric',\n\t\tmonth: 'numeric',\n\t\tyear: 'numeric',\n\t\thour: 'numeric',\n\t\tminute: 'numeric',\n\t\ttimeZone\n\t});\n};\n\nexport const getTz = (d: Date, timeZone: string | undefined): string | undefined => {\n\tconst timeZoneOffset = new Intl.DateTimeFormat(language, {\n\t\ttimeZone,\n\t\ttimeZoneName: 'shortOffset'\n\t})\n\t\t.formatToParts(d)\n\t\t.find((part) => part.type === 'timeZoneName')!.value;\n\tconst isSameAsBrowserTimezone =\n\t\tnew Intl.DateTimeFormat(language, { timeZoneName: 'shortOffset' })\n\t\t\t.formatToParts(d)\n\t\t\t.find((part) => part.type === 'timeZoneName')!.value == timeZoneOffset;\n\treturn isSameAsBrowserTimezone ? undefined : timeZoneOffset;\n};\n","<script lang=\"ts\">\n\timport { language } from '$lib/i18n/translation';\n\timport { formatTime } from './toDateTime';\n\timport { cn } from './utils';\n\n\tlet {\n\t\tclass: className,\n\t\ttimestamp,\n\t\tscheduledTimestamp,\n\t\tisRealtime,\n\t\tvariant,\n\t\tqueriedTime,\n\t\ttimeZone,\n\t\tarriveBy\n\t}: {\n\t\tclass?: string;\n\t\ttimestamp: string;\n\t\tscheduledTimestamp: string;\n\t\tisRealtime: boolean;\n\t\tvariant: 'schedule' | 'realtime' | 'realtime-show-always';\n\t\tqueriedTime?: string | undefined;\n\t\ttimeZone: string | undefined;\n\t\tarriveBy?: boolean | undefined;\n\t} = $props();\n\n\tconst t = $derived(new Date(timestamp));\n\tconst scheduled = $derived(new Date(scheduledTimestamp));\n\tconst delayMinutes = $derived((t.getTime() - scheduled.getTime()) / 60000);\n\tconst highDelay = $derived(isRealtime && delayMinutes > 3);\n\tconst lowDelay = $derived(isRealtime && delayMinutes <= 3);\n\tconst early = $derived(isRealtime && delayMinutes <= -1);\n\tconst notOnTime = $derived(arriveBy ? highDelay : highDelay || early);\n\tconst roughlyOnTime = $derived(arriveBy ? lowDelay : lowDelay && !early);\n\tconst isValidDate = $derived(scheduled instanceof Date && !isNaN(scheduled.getTime()));\n\n\tconst timeZoneOffset = $derived(\n\t\tisValidDate\n\t\t\t? new Intl.DateTimeFormat(language, { timeZone, timeZoneName: 'shortOffset' })\n\t\t\t\t\t.formatToParts(scheduled)\n\t\t\t\t\t.find((part) => part.type === 'timeZoneName')!.value\n\t\t\t: undefined\n\t);\n\tconst isSameAsBrowserTimezone = $derived(() => {\n\t\tif (!isValidDate) return false;\n\t\treturn (\n\t\t\tnew Intl.DateTimeFormat(language, { timeZoneName: 'shortOffset' })\n\t\t\t\t.formatToParts(scheduled)\n\t\t\t\t.find((part) => part.type === 'timeZoneName')!.value == timeZoneOffset\n\t\t);\n\t});\n\n\tfunction weekday(time: Date) {\n\t\tif (variant === 'realtime') {\n\t\t\treturn '';\n\t\t}\n\t\tif (queriedTime === undefined) {\n\t\t\treturn time.toLocaleDateString(language, { timeZone });\n\t\t}\n\t\tconst base = new Date(queriedTime);\n\t\treturn base.toLocaleDateString() === time.toLocaleDateString()\n\t\t\t? ''\n\t\t\t: `(${time.toLocaleString(language, { weekday: 'short', timeZone })})`;\n\t}\n</script>\n\n<div class={cn('text-nowrap flex flex-col', className)} title={timeZoneOffset}>\n\t{#if variant == 'schedule'}\n\t\t<div>\n\t\t\t{formatTime(scheduled, timeZone)}\n\t\t\t{weekday(scheduled)}\n\t\t</div>\n\t\t<div class=\"text-xs font-normal\">{isSameAsBrowserTimezone() ? '' : timeZoneOffset}</div>\n\t{:else if variant === 'realtime-show-always' || (variant === 'realtime' && isRealtime)}\n\t\t<span class:text-destructive={notOnTime} class:text-green-600={roughlyOnTime}>\n\t\t\t{formatTime(t, timeZone)}\n\t\t\t{weekday(t)}\n\t\t</span>\n\t\t{#if variant === 'realtime-show-always' && !isSameAsBrowserTimezone()}\n\t\t\t<div class=\"text-xs font-normal\">\n\t\t\t\t{isSameAsBrowserTimezone() ? '' : timeZoneOffset}\n\t\t\t</div>\n\t\t{/if}\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\timport { Button, type ButtonProps } from '$lib/components/ui/button';\n\timport { formatDurationSec } from '$lib/formatDuration';\n\timport { getModeStyle, routeColor } from './modeStyle';\n\timport type { Itinerary } from '@motis-project/motis-client';\n\n\tconst {\n\t\td,\n\t\t...restProps\n\t}: {\n\t\td: Itinerary;\n\t} & ButtonProps = $props();\n\n\tconst modeStyles = [\n\t\t...new Map(d.legs.map((l) => [JSON.stringify(getModeStyle(l)), getModeStyle(l)])).values()\n\t];\n\n\tconst leg = d.legs.find((leg) => leg.mode !== 'WALK') ?? d.legs[0]!;\n</script>\n\n<Button variant=\"child\" {...restProps}>\n\t<div\n\t\tclass=\"flex items-center py-1 px-2 rounded-lg font-bold text-sm h-8 text-nowrap\"\n\t\tstyle={routeColor(leg)}\n\t>\n\t\t{#each modeStyles as [icon, _color, _textColor], i (i)}\n\t\t\t<svg class=\"relative mr-1 w-4 h-4 rounded-full\">\n\t\t\t\t<use xlink:href={`#${icon}`}></use>\n\t\t\t</svg>\n\t\t{/each}\n\t\t{formatDurationSec(d.duration)}\n\t</div>\n</Button>\n","<script lang=\"ts\">\n\timport { Card } from '$lib/components/ui/card';\n\timport ErrorMessage from '$lib/ErrorMessage.svelte';\n\timport { Separator } from '$lib/components/ui/separator';\n\timport { formatDurationSec } from '$lib/formatDuration';\n\timport { getModeStyle, routeColor } from '$lib/modeStyle';\n\timport {\n\t\tplan,\n\t\ttype Itinerary,\n\t\ttype Leg,\n\t\ttype PlanData,\n\t\ttype PlanError,\n\t\ttype PlanResponse,\n\t\ttype Error as ApiError\n\t} from '@motis-project/motis-client';\n\timport Time from '$lib/Time.svelte';\n\timport { LoaderCircle } from '@lucide/svelte';\n\timport { t } from '$lib/i18n/translation';\n\timport DirectConnection from '$lib/DirectConnection.svelte';\n\timport type { RequestResult } from '@hey-api/client-fetch';\n\n\tlet {\n\t\troutingResponses,\n\t\tbaseResponse,\n\t\tbaseQuery,\n\t\tselectItinerary,\n\t\tupdateStartDest\n\t}: {\n\t\troutingResponses: Array<Promise<PlanResponse>>;\n\t\tbaseResponse: Promise<PlanResponse> | undefined;\n\t\tbaseQuery: PlanData | undefined;\n\t\tselectItinerary: (it: Itinerary) => void;\n\t\tupdateStartDest: (r: Awaited<RequestResult<PlanResponse, ApiError, false>>) => PlanResponse;\n\t} = $props();\n\n\tconst throwOnError = (promise: RequestResult<PlanResponse, PlanError, false>) =>\n\t\tpromise.then((res) => {\n\t\t\tif (res.error) {\n\t\t\t\tthrow { error: res.error.error, status: res.response.status };\n\t\t\t}\n\t\t\treturn res;\n\t\t});\n</script>\n\n{#snippet legSummary(l: Leg)}\n\t<div\n\t\tclass=\"flex items-center py-1 px-2 rounded-lg font-bold text-sm h-8 text-nowrap\"\n\t\tstyle={routeColor(l)}\n\t>\n\t\t<svg class=\"relative mr-1 w-4 h-4 rounded-full\">\n\t\t\t<use xlink:href={`#${getModeStyle(l)[0]}`}></use>\n\t\t</svg>\n\t\t{#if l.displayName}\n\t\t\t{l.displayName}\n\t\t{:else}\n\t\t\t{formatDurationSec(l.duration)}\n\t\t{/if}\n\t</div>\n{/snippet}\n\n{#if baseResponse}\n\t{#await baseResponse}\n\t\t<div class=\"flex items-center justify-center w-full\">\n\t\t\t<LoaderCircle class=\"animate-spin w-12 h-12 m-20\" />\n\t\t</div>\n\t{:then r}\n\t\t{#if r.direct.length !== 0}\n\t\t\t<div class=\"my-4 flex flex-wrap gap-x-3 gap-y-3\">\n\t\t\t\t{#each r.direct as d, i (i)}\n\t\t\t\t\t<DirectConnection\n\t\t\t\t\t\t{d}\n\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\tselectItinerary(d);\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{/each}\n\t\t\t</div>\n\t\t{/if}\n\n\t\t{#if r.itineraries.length !== 0}\n\t\t\t<div class=\"flex flex-col space-y-6 px-4 py-8\">\n\t\t\t\t{#each routingResponses as r, rI (rI)}\n\t\t\t\t\t{#await r}\n\t\t\t\t\t\t<div class=\"flex items-center justify-center w-full\">\n\t\t\t\t\t\t\t<LoaderCircle class=\"animate-spin w-12 h-12 m-20\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{:then r}\n\t\t\t\t\t\t{#if rI === 0 && baseQuery}\n\t\t\t\t\t\t\t<div class=\"w-full flex justify-between items-center space-x-4\">\n\t\t\t\t\t\t\t\t<div class=\"border-t w-full h-0\"></div>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\t\t\t\troutingResponses.splice(\n\t\t\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t\t\t\tthrowOnError(\n\t\t\t\t\t\t\t\t\t\t\t\tplan({\n\t\t\t\t\t\t\t\t\t\t\t\t\tquery: { ...baseQuery.query, pageCursor: r.previousPageCursor }\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t).then(updateStartDest)\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tclass=\"px-2 py-1 bg-blue-600 hover:!bg-blue-700 text-white font-bold text-sm border rounded-lg text-nowrap\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{t.earlier}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<div class=\"border-t w-full h-0\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t{#each r.itineraries as it, i (i)}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\t\t\tselectItinerary(it);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Card class=\"p-4\">\n\t\t\t\t\t\t\t\t\t<div class=\"text-base flex justify-around items-start space-x-1 w-full\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"overflow-hidden basis-1/4 h-full flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"text-xs font-bold uppercase text-slate-400\">{t.departure}</div>\n\t\t\t\t\t\t\t\t\t\t\t<Time\n\t\t\t\t\t\t\t\t\t\t\t\tisRealtime={it.legs[0].realTime}\n\t\t\t\t\t\t\t\t\t\t\t\ttimestamp={it.startTime}\n\t\t\t\t\t\t\t\t\t\t\t\tscheduledTimestamp={it.legs[0].scheduledStartTime}\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"realtime-show-always\"\n\t\t\t\t\t\t\t\t\t\t\t\tqueriedTime={baseQuery?.query.time}\n\t\t\t\t\t\t\t\t\t\t\t\ttimeZone={it.legs[0].from.tz}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<Separator orientation=\"vertical\" />\n\t\t\t\t\t\t\t\t\t\t<div class=\"overflow-hidden basis-1/4 h-full flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"text-xs font-bold uppercase text-slate-400\">{t.arrival}</div>\n\t\t\t\t\t\t\t\t\t\t\t<Time\n\t\t\t\t\t\t\t\t\t\t\t\tisRealtime={it.legs[it.legs.length - 1].realTime}\n\t\t\t\t\t\t\t\t\t\t\t\ttimestamp={it.endTime}\n\t\t\t\t\t\t\t\t\t\t\t\tscheduledTimestamp={it.legs[it.legs.length - 1].scheduledEndTime}\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"realtime-show-always\"\n\t\t\t\t\t\t\t\t\t\t\t\tqueriedTime={it.startTime}\n\t\t\t\t\t\t\t\t\t\t\t\ttimeZone={it.legs[it.legs.length - 1].to.tz}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<Separator orientation=\"vertical\" />\n\t\t\t\t\t\t\t\t\t\t<div class=\"overflow-hidden basis-1/4 h-full flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"text-xs font-bold uppercase text-slate-400\">\n\t\t\t\t\t\t\t\t\t\t\t\t{t.transfers}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"text-center text-nowrap\">\n\t\t\t\t\t\t\t\t\t\t\t\t{it.transfers}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<Separator orientation=\"vertical\" />\n\t\t\t\t\t\t\t\t\t\t<div class=\"overflow-hidden basis-1/4 h-full flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"text-xs font-bold uppercase text-slate-400\">\n\t\t\t\t\t\t\t\t\t\t\t\t{t.duration}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"text-center text-nowrap\">\n\t\t\t\t\t\t\t\t\t\t\t\t{formatDurationSec(it.duration)}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<Separator class=\"my-2\" />\n\t\t\t\t\t\t\t\t\t<div class=\"mt-4 flex flex-wrap gap-x-3 gap-y-3\">\n\t\t\t\t\t\t\t\t\t\t{#each it.legs.filter((l, i) => (i == 0 && l.duration > 1) || (i == it.legs.length - 1 && l.duration > 1) || l.displayName || l.mode != 'WALK') as l, i (i)}\n\t\t\t\t\t\t\t\t\t\t\t{@render legSummary(l)}\n\t\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t{#if rI === routingResponses.length - 1 && baseQuery}\n\t\t\t\t\t\t\t<div class=\"w-full flex justify-between items-center space-x-4\">\n\t\t\t\t\t\t\t\t<div class=\"border-t w-full h-0\"></div>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\t\t\t\troutingResponses.push(\n\t\t\t\t\t\t\t\t\t\t\tthrowOnError(\n\t\t\t\t\t\t\t\t\t\t\t\tplan({\n\t\t\t\t\t\t\t\t\t\t\t\t\tquery: { ...baseQuery.query, pageCursor: r.nextPageCursor }\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t).then(updateStartDest)\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tclass=\"px-2 py-1 bg-blue-600 hover:!bg-blue-700 text-white text-sm font-bold border rounded-lg text-nowrap\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{t.later}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<div class=\"border-t w-full h-0\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t{:catch e}\n\t\t\t\t\t\t<ErrorMessage message={e.error ?? e} status={e.status ?? 404} />\n\t\t\t\t\t{/await}\n\t\t\t\t{/each}\n\t\t\t</div>\n\t\t{:else if r.direct.length === 0}\n\t\t\t<ErrorMessage message={t.noItinerariesFound} status={200} />\n\t\t{/if}\n\t{:catch e}\n\t\t<ErrorMessage message={e.error ?? e} status={e.status ?? 404} />\n\t{/await}\n{/if}\n","<script lang=\"ts\">\n\timport { getModeStyle, routeColor, type LegLike } from './modeStyle';\n\timport { cn } from './utils';\n\n\tconst {\n\t\tl,\n\t\tclass: className,\n\t\tonClickTrip\n\t}: {\n\t\tl: LegLike;\n\t\tclass?: string;\n\t\tonClickTrip: (tripId: string) => void;\n\t} = $props();\n\n\tconst modeIcon = $derived(getModeStyle(l)[0]);\n</script>\n\n<button\n\tclass={cn(\n\t\t'flex items-center text-nowrap rounded-full pl-2 pr-1 h-8 font-bold',\n\t\tclassName,\n\t\tl.displayName ? 'pr-3' : undefined\n\t)}\n\tstyle={routeColor(l)}\n\tonclick={() => {\n\t\tif (l.tripId) {\n\t\t\tonClickTrip(l.tripId);\n\t\t} else {\n\t\t\tconsole.log('tripId missing', l);\n\t\t}\n\t}}\n>\n\t<svg class=\"relative mr-2 min-w-6 min-h-6 max-w-6 max-h-6 rounded-full\">\n\t\t<use xlink:href={`#${modeIcon}`}></use>\n\t</svg>\n\t<div class=\"text-center\">\n\t\t{l.displayName}\n\t</div>\n</button>\n","<script lang=\"ts\">\n\timport type { HTMLAttributes } from \"svelte/elements\";\n\timport type { WithElementRef } from \"bits-ui\";\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\tchildren,\n\t\t...restProps\n\t}: WithElementRef<HTMLAttributes<HTMLDivElement>> = $props();\n</script>\n\n<div\n\tbind:this={ref}\n\tclass={cn(\"flex flex-col space-y-1.5 text-center sm:text-left\", className)}\n\t{...restProps}\n>\n\t{@render children?.()}\n</div>\n","<script lang=\"ts\">\n\timport { Dialog as DialogPrimitive } from \"bits-ui\";\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\t...restProps\n\t}: DialogPrimitive.OverlayProps = $props();\n</script>\n\n<DialogPrimitive.Overlay\n\tbind:ref\n\tclass={cn(\n\t\t\"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0  fixed inset-0 z-50 bg-black/80\",\n\t\tclassName\n\t)}\n\t{...restProps}\n/>\n","<script lang=\"ts\">\n\timport { Dialog as DialogPrimitive, type WithoutChildrenOrChild } from \"bits-ui\";\n\timport X from \"@lucide/svelte/icons/x\";\n\timport type { Snippet } from \"svelte\";\n\timport * as Dialog from \"./index.js\";\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\tportalProps,\n\t\tchildren,\n\t\t...restProps\n\t}: WithoutChildrenOrChild<DialogPrimitive.ContentProps> & {\n\t\tportalProps?: DialogPrimitive.PortalProps;\n\t\tchildren: Snippet;\n\t} = $props();\n</script>\n\n<Dialog.Portal {...portalProps}>\n\t<Dialog.Overlay />\n\t<DialogPrimitive.Content\n\t\tbind:ref\n\t\tclass={cn(\n\t\t\t\"bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border p-6 shadow-lg duration-200 sm:rounded-lg\",\n\t\t\tclassName\n\t\t)}\n\t\t{...restProps}\n\t>\n\t\t{@render children?.()}\n\t\t<DialogPrimitive.Close\n\t\t\tclass=\"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:pointer-events-none\"\n\t\t>\n\t\t\t<X class=\"size-4\" />\n\t\t\t<span class=\"sr-only\">Close</span>\n\t\t</DialogPrimitive.Close>\n\t</DialogPrimitive.Content>\n</Dialog.Portal>\n","<script lang=\"ts\">\n\timport { Dialog as DialogPrimitive } from \"bits-ui\";\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\t...restProps\n\t}: DialogPrimitive.DescriptionProps = $props();\n</script>\n\n<DialogPrimitive.Description\n\tbind:ref\n\tclass={cn(\"text-muted-foreground text-sm\", className)}\n\t{...restProps}\n/>\n","import { Dialog as DialogPrimitive } from \"bits-ui\";\n\nimport Title from \"./dialog-title.svelte\";\nimport Footer from \"./dialog-footer.svelte\";\nimport Header from \"./dialog-header.svelte\";\nimport Overlay from \"./dialog-overlay.svelte\";\nimport Content from \"./dialog-content.svelte\";\nimport Description from \"./dialog-description.svelte\";\n\nconst Root: typeof DialogPrimitive.Root = DialogPrimitive.Root;\nconst Trigger: typeof DialogPrimitive.Trigger = DialogPrimitive.Trigger;\nconst Close: typeof DialogPrimitive.Close = DialogPrimitive.Close;\nconst Portal: typeof DialogPrimitive.Portal = DialogPrimitive.Portal;\n\nexport {\n\tRoot,\n\tTitle,\n\tPortal,\n\tFooter,\n\tHeader,\n\tTrigger,\n\tOverlay,\n\tContent,\n\tDescription,\n\tClose,\n\t//\n\tRoot as Dialog,\n\tTitle as DialogTitle,\n\tPortal as DialogPortal,\n\tFooter as DialogFooter,\n\tHeader as DialogHeader,\n\tTrigger as DialogTrigger,\n\tOverlay as DialogOverlay,\n\tContent as DialogContent,\n\tDescription as DialogDescription,\n\tClose as DialogClose,\n};\n","<script lang=\"ts\">\n\timport { Info, ChevronRight } from '@lucide/svelte';\n\timport * as Dialog from '$lib/components/ui/dialog';\n\timport { buttonVariants } from './components/ui/button';\n\timport type { Alert } from '@motis-project/motis-client';\n\timport { formatDateTime, getTz } from './toDateTime';\n\timport { cn } from './utils';\n\timport { t } from './i18n/translation';\n\n\tconst {\n\t\talerts = [],\n\t\tvariant = 'icon',\n\t\ttz\n\t}: {\n\t\talerts?: Alert[];\n\t\tvariant?: 'icon' | 'full';\n\t\ttz: string | undefined;\n\t} = $props();\n</script>\n\n{#if alerts.length > 0}\n\t<Dialog.Root>\n\t\t<Dialog.Trigger class=\"max-w-full pr-4  {variant == 'full' ? 'pt-2' : 'ml-2'}\">\n\t\t\t{#if variant === 'full'}\n\t\t\t\t<div\n\t\t\t\t\tclass={cn(\n\t\t\t\t\t\tbuttonVariants({ variant: 'outline' }),\n\t\t\t\t\t\t'max-w-full flex items-center bg-blue-50 dark:bg-blue-950 shadow-none'\n\t\t\t\t\t)}\n\t\t\t\t>\n\t\t\t\t\t<div class=\"flex flex-col gap-1 overflow-hidden\">\n\t\t\t\t\t\t<div class=\"font-bold flex gap-2 items-center text-blue-700 dark:text-blue-500\">\n\t\t\t\t\t\t\t<Info />\n\t\t\t\t\t\t\t{t.alerts.information}\n\t\t\t\t\t\t\t{#if alerts.length > 1}\n\t\t\t\t\t\t\t\t<span class=\"text-muted-foreground font-normal\">\n\t\t\t\t\t\t\t\t\t+{alerts.length - 1}\n\t\t\t\t\t\t\t\t\t{t.alerts.more}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class=\"font-normal text-muted-foreground overflow-hidden text-ellipsis w-full\">\n\t\t\t\t\t\t\t{alerts[0].descriptionText || alerts[0].headerText}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<ChevronRight class=\"size-4\" />\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<Info />\n\t\t\t{/if}\n\t\t</Dialog.Trigger>\n\t\t<Dialog.Content>\n\t\t\t<Dialog.Header>\n\t\t\t\t<Dialog.Description class=\"space-y-4\">\n\t\t\t\t\t{#each alerts as alert, i (i)}\n\t\t\t\t\t\t<div class=\"last:mb-0 text-justify\">\n\t\t\t\t\t\t\t<h3 class=\"font-bold text-blue-700 dark:text-blue-500 mb-1 flex items-center gap-2\">\n\t\t\t\t\t\t\t\t<Info class=\"size-5\" />{alert.headerText}\n\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t{#if alert.impactPeriod}\n\t\t\t\t\t\t\t\t{#each alert.impactPeriod as impactPeriod, j (j)}\n\t\t\t\t\t\t\t\t\t{@const start = new Date(impactPeriod.start ?? 0)}\n\t\t\t\t\t\t\t\t\t{@const end = new Date(impactPeriod.end ?? 0)}\n\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t<strong>{t.alerts.validFrom}:</strong>\n\t\t\t\t\t\t\t\t\t\t{formatDateTime(start, tz)}\n\t\t\t\t\t\t\t\t\t\t<strong>{t.alerts.until}</strong>\n\t\t\t\t\t\t\t\t\t\t{formatDateTime(end, tz)}\n\t\t\t\t\t\t\t\t\t\t<span class=\"text-xs font-normal\">{getTz(start, tz)}</span>\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t{#if alert.causeDetail}\n\t\t\t\t\t\t\t\t<p>{alert.causeDetail}</p>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t{#if alert.descriptionText}\n\t\t\t\t\t\t\t\t<p>{alert.descriptionText}</p>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/each}\n\t\t\t\t</Dialog.Description>\n\t\t\t</Dialog.Header>\n\t\t</Dialog.Content>\n\t</Dialog.Root>\n{/if}\n","import type { Leg } from '@motis-project/motis-client';\n\nimport { t } from './i18n/translation';\n\nexport const getModeName = (l: Leg) => {\n\tswitch (l.mode) {\n\t\tcase 'WALK':\n\t\t\treturn t.walk;\n\t\tcase 'BIKE':\n\t\t\treturn t.bike;\n\t\tcase 'RENTAL':\n\t\t\tswitch (l.rental?.formFactor) {\n\t\t\t\tcase 'BICYCLE':\n\t\t\t\t\treturn t.bike;\n\t\t\t\tcase 'CARGO_BICYCLE':\n\t\t\t\t\treturn t.cargoBike;\n\t\t\t\tcase 'CAR':\n\t\t\t\t\treturn t.car;\n\t\t\t\tcase 'MOPED':\n\t\t\t\t\treturn t.moped;\n\t\t\t\tcase 'SCOOTER_SEATED':\n\t\t\t\t\treturn t.scooterSeated;\n\t\t\t\tcase 'SCOOTER_STANDING':\n\t\t\t\t\treturn t.scooterStanding;\n\t\t\t\tcase 'OTHER':\n\t\t\t\tdefault:\n\t\t\t\t\treturn t.unknownVehicleType;\n\t\t\t}\n\t\tcase 'CAR':\n\t\tcase 'CAR_PARKING':\n\t\t\treturn t.car;\n\t\tcase 'ODM':\n\t\t\treturn t.taxi;\n\t\tcase 'FLEX':\n\t\t\treturn 'Flex';\n\t\tdefault:\n\t\t\treturn `${l.mode}`;\n\t}\n};\n","import type { Mode } from '@motis-project/motis-client';\n\nexport const getModeLabel = (mode: Mode): string => {\n\tswitch (mode) {\n\t\tcase 'BUS':\n\t\tcase 'FERRY':\n\t\tcase 'TRAM':\n\t\tcase 'COACH':\n\t\tcase 'AIRPLANE':\n\t\tcase 'AERIAL_LIFT':\n\t\t\treturn 'Platform';\n\t\tdefault:\n\t\t\treturn 'Track';\n\t}\n};\n","<script lang=\"ts\">\n\timport { ArrowRight, ArrowUp, ArrowDown, DollarSign, CircleX } from '@lucide/svelte';\n\timport type {\n\t\tFareProduct,\n\t\tItinerary,\n\t\tLeg,\n\t\tMode,\n\t\tPlace,\n\t\tStepInstruction\n\t} from '@motis-project/motis-client';\n\timport Time from '$lib/Time.svelte';\n\timport { routeBorderColor, routeColor } from '$lib/modeStyle';\n\timport { formatDurationSec, formatDistanceMeters } from '$lib/formatDuration';\n\timport { Button } from '$lib/components/ui/button';\n\timport Route from '$lib/Route.svelte';\n\timport Alerts from '$lib/Alerts.svelte';\n\timport { getModeName } from '$lib/getModeName';\n\timport { language, t } from '$lib/i18n/translation';\n\timport { onClickStop, onClickTrip } from '$lib/utils';\n\timport { formatDate, formatTime } from './toDateTime';\n\timport { getModeLabel } from './map/getModeLabel';\n\tconst {\n\t\titinerary\n\t}: {\n\t\titinerary: Itinerary;\n\t} = $props();\n\n\tconst isRelevantLeg = (l: Leg) => l.duration !== 0 || l.displayName;\n\tconst lastLeg = $derived(itinerary.legs.findLast(isRelevantLeg));\n</script>\n\n{#snippet stopTimes(\n\ttimestamp: string,\n\tscheduledTimestamp: string,\n\tisRealtime: boolean,\n\tp: Place,\n\tmode: Mode,\n\tisStartOrEnd: number,\n\thidePlatform?: boolean\n)}\n\t{@const arriveBy = isStartOrEnd == 0 || isStartOrEnd == 1}\n\t{@const textColor = isStartOrEnd == 0 ? '' : 'font-semibold'}\n\t<div class=\"flex items-baseline justify-between w-full {textColor}\">\n\t\t<div class=\"flex justify-between\">\n\t\t\t<Time\n\t\t\t\tvariant=\"schedule\"\n\t\t\t\tclass=\"w-14 md:w-16\"\n\t\t\t\tqueriedTime={timestamp}\n\t\t\t\ttimeZone={p.tz}\n\t\t\t\t{isRealtime}\n\t\t\t\t{timestamp}\n\t\t\t\t{scheduledTimestamp}\n\t\t\t\t{arriveBy}\n\t\t\t/>\n\t\t\t<Time\n\t\t\t\tvariant=\"realtime\"\n\t\t\t\tclass=\"w-14 md:w-16\"\n\t\t\t\ttimeZone={p.tz}\n\t\t\t\t{isRealtime}\n\t\t\t\t{timestamp}\n\t\t\t\t{scheduledTimestamp}\n\t\t\t\t{arriveBy}\n\t\t\t/>\n\t\t</div>\n\t\t<div class=\"w-full\">\n\t\t\t{#if p.stopId}\n\t\t\t\t{@const pickupNotAllowedOrEnd = p.pickupType == 'NOT_ALLOWED' && isStartOrEnd != 1}\n\t\t\t\t{@const dropoffNotAllowedOrStart = p.dropoffType == 'NOT_ALLOWED' && isStartOrEnd != -1}\n\t\t\t\t<div class=\"flex items-center justify-between\">\n\t\t\t\t\t<div class=\"flex flex-row items-center justify-center\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclass=\"text-[length:inherit] leading-none justify-normal text-wrap p-0 text-left {textColor}\"\n\t\t\t\t\t\t\tvariant=\"link\"\n\t\t\t\t\t\t\tonclick={() => onClickStop(p.name, p.stopId!, new Date(timestamp))}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{p.name}\n\t\t\t\t\t\t</Button>\n\n\t\t\t\t\t\t{#if isStartOrEnd != 0}\n\t\t\t\t\t\t\t<Alerts alerts={p.alerts} tz={p.tz} variant=\"icon\" />\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t\t{#if p.track && !hidePlatform}\n\t\t\t\t\t\t<span class=\"text-nowrap px-2 border rounded-xl ml-1 mr-4\">\n\t\t\t\t\t\t\t{getModeLabel(mode) == 'Track' ? t.trackAbr : t.platformAbr}\n\t\t\t\t\t\t\t{p.track}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t{#if (p as Place & { switchTo?: Leg }).switchTo}\n\t\t\t\t\t\t{@const switchTo = (p as Place & { switchTo: Leg }).switchTo}\n\t\t\t\t\t\t<div class=\"flex items-center text-sm mt-1\">\n\t\t\t\t\t\t\t{t.continuesAs}\n\t\t\t\t\t\t\t{switchTo.displayName!}\n\t\t\t\t\t\t\t<ArrowRight class=\"mx-1 size-4\" />\n\t\t\t\t\t\t\t{switchTo.headsign}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t\t{#if pickupNotAllowedOrEnd || dropoffNotAllowedOrStart}\n\t\t\t\t\t\t<div class=\"flex items-center text-destructive text-sm mt-1\">\n\t\t\t\t\t\t\t<CircleX class=\"stroke-destructive size-4\" />\n\t\t\t\t\t\t\t<span class=\"ml-1 leading-none\">\n\t\t\t\t\t\t\t\t{pickupNotAllowedOrEnd && dropoffNotAllowedOrStart\n\t\t\t\t\t\t\t\t\t? t.inOutDisallowed\n\t\t\t\t\t\t\t\t\t: pickupNotAllowedOrEnd\n\t\t\t\t\t\t\t\t\t\t? t.inDisallowed\n\t\t\t\t\t\t\t\t\t\t: t.outDisallowed}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<span>{p.name || p.flex}</span>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n{/snippet}\n\n{#snippet streetLeg(l: Leg)}\n\t{@const stepsWithElevation = l.steps?.filter(\n\t\t(s: StepInstruction) => s.elevationUp || s.elevationDown\n\t)}\n\t{@const stepsWithToll = l.steps?.filter((s: StepInstruction) => s.toll)}\n\t{@const stepsWithAccessRestriction = l.steps?.filter((s: StepInstruction) => s.accessRestriction)}\n\n\t<div class=\"py-12 flex flex-col gap-y-4 text-muted-foreground\">\n\t\t<span class=\"ml-6\">\n\t\t\t{formatDurationSec(l.duration)}\n\t\t\t{getModeName(l)}\n\t\t\t{formatDistanceMeters(l.distance)}\n\t\t</span>\n\t\t{#if l.rental && l.rental.systemName}\n\t\t\t<span class=\"ml-6\">\n\t\t\t\t{t.sharingProvider}:\n\t\t\t\t<a href={l.rental.url} target=\"_blank\" class=\"hover:underline\">{l.rental.systemName}</a>\n\t\t\t</span>\n\t\t{/if}\n\t\t{#if l.rental?.returnConstraint == 'ROUNDTRIP_STATION'}\n\t\t\t<span class=\"ml-6\">\n\t\t\t\t{t.roundtripStationReturnConstraint}\n\t\t\t</span>\n\t\t{/if}\n\t\t{#if l.rental?.rentalUriWeb}\n\t\t\t<span class=\"ml-6\">\n\t\t\t\t<Button class=\"font-bold\" variant=\"outline\" href={l.rental.rentalUriWeb} target=\"_blank\">\n\t\t\t\t\t{t.rent}\n\t\t\t\t</Button>\n\t\t\t</span>\n\t\t{/if}\n\t\t{#if stepsWithElevation && stepsWithElevation.length > 0}\n\t\t\t<div class=\"ml-6 flex items-center gap-2 text-xs\">\n\t\t\t\t{t.incline}\n\t\t\t\t<div class=\"flex items-center\">\n\t\t\t\t\t<ArrowUp class=\"size-4\" />\n\t\t\t\t\t{stepsWithElevation.reduce((acc: number, s: StepInstruction) => acc + s.elevationUp!, 0)} m\n\t\t\t\t</div>\n\t\t\t\t<div class=\"flex items-center\">\n\t\t\t\t\t<ArrowDown class=\"size-4\" />\n\t\t\t\t\t{stepsWithElevation.reduce(\n\t\t\t\t\t\t(acc: number, s: StepInstruction) => acc + s.elevationDown!,\n\t\t\t\t\t\t0\n\t\t\t\t\t)} m\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\t\t{#if stepsWithToll && stepsWithToll.length > 0}\n\t\t\t<div class=\"ml-6 flex items-center gap-2 text-sm text-orange-500\">\n\t\t\t\t<DollarSign class=\"size-4\" />\n\t\t\t\t{t.toll}\n\t\t\t</div>\n\t\t{/if}\n\t\t{#if stepsWithAccessRestriction && stepsWithAccessRestriction.length > 0}\n\t\t\t<div class=\"ml-6 flex items-center gap-2 text-sm text-orange-500\">\n\t\t\t\t<CircleX class=\"size-4\" />\n\t\t\t\t{t.accessRestriction}\n\t\t\t\t({stepsWithAccessRestriction\n\t\t\t\t\t.map((s) => s.accessRestriction)\n\t\t\t\t\t.filter((value, index, array) => array.indexOf(value) === index)\n\t\t\t\t\t.join(', ')})\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n{/snippet}\n\n{#snippet productInfo(product: FareProduct)}\n\t{product.name}\n\t{new Intl.NumberFormat(language, { style: 'currency', currency: product.currency }).format(\n\t\tproduct.amount\n\t)}\n\t{#if product.riderCategory}\n\t\tfor\n\t\t{#if product.riderCategory.eligibilityUrl}\n\t\t\t<a\n\t\t\t\tclass:italic={product.riderCategory.isDefaultFareCategory}\n\t\t\t\tclass=\"underline\"\n\t\t\t\thref={product.riderCategory.eligibilityUrl}\n\t\t\t>\n\t\t\t\t{product.riderCategory.riderCategoryName}\n\t\t\t</a>\n\t\t{:else}\n\t\t\t<span class:italic={product.riderCategory.isDefaultFareCategory}>\n\t\t\t\t{product.riderCategory.riderCategoryName}\n\t\t\t</span>\n\t\t{/if}\n\t{/if}\n\t{#if product.media}\n\t\tas\n\t\t{#if product.media.fareMediaName}\n\t\t\t{product.media.fareMediaName}\n\t\t{:else}\n\t\t\t{product.media.fareMediaType}\n\t\t{/if}\n\t{/if}\n{/snippet}\n\n{#snippet ticketInfo(prevTransitLeg: Leg | undefined, l: Leg)}\n\t{#if itinerary.fareTransfers != undefined && l.fareTransferIndex != undefined && l.effectiveFareLegIndex != undefined}\n\t\t{@const fareTransfer = itinerary.fareTransfers[l.fareTransferIndex]}\n\t\t{@const includedInTransfer =\n\t\t\tfareTransfer.rule == 'AB' || (fareTransfer.rule == 'A_AB' && l.effectiveFareLegIndex !== 0)}\n\t\t{#if includedInTransfer || fareTransfer.effectiveFareLegProducts[l.effectiveFareLegIndex].length > 0}\n\t\t\t<div class=\"pl-1 md:pl-4 my-8 text-xs font-bold\">\n\t\t\t\t{#if includedInTransfer || (prevTransitLeg && prevTransitLeg.fareTransferIndex === l.fareTransferIndex && prevTransitLeg.effectiveFareLegIndex === l.effectiveFareLegIndex)}\n\t\t\t\t\t{t.includedInTicket}\n\t\t\t\t{:else}\n\t\t\t\t\t{@const productOptions = fareTransfer.effectiveFareLegProducts[l.effectiveFareLegIndex]}\n\t\t\t\t\t{#if productOptions.length > 1}\n\t\t\t\t\t\t<div class=\"mb-1\">{t.ticketOptions}:</div>\n\t\t\t\t\t{/if}\n\t\t\t\t\t<ul\n\t\t\t\t\t\tclass:list-disc={productOptions.length > 1}\n\t\t\t\t\t\tclass:list-outside={productOptions.length > 1}\n\t\t\t\t\t>\n\t\t\t\t\t\t{#each productOptions as products, i (i)}\n\t\t\t\t\t\t\t{#each products as product, j (j)}\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t{@render productInfo(product)}\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</ul>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t{/if}\n\t{/if}\n{/snippet}\n\n<div class=\"text-lg max-w-full\">\n\t{#each itinerary.legs as l, i (i)}\n\t\t{@const isLast = i == itinerary.legs.length - 1}\n\t\t{@const isLastPred = i == itinerary.legs.length - 2}\n\t\t{@const pred = i == 0 ? undefined : itinerary.legs[i - 1]}\n\t\t{@const next = isLast ? undefined : itinerary.legs[i + 1]}\n\t\t{@const prevTransitLeg = itinerary.legs.slice(0, i).find((l) => l.tripId)}\n\t\t{#if l.displayName}\n\t\t\t<div class=\"w-full flex justify-between items-center space-x-1\">\n\t\t\t\t<Route {onClickTrip} {l} />\n\t\t\t\t{#if pred && (pred.from.track || isRelevantLeg(pred)) && (i != 1 || pred.displayName)}\n\t\t\t\t\t<div class=\"border-t h-0 grow shrink\"></div>\n\t\t\t\t\t<div class=\"text-sm text-muted-foreground leading-none px-2 text-center\">\n\t\t\t\t\t\t{#if pred.duration}\n\t\t\t\t\t\t\t{formatDurationSec(pred.duration)} {t.walk}\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t{#if pred.distance}\n\t\t\t\t\t\t\t({Math.round(pred.distance)} m)\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t{#if prevTransitLeg?.fareTransferIndex != undefined && itinerary.fareTransfers && itinerary.fareTransfers[prevTransitLeg.fareTransferIndex].transferProducts}\n\t\t\t\t\t\t\t{@const transferProducts =\n\t\t\t\t\t\t\t\titinerary.fareTransfers[prevTransitLeg.fareTransferIndex].transferProducts!}\n\t\t\t\t\t\t\t{#if prevTransitLeg.effectiveFareLegIndex === 0 && l.effectiveFareLegIndex === 1}\n\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t<span class=\"text-xs font-bold text-foreground text-left\">\n\t\t\t\t\t\t\t\t\t{#if transferProducts.length > 1}\n\t\t\t\t\t\t\t\t\t\t<div class=\"mb-1\">{t.ticketOptions}:</div>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t<ul\n\t\t\t\t\t\t\t\t\t\tclass:list-disc={transferProducts.length > 1}\n\t\t\t\t\t\t\t\t\t\tclass:list-outside={transferProducts.length > 1}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{#each transferProducts as product, j (j)}\n\t\t\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t\t\t\t{@render productInfo(product)}\n\t\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t\t<div class=\"border-t h-0 grow shrink\"></div>\n\t\t\t</div>\n\n\t\t\t<div class=\"pt-4 pb-2 pl-4 sm:pl-6 border-l-4 left-4 relative\" style={routeBorderColor(l)}>\n\t\t\t\t{@render stopTimes(l.startTime, l.scheduledStartTime, l.realTime, l.from, l.mode, -1)}\n\t\t\t\t<div class=\"flex items-center\">\n\t\t\t\t\t<ArrowRight class=\"stroke-muted-foreground size-4\" />\n\t\t\t\t\t<span class=\"ml-1\">\n\t\t\t\t\t\t{#if l.tripTo}\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tclass=\"text-[length:inherit] text-muted-foreground leading-none justify-normal text-wrap text-left \"\n\t\t\t\t\t\t\t\tvariant=\"link\"\n\t\t\t\t\t\t\t\tonclick={() =>\n\t\t\t\t\t\t\t\t\tonClickStop(\n\t\t\t\t\t\t\t\t\t\tl.tripTo!.name,\n\t\t\t\t\t\t\t\t\t\tl.tripTo!.stopId!,\n\t\t\t\t\t\t\t\t\t\tnew Date(l.tripTo!.arrival!),\n\t\t\t\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{l.headsign}\n\t\t\t\t\t\t\t\t{#if !l.headsign || !l.tripTo.name.startsWith(l.headsign)}\n\t\t\t\t\t\t\t\t\t<br />({l.tripTo.name})\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t{l.headsign}\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\n\t\t\t\t<Alerts alerts={l.alerts} tz={l.from.tz || l.to.tz} variant=\"full\" />\n\n\t\t\t\t{#if l.loopedCalendarSince}\n\t\t\t\t\t<div class=\"mt-2 flex items-center text-destructive leading-none\">\n\t\t\t\t\t\t{t.dataExpiredSince}\n\t\t\t\t\t\t{formatDate(new Date(l.loopedCalendarSince), l.from.tz)}\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t\t{#if l.cancelled}\n\t\t\t\t\t<div class=\"mt-2 flex items-center text-destructive leading-none\">\n\t\t\t\t\t\t<CircleX class=\"stroke-destructive size-4\" />\n\t\t\t\t\t\t<span class=\"ml-1 font-bold\">{t.tripCancelled}</span>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t\t{#if !l.scheduled}\n\t\t\t\t\t<div class=\"mt-2 flex items-center text-green-600 leading-none\">\n\t\t\t\t\t\t<span class=\"ml-1\">{t.unscheduledTrip}</span>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t\t{#if l.intermediateStops?.length === 0}\n\t\t\t\t\t<div class=\"py-10 pl-4 md:pl-4 flex items-center text-muted-foreground\">\n\t\t\t\t\t\t{t.tripIntermediateStops(0)} ({formatDurationSec(l.duration)})\n\t\t\t\t\t</div>\n\t\t\t\t\t{@render ticketInfo(prevTransitLeg, l)}\n\t\t\t\t{:else}\n\t\t\t\t\t{@render ticketInfo(prevTransitLeg, l)}\n\t\t\t\t\t<details class=\"[&_.collapsible]:open:-rotate-180 my-2\">\n\t\t\t\t\t\t<summary class=\"py-10 pl-4 md:pl-4 flex items-center text-muted-foreground\">\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\tclass=\"collapsible rotate-0 transform transition-all duration-300\"\n\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<polyline points=\"6 9 12 15 18 9\"></polyline>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<span class=\"ml-2 cursor-pointer\">\n\t\t\t\t\t\t\t\t{t.tripIntermediateStops(l.intermediateStops?.length ?? 0)}\n\t\t\t\t\t\t\t\t({formatDurationSec(l.duration)})\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</summary>\n\t\t\t\t\t\t<div class=\"grid gap-2 items-start content-start pb-2\">\n\t\t\t\t\t\t\t{#each l.intermediateStops! as s, i (i)}\n\t\t\t\t\t\t\t\t{@render stopTimes(s.arrival!, s.scheduledArrival!, l.realTime, s, l.mode, 0)}\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</details>\n\t\t\t\t{/if}\n\n\t\t\t\t{#if !isLast && !(isLastPred && !isRelevantLeg(next!))}\n\t\t\t\t\t{@render stopTimes(l.endTime!, l.scheduledEndTime!, l.realTime!, l.to, l.mode, 1)}\n\t\t\t\t{/if}\n\n\t\t\t\t{#if isLast || (isLastPred && !isRelevantLeg(next!))}\n\t\t\t\t\t<!-- fill visual gap -->\n\t\t\t\t\t<div class=\"pb-2\"></div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t{:else if !(isLast && !isRelevantLeg(l)) && ((i == 0 && isRelevantLeg(l)) || !next || !next.displayName || l.mode != 'WALK' || (pred && (pred.mode == 'BIKE' || (l.mode == 'WALK' && pred.mode == 'CAR') || pred.mode == 'RENTAL')))}\n\t\t\t<Route {onClickTrip} {l} />\n\t\t\t<div class=\"pt-2 pb-2 pl-4 sm:pl-6 border-l-4 left-4 relative\" style={routeBorderColor(l)}>\n\t\t\t\t{@render stopTimes(l.startTime, l.scheduledStartTime, l.realTime, l.from, l.mode, -1, true)}\n\t\t\t\t{#if l.mode == 'FLEX'}\n\t\t\t\t\t<div class=\"mt-2 flex items-center leading-none\">\n\t\t\t\t\t\t<span class=\"ml-1 text-sm\">\n\t\t\t\t\t\t\t{formatTime(new Date(l.from.flexStartPickupDropOffWindow!), l.from.tz)} -\n\t\t\t\t\t\t\t{formatTime(new Date(l.from.flexEndPickupDropOffWindow!), l.from.tz)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t\t{@render streetLeg(l)}\n\t\t\t\t{#if !isLast}\n\t\t\t\t\t{@render stopTimes(l.endTime, l.scheduledEndTime, l.realTime, l.to, l.mode, 1, true)}\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t{/if}\n\t{/each}\n\t<div class=\"relative pl-4 md:pl-6 left-5\">\n\t\t<div\n\t\t\tclass=\"absolute left-[-9px] w-[15px] h-[15px] rounded-full\"\n\t\t\tstyle={routeColor(lastLeg!)}\n\t\t></div>\n\t\t<div class=\"relative top-[-6px] mb-[-6px]\">\n\t\t\t{@render stopTimes(\n\t\t\t\tlastLeg!.endTime,\n\t\t\t\tlastLeg!.scheduledEndTime,\n\t\t\t\tlastLeg!.realTime,\n\t\t\t\tlastLeg!.to,\n\t\t\t\tlastLeg!.mode,\n\t\t\t\t1\n\t\t\t)}\n\t\t</div>\n\t</div>\n</div>\n","<script lang=\"ts\">\n\timport maplibregl from 'maplibre-gl';\n\timport { onDestroy, getContext, setContext, type Snippet } from 'svelte';\n\timport type { MapMouseEvent, MapGeoJSONFeature } from 'maplibre-gl';\n\n\ttype ClickHandler = (\n\t\te: MapMouseEvent & { features?: MapGeoJSONFeature[] },\n\t\tmap: maplibregl.Map\n\t) => void;\n\n\tlet {\n\t\tid,\n\t\ttype,\n\t\tfilter,\n\t\tlayout,\n\t\tpaint,\n\t\tbeforeLayerId = 'road-ref-shield',\n\t\tonclick,\n\t\tonmousemove,\n\t\tonmouseenter,\n\t\tonmouseleave,\n\t\tchildren\n\t}: {\n\t\tid: string;\n\t\ttype: 'symbol' | 'fill' | 'line' | 'circle';\n\t\tfilter: maplibregl.FilterSpecification;\n\t\tlayout: Object; // eslint-disable-line\n\t\tpaint: Object; // eslint-disable-line\n\t\tbeforeLayerId?: string;\n\t\tonclick?: ClickHandler;\n\t\tonmousemove?: ClickHandler;\n\t\tonmouseenter?: ClickHandler;\n\t\tonmouseleave?: ClickHandler;\n\t\tchildren?: Snippet;\n\t} = $props();\n\n\ttype PendingState = {\n\t\tmoves: Map<string, string>;\n\t\tframe: number | null;\n\t};\n\n\tconst pendingMoves = new WeakMap<maplibregl.Map, PendingState>();\n\n\tconst ensurePendingState = (map: maplibregl.Map): PendingState => {\n\t\tlet state = pendingMoves.get(map);\n\t\tif (!state) {\n\t\t\tstate = { moves: new Map(), frame: null };\n\t\t\tpendingMoves.set(map, state);\n\t\t}\n\t\treturn state;\n\t};\n\n\tfunction click(e: MapMouseEvent & { features?: MapGeoJSONFeature[] }) {\n\t\tif (onclick) {\n\t\t\tonclick(e, ctx.map!);\n\t\t}\n\t}\n\n\tfunction mousemove(e: MapMouseEvent & { features?: MapGeoJSONFeature[] }) {\n\t\tif (onmousemove) {\n\t\t\tonmousemove(e, ctx.map!);\n\t\t}\n\t}\n\n\tfunction mouseenter(e: MapMouseEvent & { features?: MapGeoJSONFeature[] }) {\n\t\tif (onmouseenter) {\n\t\t\tonmouseenter(e, ctx.map!);\n\t\t}\n\t}\n\n\tfunction mouseleave(e: MapMouseEvent & { features?: MapGeoJSONFeature[] }) {\n\t\tif (onmouseleave) {\n\t\t\tonmouseleave(e, ctx.map!);\n\t\t}\n\t}\n\n\tconst processPendingMoves = (map: maplibregl.Map) => {\n\t\tconst state = pendingMoves.get(map);\n\t\tif (!state) {\n\t\t\treturn;\n\t\t}\n\t\tfor (const [layerId, beforeId] of Array.from(state.moves.entries())) {\n\t\t\tif (!map.getLayer(layerId)) {\n\t\t\t\tstate.moves.delete(layerId);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!map.getLayer(beforeId)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tmap.moveLayer(layerId, beforeId);\n\t\t\tstate.moves.delete(layerId);\n\t\t}\n\t\tif (state.moves.size === 0) {\n\t\t\tif (state.frame !== null) {\n\t\t\t\tcancelAnimationFrame(state.frame);\n\t\t\t}\n\t\t\tpendingMoves.delete(map);\n\t\t}\n\t};\n\n\tconst scheduleMoveLayer = (\n\t\tmap: maplibregl.Map,\n\t\tlayerId: string,\n\t\tbeforeId: string | undefined\n\t) => {\n\t\tif (!beforeId || beforeId === layerId) {\n\t\t\treturn;\n\t\t}\n\t\tconst state = ensurePendingState(map);\n\t\tstate.moves.set(layerId, beforeId);\n\t\tif (state.frame !== null) {\n\t\t\treturn;\n\t\t}\n\t\tstate.frame = requestAnimationFrame(() => {\n\t\t\tstate.frame = null;\n\t\t\tprocessPendingMoves(map);\n\t\t});\n\t};\n\n\tconst clearPendingForLayer = (map: maplibregl.Map | null | undefined, layerId: string) => {\n\t\tif (!map) {\n\t\t\treturn;\n\t\t}\n\t\tconst state = pendingMoves.get(map);\n\t\tif (!state) {\n\t\t\treturn;\n\t\t}\n\t\tstate.moves.delete(layerId);\n\t\tif (state.moves.size === 0) {\n\t\t\tif (state.frame !== null) {\n\t\t\t\tcancelAnimationFrame(state.frame);\n\t\t\t}\n\t\t\tpendingMoves.delete(map);\n\t\t}\n\t};\n\n\tlet layer = $state<{ id: null | string }>({ id });\n\tsetContext('layer', layer);\n\n\tlet ctx: { map: maplibregl.Map | null } = getContext('map'); // from Map component\n\tlet source: { id: string | null } = getContext('source'); // from GeoJSON component\n\n\tlet initialized = false;\n\t/* eslint-disable-next-line @typescript-eslint/ban-ts-comment */\n\t// @ts-ignore\n\tlet currFilter = $state.snapshot(filter);\n\tlet currLayout = $state.snapshot(layout);\n\tlet currPaint = $state.snapshot(paint);\n\tlet currBefore = beforeLayerId;\n\n\tlet updateLayer = () => {\n\t\tconst map = ctx.map;\n\t\tconst l = map?.getLayer(id);\n\t\tif (!source.id) {\n\t\t\tif (l) {\n\t\t\t\tlayer.id = null;\n\t\t\t\tmap?.removeLayer(id);\n\t\t\t}\n\t\t\tclearPendingForLayer(map, id);\n\t\t\treturn;\n\t\t}\n\n\t\tif (l && filter == currFilter && layout == currLayout && paint == currPaint) {\n\t\t\tif (map) {\n\t\t\t\tprocessPendingMoves(map);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (!l) {\n\t\t\tconst before = beforeLayerId && map?.getLayer(beforeLayerId) ? beforeLayerId : undefined;\n\t\t\tmap!.addLayer(\n\t\t\t\t// @ts-expect-error not assignable\n\t\t\t\t{\n\t\t\t\t\tsource: source.id,\n\t\t\t\t\tid,\n\t\t\t\t\ttype,\n\t\t\t\t\tfilter,\n\t\t\t\t\tlayout,\n\t\t\t\t\tpaint\n\t\t\t\t},\n\t\t\t\tbefore\n\t\t\t);\n\t\t\tcurrFilter = $state.snapshot(filter);\n\t\t\tcurrLayout = $state.snapshot(layout);\n\t\t\tcurrPaint = $state.snapshot(paint);\n\t\t\tcurrBefore = beforeLayerId;\n\t\t\tlayer.id = id;\n\t\t\tif (beforeLayerId && !before) {\n\t\t\t\tscheduleMoveLayer(map!, id, beforeLayerId);\n\t\t\t}\n\t\t\tprocessPendingMoves(map!);\n\t\t\treturn;\n\t\t}\n\n\t\tif (currFilter != filter) {\n\t\t\tcurrFilter = $state.snapshot(filter);\n\t\t\tmap!.setFilter(id, filter);\n\t\t}\n\t\tif (currBefore !== beforeLayerId) {\n\t\t\tcurrBefore = beforeLayerId;\n\t\t\tif (beforeLayerId && map?.getLayer(beforeLayerId)) {\n\t\t\t\tmap!.moveLayer(id, beforeLayerId);\n\t\t\t} else if (beforeLayerId) {\n\t\t\t\tscheduleMoveLayer(map!, id, beforeLayerId);\n\t\t\t}\n\t\t}\n\t\tif (map) {\n\t\t\tprocessPendingMoves(map);\n\t\t}\n\t};\n\n\t$effect(() => {\n\t\tif (ctx.map && source.id) {\n\t\t\tif (!initialized) {\n\t\t\t\tif (onclick) {\n\t\t\t\t\tctx.map.on('click', id, click);\n\t\t\t\t}\n\t\t\t\tif (onmousemove) {\n\t\t\t\t\tctx.map.on('mousemove', id, mousemove);\n\t\t\t\t}\n\t\t\t\tif (onmouseenter) {\n\t\t\t\t\tctx.map.on('mouseenter', id, mouseenter);\n\t\t\t\t}\n\t\t\t\tif (onmouseleave) {\n\t\t\t\t\tctx.map.on('mouseleave', id, mouseleave);\n\t\t\t\t}\n\t\t\t\tctx.map.on('styledata', updateLayer);\n\t\t\t\tupdateLayer();\n\t\t\t\tinitialized = true;\n\t\t\t}\n\t\t\tprocessPendingMoves(ctx.map);\n\t\t}\n\t});\n\n\tonDestroy(() => {\n\t\tconst l = ctx.map?.getLayer(id);\n\t\tctx.map?.off('styledata', updateLayer);\n\t\tif (onclick) {\n\t\t\tctx.map?.off('click', id, click);\n\t\t}\n\t\tif (onmousemove) {\n\t\t\tctx.map?.off('mousemove', id, mousemove);\n\t\t}\n\t\tif (onmouseenter) {\n\t\t\tctx.map?.off('mouseenter', id, mouseenter);\n\t\t}\n\t\tif (onmouseleave) {\n\t\t\tctx.map?.off('mouseleave', id, mouseleave);\n\t\t}\n\t\tif (l) {\n\t\t\tctx.map?.removeLayer(id);\n\t\t}\n\t\tclearPendingForLayer(ctx.map, id);\n\t});\n</script>\n\n{#if children}\n\t{@render children()}\n{/if}\n","<script lang=\"ts\">\n\timport maplibregl, { type GeoJSONSourceSpecification } from 'maplibre-gl';\n\timport GeoJSON from 'geojson';\n\timport { getContext, onDestroy, setContext, type Snippet } from 'svelte';\n\n\tclass Props {\n\t\tid!: string;\n\t\tdata!: GeoJSON.GeoJSON;\n\t\tlineMetrics?: boolean;\n\t\tchildren!: Snippet;\n\t\toptions?: Omit<GeoJSONSourceSpecification, 'type' | 'data'>;\n\t}\n\n\tlet { id, data, lineMetrics = false, children, options }: Props = $props();\n\n\tlet ctx: { map: maplibregl.Map | null } = getContext('map');\n\n\tlet sourceId = $state<{ id: null | string }>({ id: null });\n\tsetContext('source', sourceId);\n\n\tconst updateSource = () => {\n\t\tif (!ctx.map || data == null) {\n\t\t\treturn;\n\t\t}\n\t\tconst src = ctx.map!.getSource(id) as maplibregl.GeoJSONSource | undefined;\n\t\tif (src) {\n\t\t\tsrc.setData(data);\n\t\t} else {\n\t\t\tctx.map!.addSource(id, {\n\t\t\t\ttype: 'geojson',\n\t\t\t\tlineMetrics,\n\t\t\t\tdata,\n\t\t\t\t...(options ?? {})\n\t\t\t});\n\t\t}\n\t\tsourceId.id = id;\n\t};\n\n\tlet initialized = false;\n\t$effect(() => {\n\t\tif (ctx.map && id && data) {\n\t\t\tupdateSource();\n\t\t\tif (!initialized) {\n\t\t\t\tctx.map!.on('styledata', updateSource);\n\t\t\t\tsourceId.id = id;\n\t\t\t\tinitialized = true;\n\t\t\t}\n\t\t}\n\t});\n\n\tonDestroy(() => {\n\t\tif (initialized) {\n\t\t\tctx.map?.off('styledata', updateSource);\n\t\t\tsourceId.id = null;\n\t\t\tconst src = ctx.map!.getSource(id);\n\t\t\tif (src) {\n\t\t\t\tctx.map?.removeSource(id);\n\t\t\t}\n\t\t}\n\t});\n</script>\n\n{@render children()}\n","// routing layer \\\\\n\nimport type { ExpressionFilterSpecification } from 'maplibre-gl';\n\nexport const currentLevel: ExpressionFilterSpecification = ['coalesce', ['get', 'level'], 0];\nexport const ceilFromLevel: ExpressionFilterSpecification = [\n\t'coalesce',\n\t['ceil', ['to-number', ['get', 'fromLevel']]],\n\t0\n];\nexport const ceilToLevel: ExpressionFilterSpecification = [\n\t'coalesce',\n\t['ceil', ['to-number', ['get', 'toLevel']]],\n\t0\n];\nexport const floorFromLevel: ExpressionFilterSpecification = [\n\t'coalesce',\n\t['floor', ['to-number', ['get', 'fromLevel']]],\n\t0\n];\nexport const floorToLevel: ExpressionFilterSpecification = [\n\t'coalesce',\n\t['floor', ['to-number', ['get', 'toLevel']]],\n\t0\n];\n\n/// Filter to match all connections that lie on, cross or connect to the current level.\n\nexport const connectsToCurrentLevelRoutingFilter: ExpressionFilterSpecification = [\n\t'all',\n\t['<=', ['min', floorToLevel, floorFromLevel], currentLevel],\n\t['>=', ['max', ceilToLevel, ceilFromLevel], currentLevel]\n];\n\n/// Filter to match path connections on the current level.\n\nexport const isCurrentLevelRoutingFilter: ExpressionFilterSpecification = [\n\t'any',\n\t['all', ['==', ceilFromLevel, currentLevel], ['==', ceilToLevel, currentLevel]],\n\t['all', ['==', floorFromLevel, currentLevel], ['==', floorToLevel, currentLevel]]\n];\n\n/// Filter to match path connections on any lower level that do not connect to current level.\n\nexport const isLowerLevelRoutingFilter: ExpressionFilterSpecification = [\n\t'any',\n\t['all', ['<', ceilFromLevel, currentLevel], ['<', ceilToLevel, currentLevel]],\n\t['all', ['<', floorFromLevel, currentLevel], ['<', floorToLevel, currentLevel]]\n];\n\n/// Filter to match path connections on any upper level that do not connect to current level.\n\nexport const isUpperLevelRoutingFilter: ExpressionFilterSpecification = [\n\t'any',\n\t['all', ['>', ceilFromLevel, currentLevel], ['>', ceilToLevel, currentLevel]],\n\t['all', ['>', floorFromLevel, currentLevel], ['>', floorToLevel, currentLevel]]\n];\n\n/// Filter to match paths that act as a connection from the current level to the upper level.\n\nexport const leadsToUpperLevelRoutingFilter: ExpressionFilterSpecification = [\n\t'all',\n\t['any', ['==', ceilFromLevel, currentLevel], ['==', floorFromLevel, currentLevel]],\n\t['any', ['>', ceilToLevel, currentLevel], ['>', floorToLevel, currentLevel]]\n];\n\n/// Filter to match paths that act as a connection from the upper level to the current level.\n\nexport const leadsDownToCurrentLevelRoutingFilter: ExpressionFilterSpecification = [\n\t'all',\n\t['any', ['>', ceilFromLevel, currentLevel], ['>', floorFromLevel, currentLevel]],\n\t['any', ['==', ceilToLevel, currentLevel], ['==', floorToLevel, currentLevel]]\n];\n\n/// Filter to match paths that act as a connection from the current level to the lower level.\n\nexport const leadsToLowerLevelRoutingFilter: ExpressionFilterSpecification = [\n\t'all',\n\t['any', ['==', ceilFromLevel, currentLevel], ['==', floorFromLevel, currentLevel]],\n\t['any', ['<', ceilToLevel, currentLevel], ['<', floorToLevel, currentLevel]]\n];\n\n/// Filter to match paths that act as a connection from the lower level to the current level.\n\nexport const leadsUpToCurrentLevelRoutingFilter: ExpressionFilterSpecification = [\n\t'all',\n\t['any', ['<', ceilFromLevel, currentLevel], ['<', floorFromLevel, currentLevel]],\n\t['any', ['==', ceilToLevel, currentLevel], ['==', floorToLevel, currentLevel]]\n];\n\n// indoor tile layer \\\\\n\nexport const ceilLevel: ExpressionFilterSpecification = [\n\t'coalesce',\n\t['ceil', ['to-number', ['get', 'level']]],\n\t0\n];\nexport const floorLevel: ExpressionFilterSpecification = [\n\t'coalesce',\n\t['floor', ['to-number', ['get', 'level']]],\n\t0\n];\n\n/// Filter to only show element if level matches current level.\n///\n/// This will show features with level 0.5; 0.3; 0.7 on level 0 and on level 1\n\nexport const isCurrentLevelFilter: ExpressionFilterSpecification = [\n\t'any',\n\t['==', ceilLevel, currentLevel],\n\t['==', floorLevel, currentLevel]\n];\n\n/// Filter to match **any** level below the current level.\n\nexport const isLowerLevelFilter: ExpressionFilterSpecification = [\n\t// important that ceil and floor need to be lower\n\t'all',\n\t['<', ceilLevel, currentLevel],\n\t['<', floorLevel, currentLevel]\n];\n","import {\n\tisLowerLevelRoutingFilter,\n\tisUpperLevelRoutingFilter,\n\tisCurrentLevelRoutingFilter,\n\tleadsToLowerLevelRoutingFilter,\n\tleadsUpToCurrentLevelRoutingFilter,\n\tleadsDownToCurrentLevelRoutingFilter,\n\tleadsToUpperLevelRoutingFilter\n} from './layerFilters';\n\n/// Routing path current level line color.\nconst routingPathFillColor = '#42a5f5';\n/// Routing path current level line outline color.\nconst routingPathOutlineColor = '#0077c2';\n/// Routing path other level line color.\nconst routingPathOtherLevelFillColor = '#aaaaaa';\n/// Routing path other level line outline color.\nconst routingPathOtherLevelOutlineColor = '#555555';\n/// Routing path line color.\nconst routingPathWidth = 7;\n/// Routing path line color.\nconst routingPathOutlineWidth = routingPathWidth + 2;\n\nexport const layers = [\n\t// Indoor routing - Outline - Current level \\\\\n\n\t{\n\t\tid: 'indoor-routing-path-current-outline',\n\t\ttype: 'line',\n\t\tfilter: isCurrentLevelRoutingFilter,\n\t\tlayout: {\n\t\t\t'line-join': 'round',\n\t\t\t'line-cap': 'round'\n\t\t},\n\t\tpaint: {\n\t\t\t'line-color': routingPathOutlineColor,\n\t\t\t'line-width': routingPathOutlineWidth\n\t\t}\n\t},\n\n\t// Indoor routing - Lower level connecting path segments \\\\\n\n\t{\n\t\tid: 'indoor-routing-lower-path-down-outline',\n\t\ttype: 'line',\n\t\tfilter: leadsToLowerLevelRoutingFilter,\n\t\tlayout: {\n\t\t\t'line-join': 'round'\n\t\t},\n\t\tpaint: {\n\t\t\t'line-width': routingPathOutlineWidth,\n\t\t\t'line-gradient': [\n\t\t\t\t'interpolate',\n\t\t\t\t['linear'],\n\t\t\t\t['line-progress'],\n\t\t\t\t0,\n\t\t\t\troutingPathOutlineColor,\n\t\t\t\t1,\n\t\t\t\troutingPathOtherLevelOutlineColor\n\t\t\t]\n\t\t}\n\t},\n\t{\n\t\tid: 'indoor-routing-lower-path-down',\n\t\ttype: 'line',\n\t\tfilter: leadsToLowerLevelRoutingFilter,\n\t\tlayout: {\n\t\t\t'line-join': 'round'\n\t\t},\n\t\tpaint: {\n\t\t\t'line-width': routingPathWidth,\n\t\t\t'line-gradient': [\n\t\t\t\t'interpolate',\n\t\t\t\t['linear'],\n\t\t\t\t['line-progress'],\n\t\t\t\t0,\n\t\t\t\troutingPathFillColor,\n\t\t\t\t1,\n\t\t\t\troutingPathOtherLevelFillColor\n\t\t\t]\n\t\t}\n\t},\n\t{\n\t\tid: 'indoor-routing-lower-path-up-outline',\n\t\ttype: 'line',\n\t\tfilter: leadsUpToCurrentLevelRoutingFilter,\n\t\tlayout: {\n\t\t\t'line-join': 'round'\n\t\t},\n\t\tpaint: {\n\t\t\t'line-width': routingPathOutlineWidth,\n\t\t\t'line-gradient': [\n\t\t\t\t'interpolate',\n\t\t\t\t['linear'],\n\t\t\t\t['line-progress'],\n\t\t\t\t0,\n\t\t\t\troutingPathOtherLevelOutlineColor,\n\t\t\t\t1,\n\t\t\t\troutingPathOutlineColor\n\t\t\t]\n\t\t}\n\t},\n\t{\n\t\tid: 'indoor-routing-lower-path-up',\n\t\ttype: 'line',\n\t\tfilter: leadsUpToCurrentLevelRoutingFilter,\n\t\tlayout: {\n\t\t\t'line-join': 'round'\n\t\t},\n\t\tpaint: {\n\t\t\t'line-width': routingPathWidth,\n\t\t\t'line-gradient': [\n\t\t\t\t'interpolate',\n\t\t\t\t['linear'],\n\t\t\t\t['line-progress'],\n\t\t\t\t0,\n\t\t\t\troutingPathOtherLevelFillColor,\n\t\t\t\t1,\n\t\t\t\troutingPathFillColor\n\t\t\t]\n\t\t}\n\t},\n\n\t// Indoor routing - Outline - Upper level connecting path segments \\\\\n\n\t{\n\t\tid: 'indoor-routing-upper-path-down-outline',\n\t\ttype: 'line',\n\t\tfilter: leadsDownToCurrentLevelRoutingFilter,\n\t\tlayout: {\n\t\t\t'line-join': 'round'\n\t\t},\n\t\tpaint: {\n\t\t\t'line-width': routingPathOutlineWidth,\n\t\t\t// 'line-gradient' must be specified using an expression\n\t\t\t// with the special 'line-progress' property\n\t\t\t// the source must have the 'lineMetrics' option set to true\n\t\t\t// note the line points have to be ordered so it fits (the direction of the line)\n\t\t\t// because no other expression are supported here\n\t\t\t'line-gradient': [\n\t\t\t\t'interpolate',\n\t\t\t\t['linear'],\n\t\t\t\t['line-progress'],\n\t\t\t\t0,\n\t\t\t\troutingPathOtherLevelOutlineColor,\n\t\t\t\t1,\n\t\t\t\troutingPathOutlineColor\n\t\t\t]\n\t\t}\n\t},\n\t{\n\t\tid: 'indoor-routing-upper-path-up-outline',\n\t\ttype: 'line',\n\t\tfilter: leadsToUpperLevelRoutingFilter,\n\t\tlayout: {\n\t\t\t'line-join': 'round'\n\t\t},\n\t\tpaint: {\n\t\t\t'line-width': routingPathOutlineWidth,\n\t\t\t'line-gradient': [\n\t\t\t\t'interpolate',\n\t\t\t\t['linear'],\n\t\t\t\t['line-progress'],\n\t\t\t\t0,\n\t\t\t\troutingPathOutlineColor,\n\t\t\t\t1,\n\t\t\t\troutingPathOtherLevelOutlineColor\n\t\t\t]\n\t\t}\n\t},\n\n\t// Indoor routing - Concealed edges outline - Below current level \\\\\n\n\t{\n\t\tid: 'indoor-routing-path-concealed-below-outline',\n\t\t// required, otherwise line-dasharray will scale with metrics\n\t\ttype: 'line',\n\t\tfilter: isLowerLevelRoutingFilter,\n\t\tlayout: {\n\t\t\t'line-join': 'round'\n\t\t},\n\t\tpaint: {\n\t\t\t'line-color': routingPathOtherLevelOutlineColor,\n\t\t\t'line-width': 2,\n\t\t\t'line-gap-width': 6,\n\t\t\t'line-dasharray': ['literal', [2, 2]]\n\t\t}\n\t},\n\n\t// Indoor routing - Outline - Above current level \\\\\n\n\t{\n\t\tid: 'indoor-routing-path-above-outline',\n\t\ttype: 'line',\n\t\tfilter: isUpperLevelRoutingFilter,\n\t\tlayout: {\n\t\t\t'line-join': 'round',\n\t\t\t'line-cap': 'round'\n\t\t},\n\t\tpaint: {\n\t\t\t'line-color': routingPathOtherLevelOutlineColor,\n\t\t\t'line-width': routingPathOutlineWidth\n\t\t}\n\t},\n\n\t// Indoor routing - Fill - Current level \\\\\n\n\t{\n\t\tid: 'indoor-routing-path-current',\n\t\ttype: 'line',\n\t\tfilter: isCurrentLevelRoutingFilter,\n\t\tlayout: {\n\t\t\t'line-join': 'round',\n\t\t\t'line-cap': 'round'\n\t\t},\n\t\tpaint: {\n\t\t\t'line-color': routingPathFillColor,\n\t\t\t'line-width': routingPathWidth\n\t\t}\n\t},\n\n\t// Indoor routing - Fill - Upper level connecting path segments \\\\\n\n\t{\n\t\tid: 'indoor-routing-upper-path-down',\n\t\ttype: 'line',\n\t\tfilter: leadsDownToCurrentLevelRoutingFilter,\n\t\tlayout: {\n\t\t\t'line-join': 'round',\n\t\t\t'line-cap': 'round'\n\t\t},\n\t\tpaint: {\n\t\t\t'line-width': routingPathWidth,\n\t\t\t'line-gradient': [\n\t\t\t\t'interpolate',\n\t\t\t\t['linear'],\n\t\t\t\t['line-progress'],\n\t\t\t\t0,\n\t\t\t\troutingPathOtherLevelFillColor,\n\t\t\t\t1,\n\t\t\t\troutingPathFillColor\n\t\t\t]\n\t\t}\n\t},\n\t{\n\t\tid: 'indoor-routing-upper-path-up',\n\t\ttype: 'line',\n\t\tfilter: leadsToUpperLevelRoutingFilter,\n\t\tlayout: {\n\t\t\t'line-join': 'round',\n\t\t\t'line-cap': 'round'\n\t\t},\n\t\tpaint: {\n\t\t\t'line-width': routingPathWidth,\n\t\t\t'line-gradient': [\n\t\t\t\t'interpolate',\n\t\t\t\t['linear'],\n\t\t\t\t['line-progress'],\n\t\t\t\t0,\n\t\t\t\troutingPathFillColor,\n\t\t\t\t1,\n\t\t\t\troutingPathOtherLevelFillColor\n\t\t\t]\n\t\t}\n\t},\n\n\t// Indoor routing - Fill - Above current level \\\\\n\n\t{\n\t\tid: 'indoor-routing-path-above',\n\t\ttype: 'line',\n\t\tfilter: isUpperLevelRoutingFilter,\n\t\tlayout: {\n\t\t\t'line-join': 'round',\n\t\t\t'line-cap': 'round'\n\t\t},\n\t\tpaint: {\n\t\t\t'line-color': routingPathOtherLevelFillColor,\n\t\t\t'line-width': routingPathWidth\n\t\t}\n\t}\n] as const;\n","<script lang=\"ts\">\n\timport Layer from '$lib/map/Layer.svelte';\n\timport GeoJSON from '$lib/map/GeoJSON.svelte';\n\timport type { Itinerary, Mode } from '@motis-project/motis-client';\n\timport { getColor } from '$lib/modeStyle';\n\timport polyline from '@mapbox/polyline';\n\timport { colord } from 'colord';\n\timport { layers } from './itineraryLayers';\n\texport const PRECISION = 6;\n\n\tconst {\n\t\titinerary,\n\t\tid,\n\t\tselected,\n\t\tselectItinerary,\n\t\tlevel,\n\t\ttheme\n\t}: {\n\t\titinerary: Itinerary;\n\t\tid?: string;\n\t\tselected: boolean;\n\t\tselectItinerary?: () => void;\n\t\tlevel: number;\n\t\ttheme: 'light' | 'dark';\n\t} = $props();\n\n\tfunction isIndividualTransport(m: Mode): boolean {\n\t\treturn m == 'WALK' || m == 'BIKE' || m == 'CAR';\n\t}\n\n\tfunction getIndividualModeColor(m: Mode): string {\n\t\tswitch (m) {\n\t\t\tcase 'CAR':\n\t\t\t\treturn '#bf75ff';\n\t\t\tdefault:\n\t\t\t\treturn '#42a5f5';\n\t\t}\n\t}\n\n\tfunction itineraryToGeoJSON(i: Itinerary): GeoJSON.GeoJSON {\n\t\treturn {\n\t\t\ttype: 'FeatureCollection',\n\t\t\tfeatures: i.legs.flatMap((l) => {\n\t\t\t\tif (l.steps) {\n\t\t\t\t\tconst color = isIndividualTransport(l.mode)\n\t\t\t\t\t\t? getIndividualModeColor(l.mode)\n\t\t\t\t\t\t: `${getColor(l)[0]}`;\n\t\t\t\t\tconst outlineColor = colord(color).darken(0.2).toHex();\n\t\t\t\t\treturn l.steps.map((p) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttype: 'Feature',\n\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\tcolor,\n\t\t\t\t\t\t\t\toutlineColor,\n\t\t\t\t\t\t\t\tfromLevel: p.fromLevel,\n\t\t\t\t\t\t\t\ttoLevel: p.toLevel,\n\t\t\t\t\t\t\t\tlevel: level,\n\t\t\t\t\t\t\t\tway: p.osmWay\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tgeometry: {\n\t\t\t\t\t\t\t\ttype: 'LineString',\n\t\t\t\t\t\t\t\tcoordinates: polyline.decode(p.polyline.points, PRECISION).map(([x, y]) => [y, x])\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tconst color = `${getColor(l)[0]}`;\n\t\t\t\t\tconst outlineColor = colord(color).darken(0.2).toHex();\n\t\t\t\t\treturn {\n\t\t\t\t\t\ttype: 'Feature',\n\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\toutlineColor,\n\t\t\t\t\t\t\tcolor\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgeometry: {\n\t\t\t\t\t\t\ttype: 'LineString',\n\t\t\t\t\t\t\tcoordinates: polyline.decode(l.legGeometry.points, PRECISION).map(([x, y]) => [y, x])\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t})\n\t\t};\n\t}\n\tconst geojson = $derived(itineraryToGeoJSON(itinerary));\n</script>\n\n<GeoJSON id=\"route-{id}\" data={geojson}>\n\t{#each layers as layer (layer.id)}\n\t\t{#if !('line-gradient' in layer.paint) && selected}\n\t\t\t<Layer\n\t\t\t\tid={layer.id}\n\t\t\t\ttype={layer.type}\n\t\t\t\tlayout={layer.layout}\n\t\t\t\tfilter={['all', ['has', 'fromLevel'], layer.filter]}\n\t\t\t\tpaint={layer.paint}\n\t\t\t></Layer>\n\t\t{/if}\n\t{/each}\n\t<Layer\n\t\tid=\"path-{id}\"\n\t\ttype=\"line\"\n\t\tlayout={{\n\t\t\t'line-join': 'round',\n\t\t\t'line-cap': 'round'\n\t\t}}\n\t\tfilter={['!', ['has', 'fromLevel']]}\n\t\tonclick={selectItinerary\n\t\t\t? (_) => {\n\t\t\t\t\tselectItinerary();\n\t\t\t\t}\n\t\t\t: undefined}\n\t\tpaint={{\n\t\t\t'line-color': selected ? ['get', 'color'] : theme == 'dark' ? '#777' : '#bbb',\n\t\t\t'line-width': 7.5,\n\t\t\t'line-opacity': 1\n\t\t}}\n\t/>\n\t<Layer\n\t\tid=\"path-outline-{id}\"\n\t\ttype=\"line\"\n\t\tlayout={{\n\t\t\t'line-join': 'round',\n\t\t\t'line-cap': 'round'\n\t\t}}\n\t\tfilter={['!', ['has', 'fromLevel']]}\n\t\tpaint={{\n\t\t\t'line-color': selected ? ['get', 'outlineColor'] : theme == 'dark' ? '#444' : '#999',\n\t\t\t'line-width': 1.5,\n\t\t\t'line-gap-width': 7.5,\n\t\t\t'line-opacity': 1\n\t\t}}\n\t/>\n</GeoJSON>\n<GeoJSON id=\"route-{id}-metrics\" data={geojson} lineMetrics={true}>\n\t{#each layers as layer (layer.id)}\n\t\t{#if 'line-gradient' in layer.paint && selected}\n\t\t\t<Layer\n\t\t\t\tid=\"{layer.id}-metrics\"\n\t\t\t\ttype={layer.type}\n\t\t\t\tlayout={layer.layout}\n\t\t\t\tfilter={layer.filter}\n\t\t\t\tpaint={layer.paint}\n\t\t\t></Layer>\n\t\t{/if}\n\t{/each}\n</GeoJSON>\n","<script lang=\"ts\">\n\timport type { HTMLTableAttributes } from \"svelte/elements\";\n\timport type { WithElementRef } from \"bits-ui\";\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\tchildren,\n\t\t...restProps\n\t}: WithElementRef<HTMLTableAttributes> = $props();\n</script>\n\n<div class=\"relative w-full overflow-auto\">\n\t<table bind:this={ref} class={cn(\"w-full caption-bottom text-sm\", className)} {...restProps}>\n\t\t{@render children?.()}\n\t</table>\n</div>\n","<script lang=\"ts\">\n\timport type { HTMLAttributes } from \"svelte/elements\";\n\timport type { WithElementRef } from \"bits-ui\";\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\tchildren,\n\t\t...restProps\n\t}: WithElementRef<HTMLAttributes<HTMLTableSectionElement>> = $props();\n</script>\n\n<tbody bind:this={ref} class={cn(\"[&_tr:last-child]:border-0\", className)} {...restProps}>\n\t{@render children?.()}\n</tbody>\n","<script lang=\"ts\">\n\timport type { HTMLTdAttributes } from \"svelte/elements\";\n\timport type { WithElementRef } from \"bits-ui\";\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\tchildren,\n\t\t...restProps\n\t}: WithElementRef<HTMLTdAttributes> = $props();\n</script>\n\n<td\n\tbind:this={ref}\n\tclass={cn(\n\t\t\"p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n\t\tclassName\n\t)}\n\t{...restProps}\n>\n\t{@render children?.()}\n</td>\n","<script lang=\"ts\">\n\timport type { HTMLThAttributes } from \"svelte/elements\";\n\timport type { WithElementRef } from \"bits-ui\";\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\tchildren,\n\t\t...restProps\n\t}: WithElementRef<HTMLThAttributes> = $props();\n</script>\n\n<th\n\tbind:this={ref}\n\tclass={cn(\n\t\t\"text-muted-foreground h-10 px-2 text-left align-middle font-medium [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n\t\tclassName\n\t)}\n\t{...restProps}\n>\n\t{@render children?.()}\n</th>\n","<script lang=\"ts\">\n\timport type { HTMLAttributes } from \"svelte/elements\";\n\timport type { WithElementRef } from \"bits-ui\";\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\tchildren,\n\t\t...restProps\n\t}: WithElementRef<HTMLAttributes<HTMLTableSectionElement>> = $props();\n</script>\n\n<thead bind:this={ref} class={cn(\"[&_tr]:border-b\", className)} {...restProps}>\n\t{@render children?.()}\n</thead>\n","<script lang=\"ts\">\n\timport type { HTMLAttributes } from \"svelte/elements\";\n\timport type { WithElementRef } from \"bits-ui\";\n\timport { cn } from \"$lib/utils.js\";\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\tchildren,\n\t\t...restProps\n\t}: WithElementRef<HTMLAttributes<HTMLTableRowElement>> = $props();\n</script>\n\n<tr\n\tbind:this={ref}\n\tclass={cn(\n\t\t\"hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors\",\n\t\tclassName\n\t)}\n\t{...restProps}\n>\n\t{@render children?.()}\n</tr>\n","<script lang=\"ts\">\n\timport { posToLocation, type Location } from '$lib/Location';\n\timport maplibregl from 'maplibre-gl';\n\timport { getContext, onDestroy } from 'svelte';\n\n\tlet ctx: { map: maplibregl.Map | null } = getContext('map'); // from Map component\n\n\tlet {\n\t\tcolor,\n\t\tdraggable,\n\t\tlevel,\n\t\tlocation = $bindable(),\n\t\tmarker = $bindable()\n\t}: {\n\t\tcolor: string;\n\t\tdraggable: boolean;\n\t\tlevel?: number;\n\t\tlocation: Location;\n\t\tmarker?: maplibregl.Marker;\n\t} = $props();\n\n\tlet initialized = false;\n\n\t$effect(() => {\n\t\tif (ctx.map && location.match) {\n\t\t\tif (!initialized) {\n\t\t\t\tmarker = new maplibregl.Marker({\n\t\t\t\t\tdraggable,\n\t\t\t\t\tcolor\n\t\t\t\t})\n\t\t\t\t\t.setLngLat(location.match)\n\t\t\t\t\t.addTo(ctx.map);\n\t\t\t\tmarker.on('dragend', () => {\n\t\t\t\t\tif (marker && location.match) {\n\t\t\t\t\t\tlet x = posToLocation(marker.getLngLat(), level ?? 0);\n\t\t\t\t\t\tlocation = x;\n\t\t\t\t\t\tlocation.label = x.label;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tinitialized = true;\n\t\t\t}\n\t\t}\n\t});\n\n\t$effect(() => {\n\t\tif (marker && location && location.match && location.match.lat && location.match.lon) {\n\t\t\tmarker.setLngLat(location.match);\n\t\t}\n\t});\n\n\tonDestroy(() => {\n\t\tif (marker) {\n\t\t\tmarker.remove();\n\t\t\tmarker = undefined;\n\t\t}\n\t});\n</script>\n","<script lang=\"ts\">\n\timport maplibregl from 'maplibre-gl';\n\timport { getContext, onDestroy, type Snippet } from 'svelte';\n\n\tlet {\n\t\tchildren,\n\t\tclass: className,\n\t\ttrigger\n\t}: {\n\t\tchildren?: Snippet<[maplibregl.MapMouseEvent, () => void, unknown?]>;\n\t\tclass?: string;\n\t\ttrigger: 'click' | 'contextmenu';\n\t} = $props();\n\n\tlet ctx: { map: maplibregl.Map | null } = getContext('map'); // from Map component\n\tlet layer: { id: string } | null = getContext('layer'); // from Layer component (optional)\n\n\tlet popupEl = $state<HTMLDivElement>();\n\tlet popup = $state<maplibregl.Popup>();\n\tlet event = $state.raw<maplibregl.MapMouseEvent>();\n\tlet features = $state.raw();\n\n\tconst close = () => {\n\t\tif (popup) {\n\t\t\tpopup.remove();\n\t\t\tpopup = undefined;\n\t\t}\n\t};\n\n\tconst onTrigger = (e: maplibregl.MapLayerMouseEvent) => {\n\t\tif (ctx.map) {\n\t\t\tif (popup) {\n\t\t\t\tpopup.remove();\n\t\t\t}\n\t\t\tpopup = new maplibregl.Popup({\n\t\t\t\tanchor: 'top-left',\n\t\t\t\tcloseButton: false\n\t\t\t});\n\t\t\tpopup.setLngLat(e.lngLat);\n\t\t\tpopup.addTo(ctx.map!);\n\t\t\tevent = e;\n\t\t\tfeatures = e.features;\n\t\t}\n\t};\n\n\tconst onMouseEnter = () => {\n\t\tif (ctx.map) {\n\t\t\tctx.map.getCanvas().style.cursor = 'pointer';\n\t\t}\n\t};\n\n\tconst onMouseLeave = () => {\n\t\tif (ctx.map) {\n\t\t\tctx.map.getCanvas().style.cursor = '';\n\t\t}\n\t};\n\n\tlet initialized = false;\n\t$effect(() => {\n\t\tif (ctx.map) {\n\t\t\tif (!initialized) {\n\t\t\t\tif (layer) {\n\t\t\t\t\tctx.map.on(trigger, layer.id, onTrigger);\n\t\t\t\t\tctx.map.on('mouseenter', layer.id, onMouseEnter);\n\t\t\t\t\tctx.map.on('mouseleave', layer.id, onMouseLeave);\n\t\t\t\t} else {\n\t\t\t\t\tctx.map.on(trigger, onTrigger);\n\t\t\t\t}\n\t\t\t}\n\t\t\tinitialized = true;\n\t\t}\n\t});\n\n\t$effect(() => {\n\t\tif (popup && popupEl) {\n\t\t\tpopup.setDOMContent(popupEl);\n\t\t}\n\t});\n\n\tonDestroy(() => {\n\t\tif (popup) {\n\t\t\tpopup.remove();\n\t\t\tpopup = undefined;\n\t\t}\n\t\tif (ctx.map && initialized) {\n\t\t\tif (layer) {\n\t\t\t\tctx.map.off(trigger, layer.id, onTrigger);\n\t\t\t\tctx.map.off('mouseenter', layer.id, onMouseEnter);\n\t\t\t\tctx.map.off('mouseleave', layer.id, onMouseLeave);\n\t\t\t} else {\n\t\t\t\tctx.map.off(trigger, onTrigger);\n\t\t\t}\n\t\t}\n\t});\n</script>\n\n{#if popup && event}\n\t<div bind:this={popupEl} class={className}>\n\t\t{#if children}\n\t\t\t{@render children(event, close, features)}\n\t\t{/if}\n\t</div>\n{/if}\n","<script lang=\"ts\">\n\timport { Bug, X, LoaderCircle } from '@lucide/svelte';\n\timport { Button } from '$lib/components/ui/button';\n\timport GeoJSON from '$lib/map/GeoJSON.svelte';\n\timport Layer from '$lib/map/Layer.svelte';\n\timport {\n\t\tTable,\n\t\tTableBody,\n\t\tTableCell,\n\t\tTableHead,\n\t\tTableHeader,\n\t\tTableRow\n\t} from '$lib/components/ui/table';\n\timport maplibregl from 'maplibre-gl';\n\timport { transfers } from '@motis-project/motis-client';\n\timport Control from '$lib/map/Control.svelte';\n\timport * as Card from '$lib/components/ui/card';\n\timport Marker from '$lib/map/Marker.svelte';\n\timport { posToLocation, type Location as ApiLocation } from '$lib/Location';\n\timport geojson from 'geojson';\n\timport Popup from '$lib/map/Popup.svelte';\n\timport { client } from '@motis-project/motis-client';\n\timport DateInput from './DateInput.svelte';\n\n\tconst baseUrl = client.getConfig().baseUrl;\n\n\tconst post = async (path: string, req: unknown) => {\n\t\tconst response = await fetch(`${baseUrl}${path}`, {\n\t\t\tmethod: 'POST',\n\t\t\tmode: 'cors',\n\t\t\theaders: {\n\t\t\t\t'Access-Control-Allow-Origin': '*',\n\t\t\t\t'Content-Type': 'application/json'\n\t\t\t},\n\t\t\tbody: JSON.stringify(req)\n\t\t});\n\t\treturn await response.json();\n\t};\n\n\tconst get = async (path: string) => {\n\t\tconst response = await fetch(`${baseUrl}${path}`, {\n\t\t\tmethod: 'GET',\n\t\t\tmode: 'cors',\n\t\t\theaders: {\n\t\t\t\t'Access-Control-Allow-Origin': '*',\n\t\t\t\t'Content-Type': 'application/json'\n\t\t\t}\n\t\t});\n\t\treturn await response.json();\n\t};\n\n\ttype Location = {\n\t\tlat: number;\n\t\tlng: number;\n\t\tlevel: number;\n\t};\n\n\ttype RoutingQuery = {\n\t\tstart: Location;\n\t\tdestination: Location;\n\t\tprofile: string;\n\t\tdirection: string;\n\t};\n\n\ttype ElevatorStatus = 'ACTIVE' | 'INACTIVE';\n\n\ttype Elevator = {\n\t\tid: number;\n\t\tstatus: ElevatorStatus;\n\t\tdesc: string;\n\t\toutOfService: [Date, Date][];\n\t};\n\n\tconst toLocation = (l: ApiLocation): Location => {\n\t\treturn {\n\t\t\tlat: l.match!.lat,\n\t\t\tlng: l.match!.lon,\n\t\t\tlevel: l.match!.level ?? 0\n\t\t};\n\t};\n\n\tconst getRoute = async (query: RoutingQuery) => {\n\t\treturn await post('/api/route', query);\n\t};\n\n\tconst getMatches = async (bounds: maplibregl.LngLatBounds) => {\n\t\treturn await post('/api/matches', bounds.toArray().flat());\n\t};\n\n\tconst getFlex = async (bounds: maplibregl.LngLatBounds) => {\n\t\tconst min = bounds.getSouthWest();\n\t\tconst max = bounds.getNorthEast();\n\t\treturn await get(`/api/debug/flex?min=${min.lat},${min.lng}&max=${max.lat},${max.lng}`);\n\t};\n\n\tconst getElevators = async (bounds: maplibregl.LngLatBounds) => {\n\t\treturn await post('/api/elevators', bounds.toArray().flat());\n\t};\n\n\tconst updateElevator = async (e: { id: number; status: ElevatorStatus }) => {\n\t\tconsole.log(JSON.stringify(e));\n\t\treturn await post('/api/update_elevator', e);\n\t};\n\n\texport const getGraph = async (bounds: maplibregl.LngLatBounds, level: number) => {\n\t\treturn await post('/api/graph', {\n\t\t\tlevel: level,\n\t\t\twaypoints: bounds.toArray().flat()\n\t\t});\n\t};\n\n\tlet {\n\t\tbounds,\n\t\tlevel,\n\t\tzoom\n\t}: {\n\t\tbounds: maplibregl.LngLatBoundsLike | undefined;\n\t\tlevel: number;\n\t\tzoom: number;\n\t} = $props();\n\n\tlet debug = $state(false);\n\tlet id = $state<string>();\n\tlet fps = $derived(\n\t\tid && bounds && debug ? transfers<false>({ query: { id } }).then((x) => x.data) : undefined\n\t);\n\tlet matches = $derived(\n\t\tbounds && debug && zoom > 15 ? getMatches(maplibregl.LngLatBounds.convert(bounds)) : undefined\n\t);\n\tlet flex = $derived(\n\t\tbounds && debug ? getFlex(maplibregl.LngLatBounds.convert(bounds)) : undefined\n\t);\n\n\tconst parseElevator = (e: { outOfService: string }) => {\n\t\treturn {\n\t\t\t...e,\n\t\t\toutOfService: JSON.parse(e.outOfService).map(([from, to]: [string, string]) => {\n\t\t\t\treturn [new Date(from), new Date(to)];\n\t\t\t})\n\t\t};\n\t};\n\n\tlet graph = $state<null | geojson.GeoJSON>(null);\n\tlet elevators = $state<null | geojson.GeoJSON>(null);\n\t$effect(() => {\n\t\tif (debug && bounds && zoom > 15) {\n\t\t\tgetGraph(maplibregl.LngLatBounds.convert(bounds), level).then((response: geojson.GeoJSON) => {\n\t\t\t\tgraph = response;\n\t\t\t});\n\t\t\tgetElevators(maplibregl.LngLatBounds.convert(bounds)).then((response: geojson.GeoJSON) => {\n\t\t\t\televators = response;\n\t\t\t});\n\t\t} else {\n\t\t\tgraph = null;\n\t\t}\n\t});\n\n\tlet profile = $state<string>();\n\tlet start = $state.raw<ApiLocation>();\n\tlet destination = $state.raw<ApiLocation>();\n\tlet route = $derived(\n\t\tstart?.match?.lat &&\n\t\t\tstart?.match.lon &&\n\t\t\tdestination?.match?.lat &&\n\t\t\tdestination?.match.lon &&\n\t\t\tprofile\n\t\t\t? getRoute({\n\t\t\t\t\tstart: toLocation(start),\n\t\t\t\t\tdestination: toLocation(destination),\n\t\t\t\t\tprofile,\n\t\t\t\t\tdirection: 'forward'\n\t\t\t\t})\n\t\t\t: undefined\n\t);\n\n\tlet elevatorUpdate = $state<Promise<Response> | null>(null);\n\tlet elevator = $state<Elevator | null>(null);\n</script>\n\n<Button\n\tsize=\"icon\"\n\tvariant={debug ? 'default' : 'outline'}\n\tonclick={() => {\n\t\tdebug = !debug;\n\t}}\n>\n\t<Bug size=\"icon\" class=\"h-[1.2rem] w-[1.2rem]\" />\n</Button>\n\n<!-- eslint-disable-next-line -->\n{#snippet propertiesTable(_1: maplibregl.MapMouseEvent, _2: () => void, features: any)}\n\t<Table>\n\t\t<TableBody>\n\t\t\t{#each Object.entries(features[0].properties) as [key, value], i (i)}\n\t\t\t\t<TableRow>\n\t\t\t\t\t<TableCell>{key}</TableCell>\n\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t{#if key === 'osm_node_id'}\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\thref=\"https://www.openstreetmap.org/node/{value}\"\n\t\t\t\t\t\t\t\tclass=\"underline bold text-blue-400\"\n\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{value}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t{:else if key === 'osm_way_id'}\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\thref=\"https://www.openstreetmap.org/way/{value}\"\n\t\t\t\t\t\t\t\tclass=\"underline bold text-blue-400\"\n\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{value}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t{value}\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</TableCell>\n\t\t\t\t</TableRow>\n\t\t\t{/each}\n\t\t</TableBody>\n\t</Table>\n{/snippet}\n\n{#if elevator}\n\t<Control position=\"bottom-right\">\n\t\t<Card.Root class=\"min-w-[550px] mb-4\">\n\t\t\t<div class=\"w-full flex justify-between bg-muted items-center\">\n\t\t\t\t<h2 class=\"text-lg ml-2 font-bold\">\n\t\t\t\t\tFahrstuhl {elevator.desc}\n\t\t\t\t\t<span class=\"ml-2 text-sm text-muted-foreground\">\n\t\t\t\t\t\t{elevator.id}\n\t\t\t\t\t</span>\n\t\t\t\t</h2>\n\t\t\t\t<Button variant=\"ghost\" onclick={() => (elevator = null)}>\n\t\t\t\t\t<X />\n\t\t\t\t</Button>\n\t\t\t</div>\n\n\t\t\t<Card.Content class=\"flex flex-col gap-6\">\n\t\t\t\t<Table>\n\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t<TableHead class=\"font-semibold\">Not available from</TableHead>\n\t\t\t\t\t\t\t<TableHead class=\"font-semibold\">to</TableHead>\n\t\t\t\t\t\t\t<TableHead></TableHead>\n\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t</TableHeader>\n\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t{#if elevator.outOfService}\n\t\t\t\t\t\t\t{#each elevator.outOfService as _, i (i)}\n\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t<DateInput bind:value={elevator.outOfService[i][0]} />\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t<DateInput bind:value={elevator.outOfService[i][1]} />\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t<Button variant=\"outline\" onclick={() => elevator!.outOfService!.splice(i, 1)}>\n\t\t\t\t\t\t\t\t\t\t\t<X />\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</TableBody>\n\t\t\t\t</Table>\n\n\t\t\t\t<div class=\"flex justify-between gap-4\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\tonclick={() => elevator!.outOfService.push([new Date(), new Date()])}\n\t\t\t\t\t>\n\t\t\t\t\t\tAdd Maintainance\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclass=\"w-48\"\n\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\televatorUpdate = updateElevator(elevator!);\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{#if elevatorUpdate != null}\n\t\t\t\t\t\t\t{#await elevatorUpdate}\n\t\t\t\t\t\t\t\t<LoaderCircle class=\"animate-spin w-4 h-4\" />\n\t\t\t\t\t\t\t{:then _}\n\t\t\t\t\t\t\t\tUpdate\n\t\t\t\t\t\t\t{/await}\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\tUpdate\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t<Button\n\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\televatorUpdate = updateElevator({\n\t\t\t\t\t\t\t\tid: elevator!.id,\n\t\t\t\t\t\t\t\tstatus: elevator!.status === 'ACTIVE' ? 'INACTIVE' : 'ACTIVE'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{#if elevator.status === 'ACTIVE'}\n\t\t\t\t\t\t\tDEACTIVATE\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\tACTIVATE\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</Card.Content>\n\t\t</Card.Root>\n\t</Control>\n{/if}\n\n{#if debug}\n\t{#if fps}\n\t\t{#await fps then f}\n\t\t\t{#if f}\n\t\t\t\t<Control position=\"bottom-right\">\n\t\t\t\t\t<Card.Root class=\"w-[600px] h-[500px] overflow-y-auto bg-background rounded-lg\">\n\t\t\t\t\t\t<div class=\"w-full flex justify-between items-center shadow-md pl-1 mb-1\">\n\t\t\t\t\t\t\t<h2 class=\"ml-2 text-base font-semibold\">\n\t\t\t\t\t\t\t\t{f.place.name}\n\t\t\t\t\t\t\t\t{f.place.track}\n\t\t\t\t\t\t\t\t<span class=\"text-xs text-muted-foreground font-mono\">\n\t\t\t\t\t\t\t\t\t{f.place.stopId}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"text-sm text-muted-foreground\">Level: {f.place.level}</span>\n\t\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\t\t\tid = undefined;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<X />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Table>\n\t\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t<TableHead class=\"text-center\">Station</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead class=\"text-center\">Default</TableHead>\n\t\t\t\t\t\t\t\t\t{#if f.hasFootTransfers}\n\t\t\t\t\t\t\t\t\t\t<TableHead class=\"text-center\">Foot</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead class=\"text-center\">Foot Routed</TableHead>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t{#if f.hasWheelchairTransfers}\n\t\t\t\t\t\t\t\t\t\t<TableHead class=\"text-center\">Wheelchair</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead class=\"text-center\">Wheelchair Routed</TableHead>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t{#if f.hasCarTransfers}\n\t\t\t\t\t\t\t\t\t\t<TableHead class=\"text-center\">Car</TableHead>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t\t{#each f.transfers as x, i (i)}\n\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t{x.to.name} <br />\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-xs text-muted-foreground font-mono\">\n\t\t\t\t\t\t\t\t\t\t\t\t{x.to.stopId}\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t{#if x.default !== undefined}\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstart = posToLocation(f.place, f.place.level);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdestination = posToLocation(x.to, x.to.level);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tprofile = 'foot';\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{x.default}\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t{#if f.hasFootTransfers}\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t{#if x.foot !== undefined}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstart = posToLocation(f.place, f.place.level);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdestination = posToLocation(x.to, x.to.level);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprofile = 'foot';\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{x.foot}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t{#if x.footRouted !== undefined}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstart = posToLocation(f.place, f.place.level);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdestination = posToLocation(x.to, x.to.level);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprofile = 'foot';\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{x.footRouted}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t{#if f.hasWheelchairTransfers}\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t{#if x.wheelchair !== undefined}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass={x.wheelchairUsesElevator ? 'text-red-500' : 'text-green-500'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstart = posToLocation(f.place, f.place.level);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdestination = posToLocation(x.to, x.to.level);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprofile = 'wheelchair';\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{x.wheelchair}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t{#if x.wheelchairRouted !== undefined}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass={x.wheelchairUsesElevator ? 'text-red-500' : 'text-green-500'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstart = posToLocation(f.place, f.place.level);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdestination = posToLocation(x.to, x.to.level);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprofile = 'wheelchair';\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{x.wheelchairRouted}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t{#if f.hasCarTransfers}\n\t\t\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t{#if x.car !== undefined}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstart = posToLocation(f.place, f.place.level);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdestination = posToLocation(x.to, x.to.level);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprofile = 'car';\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{x.car}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t\t</Table>\n\t\t\t\t\t</Card.Root>\n\t\t\t\t</Control>\n\t\t\t{/if}\n\t\t{/await}\n\t{/if}\n\n\t{#if matches}\n\t\t{#await matches then m}\n\t\t\t<GeoJSON id=\"matches\" data={m}>\n\t\t\t\t<Layer\n\t\t\t\t\tonclick={(e) => {\n\t\t\t\t\t\tconst props = e.features![0].properties;\n\t\t\t\t\t\tid = props.id;\n\t\t\t\t\t}}\n\t\t\t\t\tid=\"matches\"\n\t\t\t\t\ttype=\"circle\"\n\t\t\t\t\tfilter={['all', ['==', '$type', 'Point']]}\n\t\t\t\t\tlayout={{}}\n\t\t\t\t\tpaint={{\n\t\t\t\t\t\t'circle-color': ['match', ['get', 'type'], 'location', '#34ebde', '#fa921b'],\n\t\t\t\t\t\t'circle-radius': 5\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Popup trigger=\"click\" children={propertiesTable} />\n\t\t\t\t</Layer>\n\t\t\t\t<Layer\n\t\t\t\t\tid=\"match\"\n\t\t\t\t\ttype=\"line\"\n\t\t\t\t\tfilter={['all', ['==', 'type', 'match']]}\n\t\t\t\t\tlayout={{\n\t\t\t\t\t\t'line-join': 'round',\n\t\t\t\t\t\t'line-cap': 'round'\n\t\t\t\t\t}}\n\t\t\t\t\tpaint={{\n\t\t\t\t\t\t'line-color': '#00ff00',\n\t\t\t\t\t\t'line-width': 3\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Popup trigger=\"click\" children={propertiesTable} />\n\t\t\t\t</Layer>\n\t\t\t</GeoJSON>\n\t\t{/await}\n\t{/if}\n\n\t{#if flex}\n\t\t{#await flex then f}\n\t\t\t<GeoJSON id=\"flex\" data={f}>\n\t\t\t\t<Layer\n\t\t\t\t\tonclick={(e) => {\n\t\t\t\t\t\tconst props = e.features![0].properties;\n\t\t\t\t\t\tid = props.id;\n\t\t\t\t\t}}\n\t\t\t\t\tid=\"flex-location-groups\"\n\t\t\t\t\ttype=\"circle\"\n\t\t\t\t\tfilter={['all', ['==', '$type', 'Point']]}\n\t\t\t\t\tlayout={{}}\n\t\t\t\t\tpaint={{\n\t\t\t\t\t\t'circle-color': '#00ff00',\n\t\t\t\t\t\t'circle-radius': 5\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Popup trigger=\"click\" children={propertiesTable} />\n\t\t\t\t</Layer>\n\t\t\t\t<Layer\n\t\t\t\t\tid=\"flex-areas\"\n\t\t\t\t\ttype=\"fill\"\n\t\t\t\t\tlayout={{}}\n\t\t\t\t\tfilter={['literal', true]}\n\t\t\t\t\tpaint={{\n\t\t\t\t\t\t'fill-color': '#088',\n\t\t\t\t\t\t'fill-opacity': 0.4,\n\t\t\t\t\t\t'fill-outline-color': '#000'\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t\t<Layer\n\t\t\t\t\tid=\"flex-areas-outline\"\n\t\t\t\t\ttype=\"line\"\n\t\t\t\t\tlayout={{}}\n\t\t\t\t\tfilter={['literal', true]}\n\t\t\t\t\tpaint={{\n\t\t\t\t\t\t'line-color': '#000',\n\t\t\t\t\t\t'line-width': 2\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t\t<Layer\n\t\t\t\t\tid=\"flex-areas-labels\"\n\t\t\t\t\ttype=\"symbol\"\n\t\t\t\t\tlayout={{\n\t\t\t\t\t\t'symbol-placement': 'point',\n\t\t\t\t\t\t'text-field': ['get', 'name'],\n\t\t\t\t\t\t'text-font': ['Noto Sans Regular'],\n\t\t\t\t\t\t'text-size': 16\n\t\t\t\t\t}}\n\t\t\t\t\tfilter={['literal', true]}\n\t\t\t\t\tpaint={{\n\t\t\t\t\t\t'text-halo-width': 12,\n\t\t\t\t\t\t'text-halo-color': '#fff',\n\t\t\t\t\t\t'text-color': '#f00'\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</GeoJSON>\n\t\t{/await}\n\t{/if}\n\n\t{#if route}\n\t\t{#await route then r}\n\t\t\t{#if r.type == 'FeatureCollection'}\n\t\t\t\t<GeoJSON id=\"route\" data={r}>\n\t\t\t\t\t<Layer\n\t\t\t\t\t\tid=\"path-outline\"\n\t\t\t\t\t\ttype=\"line\"\n\t\t\t\t\t\tlayout={{\n\t\t\t\t\t\t\t'line-join': 'round',\n\t\t\t\t\t\t\t'line-cap': 'round'\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tfilter={['any', ['!has', 'level'], ['==', 'level', level]]}\n\t\t\t\t\t\tpaint={{\n\t\t\t\t\t\t\t'line-color': '#cfa900',\n\t\t\t\t\t\t\t'line-width': 7.5,\n\t\t\t\t\t\t\t'line-opacity': 0.8\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t\t<Layer\n\t\t\t\t\t\tid=\"path\"\n\t\t\t\t\t\ttype=\"line\"\n\t\t\t\t\t\tlayout={{\n\t\t\t\t\t\t\t'line-join': 'round',\n\t\t\t\t\t\t\t'line-cap': 'round'\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tfilter={['any', ['!has', 'level'], ['==', 'level', level]]}\n\t\t\t\t\t\tpaint={{\n\t\t\t\t\t\t\t'line-color': '#fccf03',\n\t\t\t\t\t\t\t'line-width': 5,\n\t\t\t\t\t\t\t'line-opacity': 0.8\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</GeoJSON>\n\t\t\t{/if}\n\t\t{/await}\n\t{/if}\n\n\t{#if graph != null}\n\t\t<GeoJSON id=\"graph\" data={graph}>\n\t\t\t<Layer\n\t\t\t\tid=\"graph-geometry\"\n\t\t\t\ttype=\"line\"\n\t\t\t\tfilter={[\n\t\t\t\t\t'all',\n\t\t\t\t\t['==', 'type', 'geometry'],\n\t\t\t\t\t['any', ['!has', 'level'], ['==', 'level', level]]\n\t\t\t\t]}\n\t\t\t\tlayout={{\n\t\t\t\t\t'line-join': 'round',\n\t\t\t\t\t'line-cap': 'round'\n\t\t\t\t}}\n\t\t\t\tpaint={{\n\t\t\t\t\t'line-color': '#e55e5e',\n\t\t\t\t\t'line-width': 3,\n\t\t\t\t\t'line-opacity': 1\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Popup trigger=\"click\" children={propertiesTable} />\n\t\t\t</Layer>\n\t\t\t<Layer\n\t\t\t\tid=\"graph-edge\"\n\t\t\t\ttype=\"line\"\n\t\t\t\tfilter={['all', ['==', 'type', 'edge'], ['any', ['!has', 'level'], ['==', 'level', level]]]}\n\t\t\t\tlayout={{\n\t\t\t\t\t'line-join': 'round',\n\t\t\t\t\t'line-cap': 'round'\n\t\t\t\t}}\n\t\t\t\tpaint={{\n\t\t\t\t\t'line-color': '#a300d9',\n\t\t\t\t\t'line-width': 3\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Popup trigger=\"click\" children={propertiesTable} />\n\t\t\t</Layer>\n\t\t\t<Layer\n\t\t\t\tid=\"graph-node\"\n\t\t\t\ttype=\"circle\"\n\t\t\t\tfilter={['all', ['==', '$type', 'Point']]}\n\t\t\t\tlayout={{}}\n\t\t\t\tpaint={{\n\t\t\t\t\t'circle-color': ['match', ['get', 'label'], 'unreachable', '#ff1150', '#11ffaf'],\n\t\t\t\t\t'circle-radius': 5\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Popup trigger=\"click\" children={propertiesTable} />\n\t\t\t</Layer>\n\t\t</GeoJSON>\n\t{/if}\n\n\t{#if elevators}\n\t\t<GeoJSON id=\"elevators\" data={elevators}>\n\t\t\t<Layer\n\t\t\t\tid=\"elevators\"\n\t\t\t\ttype=\"circle\"\n\t\t\t\tfilter={['all', ['==', '$type', 'Point']]}\n\t\t\t\tlayout={{}}\n\t\t\t\tpaint={{\n\t\t\t\t\t'circle-color': ['match', ['get', 'status'], 'ACTIVE', '#ffff00', '#ff00ff'],\n\t\t\t\t\t'circle-radius': 8\n\t\t\t\t}}\n\t\t\t\tonclick={(e) => {\n\t\t\t\t\t// @ts-expect-error type mismatch\n\t\t\t\t\televator = parseElevator(e.features![0].properties);\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<Layer\n\t\t\t\tid=\"elevators-match\"\n\t\t\t\ttype=\"line\"\n\t\t\t\tfilter={['all', ['==', 'type', 'match']]}\n\t\t\t\tlayout={{\n\t\t\t\t\t'line-join': 'round',\n\t\t\t\t\t'line-cap': 'round'\n\t\t\t\t}}\n\t\t\t\tpaint={{\n\t\t\t\t\t'line-color': '#00ff00',\n\t\t\t\t\t'line-width': 3\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Popup trigger=\"click\" children={propertiesTable} />\n\t\t\t</Layer>\n\t\t</GeoJSON>\n\t{/if}\n\n\t{#if start}\n\t\t<Marker color=\"magenta\" draggable={false} location={start} />\n\t{/if}\n\n\t{#if destination}\n\t\t<Marker color=\"yellow\" draggable={false} location={destination} />\n\t{/if}\n{/if}\n","import maplibregl from 'maplibre-gl';\n\nexport function lngLatToStr(pos: maplibregl.LngLatLike) {\n\tconst p = maplibregl.LngLat.convert(pos);\n\treturn `${p.lat},${p.lng}`;\n}\n","export const LEVEL_MIN_ZOOM = 17;\n","<script lang=\"ts\">\n\timport { Label } from '$lib/components/ui/label';\n\timport { RadioGroup, Item } from '$lib/components/ui/radio-group/index';\n\timport { lngLatToStr } from '$lib/lngLatToStr';\n\timport Control from '$lib/map/Control.svelte';\n\timport { levels } from '@motis-project/motis-client';\n\timport type { LngLatBoundsLike } from 'maplibre-gl';\n\timport maplibregl from 'maplibre-gl';\n\timport { LEVEL_MIN_ZOOM } from './constants';\n\n\tlet {\n\t\tbounds,\n\t\tzoom,\n\t\tlevel = $bindable()\n\t}: {\n\t\tbounds: LngLatBoundsLike | undefined;\n\t\tzoom: number | undefined;\n\t\tlevel: number;\n\t} = $props();\n\n\tlet value = $state('level-0');\n\tlet availableLevels: Array<string> = $state([]);\n\n\t$effect(() => {\n\t\tlevel = Number(value.substring('level-'.length));\n\t});\n\n\t$effect(() => {\n\t\tif (bounds && zoom && zoom > LEVEL_MIN_ZOOM) {\n\t\t\tconst b = maplibregl.LngLatBounds.convert(bounds);\n\t\t\tconst min = lngLatToStr(b.getNorthWest());\n\t\t\tconst max = lngLatToStr(b.getSouthEast());\n\t\t\tlevels<false>({ query: { min, max } }).then((x) => {\n\t\t\t\tavailableLevels =\n\t\t\t\t\tx.data\n\t\t\t\t\t\t?.filter((x) => {\n\t\t\t\t\t\t\treturn Number.isInteger(x);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.map((x) => String(x)) ?? [];\n\t\t\t});\n\t\t} else {\n\t\t\tavailableLevels = [];\n\t\t\tlevel = 0;\n\t\t}\n\t});\n</script>\n\n{#if availableLevels.length > 1}\n\t<Control position=\"top-right\" class=\"mb-5\">\n\t\t<RadioGroup class=\"flex flex-col items-end space-y-1\" bind:value>\n\t\t\t{#each availableLevels as l (l)}\n\t\t\t\t<Label\n\t\t\t\t\tfor={`level-${l}`}\n\t\t\t\t\tclass=\"inline-flex items-center justify-center font-bold rounded-md border-2 border-muted bg-popover h-9 w-9 hover:bg-accent hover:text-accent-foreground [&:has([data-state=checked])]:border-blue-600 hover:cursor-pointer\"\n\t\t\t\t>\n\t\t\t\t\t<Item value={`level-${l}`} id={`level-${l}`} class=\"sr-only\" aria-label={`level-${l}`} />\n\t\t\t\t\t{l}\n\t\t\t\t</Label>\n\t\t\t{/each}\n\t\t</RadioGroup>\n\t</Control>\n{/if}\n","<script lang=\"ts\">\n\timport { cn } from '$lib/utils.js';\n\timport { ChevronDown } from '@lucide/svelte';\n\timport { onMount, type Snippet } from 'svelte';\n\timport type { HTMLAttributes } from 'svelte/elements';\n\timport { restoreScroll, resetScroll } from './handleScroll';\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tshowMap = $bindable(),\n\t\tclass: className,\n\t\tchildren,\n\t\t...restProps\n\t}: {\n\t\tref?: HTMLDivElement | null;\n\t\tshowMap?: boolean;\n\t\tclass?: string;\n\t\tchildren?: Snippet;\n\t} & HTMLAttributes<HTMLDivElement> = $props();\n\n\tlet expanded = $state(true);\n\tconst maxTranslate = 0.7;\n\tconst minTranslate = 0;\n\tlet startY = 0;\n\tlet currentY = 0;\n\tlet isDragging = false;\n\tlet fromHandle = false;\n\tlet container: HTMLElement | null;\n\n\tonMount(() => {\n\t\tconst cleanup = restoreScroll(container!);\n\t\treturn cleanup;\n\t});\n\n\t$effect(() => resetScroll(container!));\n\n\tconst getScrollableElement = (element: Element): Element | null => {\n\t\twhile (element && element !== document.documentElement) {\n\t\t\tconst style = window.getComputedStyle(element);\n\t\t\tconst overflowY = style.overflowY;\n\t\t\tconst hasScrollableY =\n\t\t\t\toverflowY !== 'visible' &&\n\t\t\t\toverflowY !== 'hidden' &&\n\t\t\t\telement.scrollHeight > element.clientHeight;\n\n\t\t\tif (hasScrollableY) {\n\t\t\t\treturn element;\n\t\t\t}\n\n\t\t\telement = element.parentElement as HTMLElement;\n\t\t}\n\n\t\treturn null;\n\t};\n\n\tconst ontouchstart = (e: TouchEvent) => {\n\t\tconst target = !fromHandle ? (e.target as Element) : null;\n\t\tconst scrollableElement = target ? (getScrollableElement(target) as HTMLElement) : null;\n\t\tstartY = e.touches[0].clientY;\n\t\tisDragging = expanded ? (scrollableElement ? scrollableElement.scrollTop === 0 : true) : true;\n\t};\n\n\tconst ontouchmove = (e: TouchEvent) => {\n\t\tif (!isDragging) return;\n\t\tcurrentY = e.touches[0].clientY;\n\t\tconst delta = currentY - startY;\n\t\tconst baseTranslate = expanded ? 0 : window.innerHeight * maxTranslate;\n\t\tif ((expanded && delta < 0) || (!expanded && delta > 0)) return;\n\t\tshowMap = true;\n\t\tref!.style.transition = 'none';\n\t\tref!.style.transform = `translateY(${baseTranslate + delta}px)`;\n\t};\n\tconst ontouchend = (e: TouchEvent) => {\n\t\tif (!isDragging) return;\n\t\tisDragging = false;\n\t\tref!.style.transition = '';\n\t\tconst delta = e.changedTouches[0].clientY - startY;\n\t\tif ((70 < delta || (delta == 0 && fromHandle)) && expanded) {\n\t\t\tref!.style.transform = `translateY(${window.innerHeight * maxTranslate}px)`;\n\t\t\texpanded = false;\n\t\t} else if ((delta < -70 || (delta == 0 && fromHandle)) && !expanded) {\n\t\t\tref!.style.transform = `translateY(${minTranslate}px)`;\n\t\t\texpanded = true;\n\t\t} else {\n\t\t\tref!.style.transform = `translateY(${expanded ? minTranslate : window.innerHeight * maxTranslate}px)`;\n\t\t}\n\t\tfromHandle = false;\n\t};\n</script>\n\n<div\n\tbind:this={ref}\n\tclass={cn(\n\t\t'bg-card text-card-foreground rounded-xl pb-5 h-full border shadow max-w-full transition-transform duration-200 ease-out',\n\t\tclassName\n\t)}\n\t{...restProps}\n\t{ontouchstart}\n\t{ontouchmove}\n\t{ontouchend}\n>\n\t<div\n\t\tclass=\"mx-auto my-5 relative before:content-[''] before:absolute before:inset-[-20px] before:inset-x-[-50vw] flex items-center justify-center\"\n\t\tontouchstart={(e) => {\n\t\t\tfromHandle = true;\n\t\t\tshowMap = true;\n\t\t\tontouchstart(e);\n\t\t}}\n\t>\n\t\t<div\n\t\t\tclass=\"absolute transition-all duration-200\"\n\t\t\tclass:opacity-0={!expanded}\n\t\t\tclass:opacity-100={expanded}\n\t\t>\n\t\t\t<ChevronDown class=\"size-12 text-gray-300 scale-x-150\" strokeWidth={3.5} />\n\t\t</div>\n\t\t<div\n\t\t\tclass=\"w-14 h-2 bg-gray-300 rounded-full transition-all duration-200\"\n\t\t\tclass:opacity-0={expanded}\n\t\t\tclass:opacity-100={!expanded}\n\t\t></div>\n\t</div>\n\n\t<div bind:this={container} class:overflow-auto={expanded}>\n\t\t{@render children?.()}\n\t</div>\n</div>\n","<script lang=\"ts\">\n\timport {\n\t\tstoptimes,\n\t\ttype StoptimesError,\n\t\ttype StoptimesResponse\n\t} from '@motis-project/motis-client';\n\timport { LoaderCircle, ArrowRight, CircleX } from '@lucide/svelte';\n\timport ErrorMessage from '$lib/ErrorMessage.svelte';\n\timport Time from '$lib/Time.svelte';\n\timport Route from '$lib/Route.svelte';\n\timport { Button } from '$lib/components/ui/button';\n\timport { language, t } from '$lib/i18n/translation';\n\timport type { RequestResult } from '@hey-api/client-fetch';\n\timport { onClickStop, onClickTrip } from '$lib/utils';\n\timport { getModeLabel } from './map/getModeLabel';\n\timport { posToLocation } from './Location';\n\timport type { Location } from './Location';\n\timport maplibregl from 'maplibre-gl';\n\timport Alerts from './Alerts.svelte';\n\n\tlet {\n\t\tstopId,\n\t\tstopName,\n\t\ttime: queryTime,\n\t\tstopNameFromResponse = $bindable(),\n\t\tstop = $bindable(),\n\t\tstopMarker = $bindable(),\n\t\tarriveBy\n\t}: {\n\t\tstopId: string;\n\t\tstopName: string;\n\t\ttime: Date;\n\t\tarriveBy?: boolean;\n\t\tstopNameFromResponse: string;\n\t\tstop: Location | undefined;\n\t\tstopMarker: maplibregl.Marker | undefined;\n\t} = $props();\n\n\tlet query = $derived({\n\t\tstopId,\n\t\ttime: queryTime.toISOString(),\n\t\tarriveBy,\n\t\tn: 10,\n\t\texactRadius: false,\n\t\tradius: 200,\n\t\tlanguage: [language]\n\t});\n\t/* eslint-disable svelte/prefer-writable-derived */\n\tlet responses = $state<Array<Promise<StoptimesResponse>>>([]);\n\t$effect(() => {\n\t\tresponses = [throwOnError(stoptimes({ query }))];\n\t});\n\t/* eslint-enable svelte/prefer-writable-derived */\n\n\tconst throwOnError = (promise: RequestResult<StoptimesResponse, StoptimesError, false>) =>\n\t\tpromise.then((response) => {\n\t\t\tif (response.error) {\n\t\t\t\tconsole.log(response.error);\n\t\t\t\tthrow { error: response.error.error, status: response.response.status };\n\t\t\t}\n\t\t\tstopNameFromResponse = response.data?.place?.name || '';\n\t\t\tlet placeFromResponse = response.data?.place;\n\t\t\tstop = posToLocation(\n\t\t\t\tmaplibregl.LngLat.convert([placeFromResponse.lon, placeFromResponse.lat])\n\t\t\t);\n\t\t\tstopMarker?.setLngLat(stop.match!);\n\t\t\treturn response.data!;\n\t\t});\n</script>\n\n<div class=\"gap-y-3 mb-1 text-base grid grid-cols-[auto_1fr] items-start content-start\">\n\t<div class=\"col-span-full w-full flex items-center justify-center\">\n\t\t<Button\n\t\t\tclass=\"font-bold\"\n\t\t\tvariant=\"outline\"\n\t\t\tonclick={() => {\n\t\t\t\tonClickStop(stopName, stopId, queryTime, !arriveBy);\n\t\t\t}}\n\t\t>\n\t\t\t{#if arriveBy}\n\t\t\t\t{t.switchToDepartures}\n\t\t\t{:else}\n\t\t\t\t{t.switchToArrivals}\n\t\t\t{/if}\n\t\t</Button>\n\t</div>\n\t{#each responses as r, rI (rI)}\n\t\t{#await r}\n\t\t\t<div class=\"flex items-center justify-center\">\n\t\t\t\t<LoaderCircle class=\"animate-spin w-12 h-12 m-20\" />\n\t\t\t</div>\n\t\t{:then r}\n\t\t\t{#if rI === 0 && r.previousPageCursor.length}\n\t\t\t\t<div class=\"col-span-full w-full flex justify-between items-center space-x-4\">\n\t\t\t\t\t<div class=\"border-t w-full h-0\"></div>\n\t\t\t\t\t<button\n\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\tresponses.splice(\n\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\tthrowOnError(stoptimes({ query: { ...query, pageCursor: r.previousPageCursor } }))\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclass=\"px-2 py-1 bg-blue-600 hover:!bg-blue-700 text-white font-bold text-sm border rounded-lg text-nowrap\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{t.earlier}\n\t\t\t\t\t</button>\n\t\t\t\t\t<div class=\"border-t w-full h-0\"></div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t\t{#each r.stopTimes as stopTime, i (i)}\n\t\t\t\t{@const timestamp = arriveBy ? stopTime.place.arrival! : stopTime.place.departure!}\n\t\t\t\t{@const scheduledTimestamp = arriveBy\n\t\t\t\t\t? stopTime.place.scheduledArrival!\n\t\t\t\t\t: stopTime.place.scheduledDeparture!}\n\t\t\t\t<div class=\"\">\n\t\t\t\t\t<div class=\"flex col justify-between\">\n\t\t\t\t\t\t<Route class=\"max-w-30 text-ellipsis overflow-hidden\" l={stopTime} {onClickTrip} />\n\t\t\t\t\t\t<div class=\"mx-4\">\n\t\t\t\t\t\t\t<Time\n\t\t\t\t\t\t\t\tvariant=\"schedule\"\n\t\t\t\t\t\t\t\ttimeZone={stopTime.place.tz}\n\t\t\t\t\t\t\t\tisRealtime={stopTime.realTime}\n\t\t\t\t\t\t\t\t{timestamp}\n\t\t\t\t\t\t\t\t{scheduledTimestamp}\n\t\t\t\t\t\t\t\tqueriedTime={queryTime.toISOString()}\n\t\t\t\t\t\t\t\t{arriveBy}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Time\n\t\t\t\t\t\t\t\tvariant=\"realtime\"\n\t\t\t\t\t\t\t\ttimeZone={stopTime.place.tz}\n\t\t\t\t\t\t\t\tisRealtime={stopTime.realTime}\n\t\t\t\t\t\t\t\t{timestamp}\n\t\t\t\t\t\t\t\t{scheduledTimestamp}\n\t\t\t\t\t\t\t\t{arriveBy}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"w-full\">\n\t\t\t\t\t<div class=\"flex items-start justify-between text-base\">\n\t\t\t\t\t\t<div class=\"flex items-start gap-1\">\n\t\t\t\t\t\t\t<ArrowRight class=\"mt-1 shrink-0 stroke-muted-foreground h-4 w-4\" />\n\t\t\t\t\t\t\t{stopTime.headsign}\n\t\t\t\t\t\t\t{#if !stopTime.headsign || !stopTime.tripTo.name.startsWith(stopTime.headsign)}\n\t\t\t\t\t\t\t\t({stopTime.tripTo.name})\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{#if stopTime.place.track}\n\t\t\t\t\t\t\t<span class=\"mt-1 text-nowrap px-1 border text-xs rounded-xl\">\n\t\t\t\t\t\t\t\t{getModeLabel(stopTime.mode) == 'Track' ? t.trackAbr : t.platformAbr}\n\t\t\t\t\t\t\t\t{stopTime.place.track}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t<Alerts tz={stopTime.place.tz} alerts={stopTime.place.alerts} />\n\t\t\t\t\t</div>\n\t\t\t\t\t{#if stopTime.pickupDropoffType == 'NOT_ALLOWED'}\n\t\t\t\t\t\t<div class=\"flex items-center text-destructive text-sm\">\n\t\t\t\t\t\t\t<CircleX class=\"stroke-destructive h-4 w-4\" />\n\t\t\t\t\t\t\t<span class=\"ml-1 leading-none\">\n\t\t\t\t\t\t\t\t{stopTime.tripCancelled\n\t\t\t\t\t\t\t\t\t? t.tripCancelled\n\t\t\t\t\t\t\t\t\t: stopTime.cancelled\n\t\t\t\t\t\t\t\t\t\t? t.stopCancelled\n\t\t\t\t\t\t\t\t\t\t: arriveBy\n\t\t\t\t\t\t\t\t\t\t\t? t.outDisallowed\n\t\t\t\t\t\t\t\t\t\t\t: t.inDisallowed}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"border col-span-full\"></div>\n\t\t\t{/each}\n\t\t\t{#if !r.stopTimes.length}\n\t\t\t\t<div class=\"col-span-full w-full flex items-center justify-center\">\n\t\t\t\t\t<ErrorMessage message={t.noItinerariesFound} status={404} />\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t{#if rI === responses.length - 1 && r.nextPageCursor.length}\n\t\t\t\t<div class=\"col-span-full w-full flex justify-between items-center space-x-4\">\n\t\t\t\t\t<div class=\"border-t w-full h-0\"></div>\n\t\t\t\t\t<button\n\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\tresponses.push(\n\t\t\t\t\t\t\t\tthrowOnError(stoptimes({ query: { ...query, pageCursor: r.nextPageCursor } }))\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclass=\"px-2 py-1 bg-blue-600 hover:!bg-blue-700 text-white text-sm font-bold border rounded-lg text-nowrap\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{t.later}\n\t\t\t\t\t</button>\n\t\t\t\t\t<div class=\"border-t w-full h-0\"></div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t{:catch e}\n\t\t\t<div class=\"col-span-full w-full flex items-center justify-center\">\n\t\t\t\t<ErrorMessage message={e.error} status={e.status} />\n\t\t\t</div>\n\t\t{/await}\n\t{/each}\n</div>\n","<script lang=\"ts\">\n\timport { Tabs as TabsPrimitive } from \"bits-ui\";\n\timport { cn } from \"$lib/utils.js\";\n\n\ttype $$Props = TabsPrimitive.ContentProps;\n\n\tlet className: $$Props[\"class\"] = undefined;\n\texport let value: $$Props[\"value\"];\n\texport { className as class };\n</script>\n\n<TabsPrimitive.Content\n\tclass={cn(\n\t\t\"ring-offset-background focus-visible:ring-ring mt-2 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2\",\n\t\tclassName\n\t)}\n\t{value}\n\t{...$$restProps}\n>\n\t<slot />\n</TabsPrimitive.Content>","<script lang=\"ts\">\n\timport { Tabs as TabsPrimitive } from \"bits-ui\";\n\timport { cn } from \"$lib/utils.js\";\n\n\ttype $$Props = TabsPrimitive.ListProps;\n\n\tlet className: $$Props[\"class\"] = undefined;\n\texport { className as class };\n</script>\n\n<TabsPrimitive.List\n\tclass={cn(\n\t\t\"bg-muted text-muted-foreground inline-flex h-10 items-center justify-center rounded-md p-1\",\n\t\tclassName\n\t)}\n\t{...$$restProps}\n>\n\t<slot />\n</TabsPrimitive.List>","<script lang=\"ts\">\n\timport { Tabs as TabsPrimitive } from 'bits-ui';\n\timport { cn } from '$lib/utils.js';\n\n\tlet {\n\t\tref = $bindable(null),\n\t\tclass: className,\n\t\tvalue = $bindable(),\n\t\t...restProps\n\t}: TabsPrimitive.TriggerProps = $props();\n\n\texport { className as class };\n</script>\n\n<TabsPrimitive.Trigger\n\tclass={cn(\n\t\t'ring-offset-background focus-visible:ring-ring data-[state=active]:bg-background data-[state=active]:text-foreground inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm',\n\t\tclassName\n\t)}\n\t{value}\n\t{...restProps}\n/>\n","import { Tabs as TabsPrimitive } from \"bits-ui\";\nimport Content from \"./tabs-content.svelte\";\nimport List from \"./tabs-list.svelte\";\nimport Trigger from \"./tabs-trigger.svelte\";\n\nconst Root = TabsPrimitive.Root;\n\nexport {\n\tRoot,\n\tContent,\n\tList,\n\tTrigger,\n\t//\n\tRoot as Tabs,\n\tContent as TabsContent,\n\tList as TabsList,\n\tTrigger as TabsTrigger,\n};","<script lang=\"ts\">\n\timport AddressTypeahead from '$lib/AddressTypeahead.svelte';\n\timport { type Location } from '$lib/Location';\n\timport { t } from '$lib/i18n/translation';\n\timport { onClickStop } from '$lib/utils';\n\n\tlet {\n\t\ttime = $bindable()\n\t}: {\n\t\ttime: Date;\n\t} = $props();\n\n\tlet from = $state<Location>() as Location;\n\tlet fromItems = $state<Array<Location>>([]);\n</script>\n\n<div id=\"searchmask-container\" class=\"flex flex-col space-y-4 p-4 relative\">\n\t<AddressTypeahead\n\t\tname=\"from\"\n\t\tplaceholder={t.from}\n\t\tbind:selected={from}\n\t\tbind:items={fromItems}\n\t\ttype=\"STOP\"\n\t\tonChange={(location) => {\n\t\t\tif (location.match) {\n\t\t\t\tonClickStop(location.label, location.match.id, time);\n\t\t\t}\n\t\t}}\n\t/>\n</div>\n","import type { Feature, GeoJsonProperties, MultiPolygon, Polygon } from 'geojson';\nconst DisplayLevels = ['NONE', 'OVERLAY_RECTS', 'OVERLAY_CIRCLES', 'GEOMETRY_CIRCLES'] as const;\n\nexport type DisplayLevel = (typeof DisplayLevels)[number];\nexport type StatusLevel = 'WORKING' | 'DONE' | 'EMPTY' | 'FAILED';\nexport type Geometry = Feature<Polygon | MultiPolygon, GeoJsonProperties>;\n\nexport interface IsochronesOptions {\n\tdisplayLevel: DisplayLevel;\n\tcolor: string;\n\topacity: number;\n\tstatus: StatusLevel;\n\terrorMessage: string | undefined;\n\terrorCode: number | undefined;\n}\nexport interface IsochronesPos {\n\tlat: number;\n\tlng: number;\n\tseconds: number;\n}\n\nexport const isLess = (a: DisplayLevel, b: DisplayLevel) =>\n\tDisplayLevels.indexOf(a) < DisplayLevels.indexOf(b);\nexport const minDisplayLevel = (a: DisplayLevel, b: DisplayLevel) => (isLess(a, b) ? a : b);\n\nexport const isCanvasLevel = (a: DisplayLevel) => a == 'OVERLAY_RECTS' || a == 'OVERLAY_CIRCLES';\n","<script lang=\"ts\">\n\timport { onMount } from 'svelte';\n\timport maplibregl from 'maplibre-gl';\n\timport type { CanvasSource, GeoJSONSource, LngLatBoundsLike, Map } from 'maplibre-gl';\n\timport type { GeoJSON } from 'geojson';\n\timport type { PrePostDirectMode } from '$lib/Modes';\n\timport {\n\t\tisCanvasLevel,\n\t\tisLess,\n\t\tminDisplayLevel,\n\t\ttype DisplayLevel,\n\t\ttype IsochronesOptions,\n\t\ttype IsochronesPos\n\t} from '$lib/map/IsochronesShared';\n\timport type { WorkerMessage } from '$lib/map/IsochronesWorker';\n\timport WebWorker from '$lib/map/IsochronesWorker.ts?worker';\n\n\ttype BoxCoordsType = [[number, number], [number, number], [number, number], [number, number]];\n\n\tlet {\n\t\tmap,\n\t\tbounds,\n\t\tisochronesData,\n\t\tstreetModes,\n\t\twheelchair,\n\t\tmaxAllTime,\n\t\tcircleResolution,\n\t\tactive,\n\t\toptions = $bindable()\n\t}: {\n\t\tmap: Map | undefined;\n\t\tbounds: LngLatBoundsLike | undefined;\n\t\tisochronesData: IsochronesPos[];\n\t\tstreetModes: PrePostDirectMode[];\n\t\twheelchair: boolean;\n\t\tmaxAllTime: number;\n\t\tcircleResolution: number | undefined;\n\t\tactive: boolean;\n\t\toptions: IsochronesOptions;\n\t} = $props();\n\n\tconst emptyGeometry: GeoJSON = { type: 'LineString', coordinates: [] };\n\t// Must all exist\n\tlet objects = $state<\n\t\t| {\n\t\t\t\tworker: Worker;\n\t\t\t\tcanvasLayer: 'isochrones-canvas';\n\t\t\t\tcirclesLayer: 'isochrones-circles';\n\t\t\t\tcanvasSource: CanvasSource;\n\t\t\t\tcirclesSource: GeoJSONSource;\n\t\t  }\n\t\t| undefined\n\t>(undefined);\n\tlet bestAvailableDisplayLevel = $state<DisplayLevel>('NONE');\n\n\tconst kilometersPerSecond = $derived(\n\t\t// Should match the speed used for routing\n\t\tstreetModes.includes('BIKE')\n\t\t\t? 0.0038 // 3.8 meters per second\n\t\t\t: wheelchair\n\t\t\t\t? 0.0008 // 0.8 meters per second\n\t\t\t\t: 0.0012 // 1.2 meters per second\n\t);\n\tconst boundingBox = $derived(\n\t\tmaplibregl.LngLatBounds.convert(\n\t\t\tbounds ?? [\n\t\t\t\t[0, 0],\n\t\t\t\t[1, 1]\n\t\t\t]\n\t\t)\n\t);\n\tconst boxCoords: BoxCoordsType = $derived([\n\t\t[boundingBox._sw.lng, boundingBox._ne.lat],\n\t\t[boundingBox._ne.lng, boundingBox._ne.lat],\n\t\t[boundingBox._ne.lng, boundingBox._sw.lat],\n\t\t[boundingBox._sw.lng, boundingBox._sw.lat]\n\t]);\n\n\tlet lastData: IsochronesPos[] = [];\n\tlet lastMaxAllTime: number = 0;\n\tlet lastSpeed: number = 0;\n\tlet dataIndex = 0;\n\n\tonMount(() => {\n\t\tlastMaxAllTime = maxAllTime;\n\t\tlastSpeed = kilometersPerSecond;\n\t});\n\n\t// Setup objects\n\t$effect(() => {\n\t\tif (!map || !active || objects !== undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Create sources, layers and canvases\n\t\tconst canvasLayer = 'isochrones-canvas';\n\t\tconst circlesLayer = 'isochrones-circles';\n\n\t\tlet canvas = document.createElement('canvas');\n\t\tif (canvas === undefined) {\n\t\t\tconsole.log('Canvas not supported');\n\t\t\treturn;\n\t\t}\n\t\tlet offscreenCanvas = canvas.transferControlToOffscreen();\n\n\t\tmap.addSource(canvasLayer, {\n\t\t\ttype: 'canvas',\n\t\t\tcanvas,\n\t\t\tcoordinates: boxCoords\n\t\t});\n\t\tmap.addLayer({\n\t\t\tid: canvasLayer,\n\t\t\ttype: 'raster',\n\t\t\tsource: canvasLayer,\n\t\t\tpaint: {\n\t\t\t\t'raster-opacity': options.opacity / 1000\n\t\t\t}\n\t\t});\n\t\tconst canvasSource = map.getSource(canvasLayer) as CanvasSource;\n\n\t\tmap.addSource(circlesLayer, {\n\t\t\ttype: 'geojson',\n\t\t\tdata: emptyGeometry\n\t\t});\n\t\tmap.addLayer({\n\t\t\tid: circlesLayer,\n\t\t\ttype: 'fill',\n\t\t\tsource: circlesLayer,\n\t\t\tpaint: {\n\t\t\t\t'fill-color': options.color,\n\t\t\t\t'fill-opacity': options.opacity / 1000\n\t\t\t}\n\t\t});\n\t\tconst circlesSource = map.getSource(circlesLayer) as GeoJSONSource;\n\n\t\t// Setup worker\n\t\tconst worker = new WebWorker();\n\n\t\tworker.onmessage = (event: { data: WorkerMessage }) => {\n\t\t\tconst method = event.data.method;\n\t\t\tswitch (method) {\n\t\t\t\tcase 'update-display-level':\n\t\t\t\t\t{\n\t\t\t\t\t\tconst index = event.data.index;\n\t\t\t\t\t\tif (index < dataIndex) {\n\t\t\t\t\t\t\tconsole.log(`Got stale index from worker (Got ${index}, expected ${dataIndex})`);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst level: DisplayLevel = event.data.level;\n\t\t\t\t\t\tif (level == 'GEOMETRY_CIRCLES' && objects) {\n\t\t\t\t\t\t\tobjects.circlesSource.setData(event.data.geometry ?? emptyGeometry);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (isLess(bestAvailableDisplayLevel, level)) {\n\t\t\t\t\t\t\tbestAvailableDisplayLevel = level;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.log(`Unknown method '${method}'`);\n\t\t\t}\n\t\t};\n\n\t\tworker.postMessage(\n\t\t\t{\n\t\t\t\tmethod: 'set-canvas',\n\t\t\t\tcanvas: offscreenCanvas\n\t\t\t},\n\t\t\t[offscreenCanvas]\n\t\t);\n\n\t\t// Store references\n\t\tobjects = {\n\t\t\tworker,\n\t\t\tcanvasLayer,\n\t\t\tcirclesLayer,\n\t\t\tcanvasSource,\n\t\t\tcirclesSource\n\t\t};\n\t});\n\n\t$effect(() => {\n\t\tif (!active || options.status == 'FAILED' || objects === undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\t// isochronesData and lastData might both be empty, but have different references\n\t\tif (\n\t\t\t((lastData.length != 0 || isochronesData.length != 0) && lastData != isochronesData) ||\n\t\t\tlastMaxAllTime != maxAllTime ||\n\t\t\tlastSpeed != kilometersPerSecond\n\t\t) {\n\t\t\tobjects.worker.postMessage({\n\t\t\t\tmethod: 'update-data',\n\t\t\t\tindex: ++dataIndex,\n\t\t\t\tdata: $state.snapshot(isochronesData),\n\t\t\t\tkilometersPerSecond: $state.snapshot(kilometersPerSecond),\n\t\t\t\tmaxSeconds: $state.snapshot(maxAllTime),\n\t\t\t\tcircleResolution\n\t\t\t});\n\n\t\t\tlastData = isochronesData;\n\t\t\tlastMaxAllTime = maxAllTime;\n\t\t\tlastSpeed = kilometersPerSecond;\n\n\t\t\tbestAvailableDisplayLevel = 'NONE';\n\t\t\tobjects.circlesSource.setData(emptyGeometry);\n\t\t}\n\n\t\tobjects.worker.postMessage({\n\t\t\tmethod: 'set-max-display-level',\n\t\t\tdisplayLevel: options.displayLevel\n\t\t});\n\t});\n\n\t$effect(() => {\n\t\tif (!map || objects === undefined) {\n\t\t\treturn;\n\t\t}\n\t\tmap.setLayoutProperty(\n\t\t\tobjects.canvasLayer,\n\t\t\t'visibility',\n\t\t\tactive && isCanvasLevel(currentDisplayLevel) ? 'visible' : 'none'\n\t\t);\n\t\tmap.setLayoutProperty(\n\t\t\tobjects.circlesLayer,\n\t\t\t'visibility',\n\t\t\tactive && currentDisplayLevel == 'GEOMETRY_CIRCLES' ? 'visible' : 'none'\n\t\t);\n\t});\n\n\t$effect(() => {\n\t\tif (!map || objects === undefined) {\n\t\t\treturn;\n\t\t}\n\t\tmap.setPaintProperty(objects.canvasLayer, 'raster-opacity', options.opacity / 1000);\n\t\tmap.setPaintProperty(objects.circlesLayer, 'fill-opacity', options.opacity / 1000);\n\t});\n\n\t$effect(() => {\n\t\tif (!map || objects === undefined) {\n\t\t\treturn;\n\t\t}\n\t\tmap.setPaintProperty(objects.circlesLayer, 'fill-color', options.color);\n\t});\n\n\tlet currentDisplayLevel = $derived.by<DisplayLevel>(() => {\n\t\tif (!map || !active || objects === undefined) {\n\t\t\treturn 'NONE';\n\t\t}\n\n\t\tconst nextLevel = minDisplayLevel(options.displayLevel, bestAvailableDisplayLevel);\n\n\t\tif (isCanvasLevel(nextLevel)) {\n\t\t\tobjects.canvasSource.setCoordinates(boxCoords);\n\n\t\t\tconst dimensions = map._containerDimensions();\n\n\t\t\tobjects.worker.postMessage({\n\t\t\t\tmethod: 'render-canvas',\n\t\t\t\tlevel: nextLevel,\n\t\t\t\tboundingBox: $state.snapshot(boundingBox),\n\t\t\t\tdimensions,\n\t\t\t\tcolor: options.color\n\t\t\t});\n\t\t}\n\n\t\treturn nextLevel;\n\t});\n\t$effect(() => {\n\t\toptions.status =\n\t\t\tisochronesData.length == 0\n\t\t\t\t? 'EMPTY'\n\t\t\t\t: currentDisplayLevel == 'NONE' || currentDisplayLevel == options.displayLevel\n\t\t\t\t\t? 'DONE'\n\t\t\t\t\t: 'WORKING';\n\t});\n</script>\n","<script lang=\"ts\">\n\timport { t } from '$lib/i18n/translation';\n\timport { LoaderCircle } from '@lucide/svelte';\n\timport ErrorMessage from '$lib/ErrorMessage.svelte';\n\timport type { IsochronesOptions } from '$lib/map/IsochronesShared';\n\n\tlet {\n\t\toptions\n\t}: {\n\t\toptions: IsochronesOptions;\n\t} = $props();\n</script>\n\n<div>\n\t{#if options.status == 'WORKING'}\n\t\t<div class=\"flex items-center justify-center w-full\">\n\t\t\t<LoaderCircle class=\"animate-spin w-12 h-12 m-4\" />\n\t\t</div>\n\t{/if}\n\t{#if options.status == 'EMPTY'}\n\t\t<ErrorMessage message={t.isochrones.noData} status={404} />\n\t{/if}\n\t{#if options.status == 'FAILED'}\n\t\t<ErrorMessage message={options.errorMessage!} status={options.errorCode} />\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\timport { t } from '$lib/i18n/translation';\n\timport { Slider } from 'bits-ui';\n\timport { LocateFixed } from '@lucide/svelte';\n\timport maplibregl from 'maplibre-gl';\n\timport * as RadioGroup from '$lib/components/ui/radio-group';\n\timport Button from '$lib/components/ui/button/button.svelte';\n\timport { Label } from '$lib/components/ui/label';\n\timport {\n\t\ttype ElevationCosts,\n\t\ttype PedestrianProfile,\n\t\ttype ServerConfig\n\t} from '@motis-project/motis-client';\n\timport * as Select from '$lib/components/ui/select';\n\timport type { DisplayLevel, IsochronesOptions } from '$lib/map/IsochronesShared';\n\timport AddressTypeahead from '$lib/AddressTypeahead.svelte';\n\timport AdvancedOptions from '$lib/AdvancedOptions.svelte';\n\timport DateInput from '$lib/DateInput.svelte';\n\timport { posToLocation, type Location } from '$lib/Location';\n\timport { formatDurationSec } from '$lib/formatDuration';\n\timport type { PrePostDirectMode, TransitMode } from '$lib/Modes';\n\timport { generateTimes } from './generateTimes';\n\n\tlet {\n\t\tone = $bindable(),\n\t\tmaxTravelTime = $bindable(),\n\t\tserverConfig,\n\t\tgeocodingBiasPlace,\n\t\ttime = $bindable(),\n\t\tuseRoutedTransfers = $bindable(),\n\t\tpedestrianProfile = $bindable(),\n\t\trequireBikeTransport = $bindable(),\n\t\trequireCarTransport = $bindable(),\n\t\ttransitModes = $bindable(),\n\t\tmaxTransfers = $bindable(),\n\t\tpreTransitModes = $bindable(),\n\t\tpostTransitModes = $bindable(),\n\t\tmaxPreTransitTime = $bindable(),\n\t\tmaxPostTransitTime = $bindable(),\n\t\tarriveBy = $bindable(),\n\t\televationCosts = $bindable(),\n\t\tignorePreTransitRentalReturnConstraints = $bindable(),\n\t\tignorePostTransitRentalReturnConstraints = $bindable(),\n\t\toptions = $bindable(),\n\t\tpreTransitProviderGroups = $bindable(),\n\t\tpostTransitProviderGroups = $bindable(),\n\t\tdirectProviderGroups = $bindable()\n\t}: {\n\t\tone: Location;\n\t\tmaxTravelTime: number;\n\t\tserverConfig: ServerConfig | undefined;\n\t\tgeocodingBiasPlace?: maplibregl.LngLatLike;\n\t\ttime: Date;\n\t\tuseRoutedTransfers: boolean;\n\t\tpedestrianProfile: PedestrianProfile;\n\t\trequireBikeTransport: boolean;\n\t\trequireCarTransport: boolean;\n\t\ttransitModes: TransitMode[];\n\t\tmaxTransfers: number;\n\t\tpreTransitModes: PrePostDirectMode[];\n\t\tpostTransitModes: PrePostDirectMode[];\n\t\tmaxPreTransitTime: number;\n\t\tmaxPostTransitTime: number;\n\t\tarriveBy: boolean;\n\t\televationCosts: ElevationCosts;\n\t\tignorePreTransitRentalReturnConstraints: boolean;\n\t\tignorePostTransitRentalReturnConstraints: boolean;\n\t\toptions: IsochronesOptions;\n\t\tpreTransitProviderGroups: string[];\n\t\tpostTransitProviderGroups: string[];\n\t\tdirectProviderGroups: string[];\n\t} = $props();\n\tconst minutesToSeconds = (n: number): number => n * 60;\n\tconst possibleMaxTravelTimes = $derived(\n\t\tgenerateTimes(\n\t\t\tminutesToSeconds(Math.min(serverConfig?.maxOneToAllTravelTimeLimit ?? 4 * 60, 6 * 60))\n\t\t).map((s) => ({\n\t\t\tvalue: s.toString(),\n\t\t\tlabel: formatDurationSec(s)\n\t\t}))\n\t);\n\n\tconst displayLevels = new Map<DisplayLevel, string>([\n\t\t['OVERLAY_RECTS', t.isochrones.canvasRects],\n\t\t['OVERLAY_CIRCLES', t.isochrones.canvasCircles],\n\t\t['GEOMETRY_CIRCLES', t.isochrones.geojsonCircles]\n\t]);\n\tconst possibleDisplayLevels = [\n\t\t...[...displayLevels.entries()].map(([id, label]) => ({ value: id, label: label }))\n\t];\n\n\tlet oneItems = $state<Array<Location>>([]);\n\n\tlet lastSearchDir = arriveBy ? 'arrival' : 'departure';\n\n\tconst getLocation = () => {\n\t\tif (navigator && navigator.geolocation) {\n\t\t\tnavigator.geolocation.getCurrentPosition(applyPosition, (e) => console.log(e), {\n\t\t\t\tenableHighAccuracy: true\n\t\t\t});\n\t\t}\n\t};\n\tconst swapPrePostData = (searchDir: string) => {\n\t\tif (searchDir != lastSearchDir) {\n\t\t\tconst tmpModes = preTransitModes;\n\t\t\tpreTransitModes = postTransitModes;\n\t\t\tpostTransitModes = tmpModes;\n\t\t\tconst tmpTime = maxPreTransitTime;\n\t\t\tmaxPreTransitTime = maxPostTransitTime;\n\t\t\tmaxPostTransitTime = tmpTime;\n\t\t\tconst tmpProviderGroups = preTransitProviderGroups;\n\t\t\tpreTransitProviderGroups = postTransitProviderGroups;\n\t\t\tpostTransitProviderGroups = tmpProviderGroups;\n\t\t\tlastSearchDir = searchDir;\n\t\t}\n\t};\n\n\tconst applyPosition = (position: { coords: { latitude: number; longitude: number } }) => {\n\t\tone = posToLocation({ lat: position.coords.latitude, lon: position.coords.longitude }, 0);\n\t};\n</script>\n\n{#snippet additionalComponents()}\n\t<div class=\"grid grid-cols-[2fr_2fr_1fr] items-center gap-2\">\n\t\t<Select.Root type=\"single\" bind:value={options.displayLevel}>\n\t\t\t<Select.Trigger class=\"overflow-hidden\" aria-label={t.isochrones.displayLevel}>\n\t\t\t\t{displayLevels.get(options.displayLevel)}\n\t\t\t</Select.Trigger>\n\t\t\t<Select.Content sideOffset={10}>\n\t\t\t\t{#each possibleDisplayLevels as level, i (i + level.value)}\n\t\t\t\t\t<Select.Item value={level.value} label={level.label}>\n\t\t\t\t\t\t{level.label}\n\t\t\t\t\t</Select.Item>\n\t\t\t\t{/each}\n\t\t\t</Select.Content>\n\t\t</Select.Root>\n\t\t<Slider.Root\n\t\t\ttype=\"single\"\n\t\t\tmin={0}\n\t\t\tmax={1000}\n\t\t\tbind:value={options.opacity}\n\t\t\tclass=\"relative flex w-full touch-none select-none items-center\"\n\t\t>\n\t\t\t<span class=\"bg-dark-10 relative h-2 w-full grow cursor-pointer overflow-hidden rounded-full\">\n\t\t\t\t<Slider.Range class=\"bg-foreground absolute h-full\" />\n\t\t\t</span>\n\t\t\t<Slider.Thumb\n\t\t\t\tindex={0}\n\t\t\t\tclass=\"border-border-input bg-background hover:border-dark-40 focus-visible:ring-foreground dark:bg-foreground dark:shadow-card focus-visible:outline-hidden block size-[25px] cursor-pointer rounded-full border shadow-sm transition-colors focus-visible:ring-2 focus-visible:ring-offset-2 active:scale-[0.98] disabled:pointer-events-none disabled:opacity-50\"\n\t\t\t/>\n\t\t</Slider.Root>\n\t\t<input class=\"flex right-0 align-right\" type=\"color\" bind:value={options.color} />\n\t</div>\n{/snippet}\n\n<div id=\"isochrones-searchmask-container\" class=\"flex flex-col space-y-4 p-4 relative\">\n\t<AddressTypeahead\n\t\tplace={geocodingBiasPlace}\n\t\tname=\"one\"\n\t\tplaceholder={t.position}\n\t\tbind:selected={one}\n\t\tbind:items={oneItems}\n\t/>\n\t<Button\n\t\tvariant=\"ghost\"\n\t\tclass=\"absolute z-10 right-4 top-0\"\n\t\tsize=\"icon\"\n\t\tonclick={() => getLocation()}\n\t>\n\t\t<LocateFixed class=\"w-5 h-5\" />\n\t</Button>\n\t<div class=\"flex flex-row gap-2 flex-wrap\">\n\t\t<DateInput bind:value={time} />\n\t\t<RadioGroup.Root\n\t\t\tclass=\"flex\"\n\t\t\tbind:value={() => (arriveBy ? 'arrival' : 'departure'), (v) => (arriveBy = v === 'arrival')}\n\t\t\tonValueChange={swapPrePostData}\n\t\t>\n\t\t\t<Label\n\t\t\t\tfor=\"isochrones-departure\"\n\t\t\t\tclass=\"flex items-center rounded-md border-2 border-muted bg-popover p-1 px-2 hover:bg-accent hover:text-accent-foreground [&:has([data-state=checked])]:border-blue-600 hover:cursor-pointer\"\n\t\t\t>\n\t\t\t\t<RadioGroup.Item\n\t\t\t\t\tvalue=\"departure\"\n\t\t\t\t\tid=\"isochrones-departure\"\n\t\t\t\t\tclass=\"sr-only\"\n\t\t\t\t\taria-label={t.departure}\n\t\t\t\t/>\n\t\t\t\t<span>{t.departure}</span>\n\t\t\t</Label>\n\t\t\t<Label\n\t\t\t\tfor=\"isochrones-arrival\"\n\t\t\t\tclass=\"flex items-center rounded-md border-2 border-muted bg-popover p-1 px-2 hover:bg-accent hover:text-accent-foreground [&:has([data-state=checked])]:border-blue-600 hover:cursor-pointer\"\n\t\t\t>\n\t\t\t\t<RadioGroup.Item\n\t\t\t\t\tvalue=\"arrival\"\n\t\t\t\t\tid=\"isochrones-arrival\"\n\t\t\t\t\tclass=\"sr-only\"\n\t\t\t\t\taria-label={t.arrival}\n\t\t\t\t/>\n\t\t\t\t<span>{t.arrival}</span>\n\t\t\t</Label>\n\t\t</RadioGroup.Root>\n\t\t<AdvancedOptions\n\t\t\tbind:useRoutedTransfers\n\t\t\t{serverConfig}\n\t\t\tbind:wheelchair={\n\t\t\t\t() => pedestrianProfile === 'WHEELCHAIR',\n\t\t\t\t(v) => (pedestrianProfile = v ? 'WHEELCHAIR' : 'FOOT')\n\t\t\t}\n\t\t\tbind:requireCarTransport\n\t\t\tbind:requireBikeTransport\n\t\t\tbind:transitModes\n\t\t\tbind:maxTransfers\n\t\t\tbind:maxTravelTime\n\t\t\t{possibleMaxTravelTimes}\n\t\t\tbind:preTransitModes\n\t\t\tbind:postTransitModes\n\t\t\tdirectModes={undefined}\n\t\t\tbind:maxPreTransitTime\n\t\t\tbind:maxPostTransitTime\n\t\t\tmaxDirectTime={undefined}\n\t\t\tbind:elevationCosts\n\t\t\tbind:ignorePreTransitRentalReturnConstraints\n\t\t\tbind:ignorePostTransitRentalReturnConstraints\n\t\t\tignoreDirectRentalReturnConstraints={undefined}\n\t\t\t{additionalComponents}\n\t\t\tbind:preTransitProviderGroups\n\t\t\tbind:postTransitProviderGroups\n\t\t\tbind:directProviderGroups\n\t\t\tvia={undefined}\n\t\t\tviaMinimumStay={undefined}\n\t\t\tviaLabels={{}}\n\t\t/>\n\t</div>\n</div>\n","<script lang=\"ts\">\n\timport type {\n\t\tRentalFormFactor,\n\t\tRentalProvider,\n\t\tRentalStation\n\t} from '@motis-project/motis-client';\n\timport { Button } from '$lib/components/ui/button';\n\timport { Copy, type Icon as IconType } from '@lucide/svelte';\n\timport { formFactorAssets, propulsionTypes, returnConstraints } from '$lib/map/rentals/assets';\n\timport { t } from '$lib/i18n/translation';\n\n\tlet {\n\t\tprovider,\n\t\tstation,\n\t\tshowActions = false,\n\t\tdebug = false\n\t}: {\n\t\tprovider: RentalProvider;\n\t\tstation: RentalStation;\n\t\tshowActions?: boolean;\n\t\tdebug?: boolean;\n\t} = $props();\n\n\tlet debugInfo = $derived({\n\t\tstation,\n\t\tprovider: {\n\t\t\t...provider,\n\t\t\tvehicleTypes: provider.vehicleTypes.filter(\n\t\t\t\t(vt) =>\n\t\t\t\t\tObject.hasOwn(station.vehicleTypesAvailable, vt.id) ||\n\t\t\t\t\tObject.hasOwn(station.vehicleDocksAvailable, vt.id)\n\t\t\t),\n\t\t\ttotalVehicleTypes: provider.vehicleTypes.length\n\t\t}\n\t});\n\n\tasync function copyDebugInfo() {\n\t\tawait navigator.clipboard.writeText(JSON.stringify(debugInfo, null, 2));\n\t}\n\n\ttype IconInfo = {\n\t\tcomponent: typeof IconType;\n\t\ttitle: string;\n\t};\n\n\ttype VehicleRow = {\n\t\tid: string;\n\t\tavailable: number;\n\t\tformFactor: RentalFormFactor;\n\t\tname: string;\n\t\tpropulsionIcon: IconInfo | null;\n\t\treturnIcon: IconInfo | null;\n\t};\n\n\tconst vehicleRows = $derived.by<VehicleRow[]>(() => {\n\t\treturn Object.entries(station.vehicleTypesAvailable)\n\t\t\t.map(([id, count]) => {\n\t\t\t\tconst vt = provider.vehicleTypes.find((vt) => vt.id === id)!;\n\t\t\t\tconst name = vt.name || formFactorAssets[vt.formFactor].label;\n\n\t\t\t\treturn {\n\t\t\t\t\tid,\n\t\t\t\t\tavailable: count,\n\t\t\t\t\tformFactor: vt.formFactor,\n\t\t\t\t\tname,\n\t\t\t\t\tpropulsionIcon: propulsionTypes[vt.propulsionType],\n\t\t\t\t\treturnIcon: returnConstraints[vt.returnConstraint]\n\t\t\t\t};\n\t\t\t})\n\t\t\t.sort((a, b) => {\n\t\t\t\tif (b.available !== a.available) {\n\t\t\t\t\treturn b.available - a.available;\n\t\t\t\t}\n\t\t\t\treturn a.name.localeCompare(b.name);\n\t\t\t});\n\t});\n</script>\n\n<div class=\"space-y-3 text-sm leading-tight text-foreground max-w-96 w-fit\">\n\t<div class=\"space-y-1\">\n\t\t<div class=\"font-semibold\">{station.name}</div>\n\t\t{#if station.address}\n\t\t\t<div>{station.address}</div>\n\t\t{/if}\n\t\t<div>\n\t\t\t{t.sharingProvider}: {#if provider.url}\n\t\t\t\t<a\n\t\t\t\t\thref={provider.url}\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\tclass=\"text-blue-600 dark:text-blue-300 hover:underline\"\n\t\t\t\t>\n\t\t\t\t\t{provider.name}\n\t\t\t\t</a>\n\t\t\t{:else}\n\t\t\t\t{provider.name}\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n\t{#if vehicleRows.length}\n\t\t<table class=\"w-full text-xs\">\n\t\t\t<tbody>\n\t\t\t\t{#each vehicleRows as vehicle (vehicle.id)}\n\t\t\t\t\t<tr class=\"border-b border-border last:border-0\">\n\t\t\t\t\t\t<td class=\"w-8 pr-2 align-middle\">\n\t\t\t\t\t\t\t{vehicle.available}x\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"w-6 pr-2 align-middle\">\n\t\t\t\t\t\t\t<svg class=\"h-4 w-4 fill-current\" aria-hidden=\"true\" focusable=\"false\">\n\t\t\t\t\t\t\t\t<title>{formFactorAssets[vehicle.formFactor].label}</title>\n\t\t\t\t\t\t\t\t<use href={`#${formFactorAssets[vehicle.formFactor].svg}`} />\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"w-6 pr-2 align-middle\">\n\t\t\t\t\t\t\t{#if vehicle.propulsionIcon}\n\t\t\t\t\t\t\t\t{@const PropulsionIcon = vehicle.propulsionIcon.component}\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclass=\"inline-flex h-4 w-4 items-center justify-center text-muted-foreground\"\n\t\t\t\t\t\t\t\t\trole=\"img\"\n\t\t\t\t\t\t\t\t\ttitle={vehicle.propulsionIcon.title}\n\t\t\t\t\t\t\t\t\taria-label={vehicle.propulsionIcon.title}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<PropulsionIcon class=\"h-4 w-4\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tclass=\"truncate align-middle max-w-64\"\n\t\t\t\t\t\t\ttitle={vehicle.name}\n\t\t\t\t\t\t\taria-label={vehicle.name}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{vehicle.name}\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"w-8 pl-2 align-middle text-right\">\n\t\t\t\t\t\t\t{#if vehicle.returnIcon}\n\t\t\t\t\t\t\t\t{@const ReturnIcon = vehicle.returnIcon.component}\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclass=\"inline-flex h-4 w-4 items-center justify-center text-muted-foreground\"\n\t\t\t\t\t\t\t\t\trole=\"img\"\n\t\t\t\t\t\t\t\t\ttitle={vehicle.returnIcon.title}\n\t\t\t\t\t\t\t\t\taria-label={vehicle.returnIcon.title}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<ReturnIcon class=\"h-4 w-4\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t{/each}\n\t\t\t</tbody>\n\t\t</table>\n\t{/if}\n\t{#if showActions && station.rentalUriWeb}\n\t\t<Button class=\"font-bold\" variant=\"outline\" href={station.rentalUriWeb} target=\"_blank\">\n\t\t\t{t.rent}\n\t\t</Button>\n\t{/if}\n\t{#if debug}\n\t\t<div\n\t\t\tclass=\"pt-2 border-t border-border text-xs text-muted-foreground space-y-1 max-h-96 max-w-96 overflow-auto pr-2 relative\"\n\t\t>\n\t\t\t<Button\n\t\t\t\tclass=\"absolute top-2 right-2 z-10\"\n\t\t\t\tvariant=\"ghost\"\n\t\t\t\tsize=\"icon\"\n\t\t\t\tonclick={copyDebugInfo}\n\t\t\t\ttype=\"button\"\n\t\t\t\ttitle={t.copyToClipboard}\n\t\t\t\taria-label={t.copyToClipboard}\n\t\t\t>\n\t\t\t\t<Copy />\n\t\t\t</Button>\n\t\t\t<pre class=\"whitespace-pre-wrap pr-8\">{JSON.stringify(debugInfo, null, 2)}</pre>\n\t\t</div>\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\timport type { RentalProvider, RentalVehicle } from '@motis-project/motis-client';\n\timport { Button } from '$lib/components/ui/button';\n\timport { Copy } from '@lucide/svelte';\n\timport { t } from '$lib/i18n/translation';\n\timport { formFactorAssets, propulsionTypes, returnConstraints } from './assets';\n\n\tlet {\n\t\tprovider,\n\t\tvehicle,\n\t\tshowActions = false,\n\t\tdebug = false\n\t}: {\n\t\tprovider: RentalProvider;\n\t\tvehicle: RentalVehicle;\n\t\tshowActions?: boolean;\n\t\tdebug?: boolean;\n\t} = $props();\n\n\tlet vehicleType = $derived.by(() => provider.vehicleTypes.find((vt) => vt.id == vehicle.typeId));\n\tlet propulsion = $derived(propulsionTypes[vehicle.propulsionType]);\n\tlet returnConstraint = $derived(returnConstraints[vehicle.returnConstraint]);\n\n\tlet debugInfo = $derived({\n\t\tvehicle,\n\t\tprovider: {\n\t\t\t...provider,\n\t\t\tvehicleTypes: provider.vehicleTypes.filter((vt) => vt.id == vehicle.typeId),\n\t\t\ttotalVehicleTypes: provider.vehicleTypes.length\n\t\t}\n\t});\n\n\tasync function copyDebugInfo() {\n\t\tawait navigator.clipboard.writeText(JSON.stringify(debugInfo, null, 2));\n\t}\n</script>\n\n<div class=\"space-y-3 text-sm leading-tight text-foreground max-w-80\">\n\t<div class=\"flex gap-2\">\n\t\t<svg class=\"h-4 w-4 fill-current flex-none\" aria-hidden=\"true\" focusable=\"false\">\n\t\t\t<title>{formFactorAssets[vehicle.formFactor].label}</title>\n\t\t\t<use href={`#${formFactorAssets[vehicle.formFactor].svg}`} />\n\t\t</svg>\n\t\t{#if propulsion}\n\t\t\t<span\n\t\t\t\tclass=\"inline-flex h-4 w-4 items-center justify-center text-muted-foreground\"\n\t\t\t\trole=\"img\"\n\t\t\t\ttitle={propulsion.title}\n\t\t\t\taria-label={propulsion.title}\n\t\t\t>\n\t\t\t\t<propulsion.component class=\"h-4 w-4\" aria-hidden=\"true\" />\n\t\t\t</span>\n\t\t{/if}\n\t\t<span>{vehicleType?.name || formFactorAssets[vehicle.formFactor].label}</span>\n\t</div>\n\t<div>\n\t\t{t.sharingProvider}:\n\t\t{#if provider.url}\n\t\t\t<a\n\t\t\t\thref={provider.url}\n\t\t\t\ttarget=\"_blank\"\n\t\t\t\tclass=\"text-blue-600 dark:text-blue-300 hover:underline\"\n\t\t\t>\n\t\t\t\t{provider.name}\n\t\t\t</a>\n\t\t{:else}\n\t\t\t{provider.name}\n\t\t{/if}\n\t</div>\n\t{#if returnConstraint}\n\t\t<div class=\"flex gap-2\">\n\t\t\t<span\n\t\t\t\tclass=\"inline-flex h-4 w-4 items-center justify-center text-muted-foreground flex-none\"\n\t\t\t\trole=\"img\"\n\t\t\t\ttitle={returnConstraint.title}\n\t\t\t\taria-label={returnConstraint.title}\n\t\t\t>\n\t\t\t\t<returnConstraint.component class=\"h-4 w-4\" aria-hidden=\"true\" />\n\t\t\t</span>\n\t\t\t<span>{returnConstraint.title}</span>\n\t\t</div>\n\t{/if}\n\t{#if showActions && vehicle.rentalUriWeb}\n\t\t<Button class=\"font-bold\" variant=\"outline\" href={vehicle.rentalUriWeb} target=\"_blank\">\n\t\t\t{t.rent}\n\t\t</Button>\n\t{/if}\n\t{#if debug}\n\t\t<div\n\t\t\tclass=\"pt-2 border-t border-border text-xs text-muted-foreground space-y-1 max-h-96 max-w-96 overflow-auto pr-2 relative\"\n\t\t>\n\t\t\t<Button\n\t\t\t\tclass=\"absolute top-2 right-2 z-10\"\n\t\t\t\tvariant=\"ghost\"\n\t\t\t\tsize=\"icon\"\n\t\t\t\tonclick={copyDebugInfo}\n\t\t\t\ttype=\"button\"\n\t\t\t\ttitle={t.copyToClipboard}\n\t\t\t\taria-label={t.copyToClipboard}\n\t\t\t>\n\t\t\t\t<Copy />\n\t\t\t</Button>\n\t\t\t<pre class=\"whitespace-pre-wrap pr-8\">{JSON.stringify(debugInfo, null, 2)}</pre>\n\t\t</div>\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\timport type { RentalProvider, RentalStation, RentalZone } from '@motis-project/motis-client';\n\timport { Button } from '$lib/components/ui/button';\n\timport { Copy } from '@lucide/svelte';\n\timport { t } from '$lib/i18n/translation';\n\timport type { RentalZoneFeature } from './zone-types';\n\n\tlet {\n\t\tprovider,\n\t\tzone,\n\t\tstation,\n\t\trideThroughAllowed,\n\t\trideEndAllowed,\n\t\tallZonesAtPoint = [],\n\t\tzoneData = [],\n\t\tstationData = [],\n\t\tdebug = false\n\t}: {\n\t\tprovider: RentalProvider;\n\t\tzone: RentalZone | undefined;\n\t\tstation: RentalStation | undefined;\n\t\trideThroughAllowed: boolean;\n\t\trideEndAllowed: boolean;\n\t\tallZonesAtPoint?: RentalZoneFeature[];\n\t\tzoneData?: RentalZone[];\n\t\tstationData?: RentalStation[];\n\t\tdebug?: boolean;\n\t} = $props();\n\n\tlet debugInfo = $derived({\n\t\t...(zone ? { zone: { ...zone, area: '...' } } : {}),\n\t\t...(station ? { station: { ...station, stationArea: '...' } } : {}),\n\t\tprovider: provider,\n\t\tallZonesAtPoint: allZonesAtPoint.map((feature) => ({\n\t\t\tz: feature.properties.z,\n\t\t\tzoneIndex: feature.properties.zoneIndex,\n\t\t\tstationIndex: feature.properties.stationIndex,\n\t\t\trideThroughAllowed: feature.properties.rideThroughAllowed,\n\t\t\trideEndAllowed: feature.properties.rideEndAllowed,\n\t\t\tstationArea: feature.properties.stationArea,\n\t\t\tzone: (() => {\n\t\t\t\tif (feature.properties.zoneIndex === undefined) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tconst zone = zoneData[feature.properties.zoneIndex];\n\t\t\t\treturn zone ? { ...zone, area: '...' } : null;\n\t\t\t})(),\n\t\t\tstation: (() => {\n\t\t\t\tif (feature.properties.stationIndex === undefined) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tconst station = stationData[feature.properties.stationIndex];\n\t\t\t\treturn station ? { ...station, stationArea: '...' } : null;\n\t\t\t})()\n\t\t}))\n\t});\n\n\tasync function copyDebugInfo() {\n\t\tawait navigator.clipboard.writeText(JSON.stringify(debugInfo, null, 2));\n\t}\n</script>\n\n<div class=\"space-y-3 text-sm leading-tight text-foreground\">\n\t<div class=\"space-y-1\">\n\t\t{#if zone}\n\t\t\t{#if zone.name}\n\t\t\t\t<div class=\"font-semibold\">{t.rentalGeofencingZone}: {zone.name}</div>\n\t\t\t{:else}\n\t\t\t\t<div class=\"font-semibold\">{t.rentalGeofencingZone}</div>\n\t\t\t{/if}\n\t\t{:else if station}\n\t\t\t{#if station.name}\n\t\t\t\t<div class=\"font-semibold\">{t.rentalStation}: {station.name}</div>\n\t\t\t{:else}\n\t\t\t\t<div class=\"font-semibold\">{t.rentalStation}</div>\n\t\t\t{/if}\n\t\t{/if}\n\t\t<div>\n\t\t\t{t.sharingProvider}: {#if provider.url}\n\t\t\t\t<a\n\t\t\t\t\thref={provider.url}\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\tclass=\"text-blue-600 dark:text-blue-300 hover:underline\"\n\t\t\t\t>\n\t\t\t\t\t{provider.name}\n\t\t\t\t</a>\n\t\t\t{:else}\n\t\t\t\t{provider.name}\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n\t<div class=\"space-y-1\">\n\t\t<div>\n\t\t\t{rideThroughAllowed ? t.rideThroughAllowed : t.rideThroughNotAllowed}\n\t\t</div>\n\t\t{#if rideThroughAllowed}\n\t\t\t<div>\n\t\t\t\t{rideEndAllowed ? t.rideEndAllowed : t.rideEndNotAllowed}\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n\t{#if debug}\n\t\t<div\n\t\t\tclass=\"pt-2 border-t border-border text-xs text-muted-foreground space-y-1 max-h-96 max-w-96 overflow-auto pr-2 relative\"\n\t\t>\n\t\t\t<Button\n\t\t\t\tclass=\"absolute top-2 right-2 z-10\"\n\t\t\t\tvariant=\"ghost\"\n\t\t\t\tsize=\"icon\"\n\t\t\t\tonclick={copyDebugInfo}\n\t\t\t\ttype=\"button\"\n\t\t\t\ttitle={t.copyToClipboard}\n\t\t\t\taria-label={t.copyToClipboard}\n\t\t\t>\n\t\t\t\t<Copy />\n\t\t\t</Button>\n\t\t\t<pre class=\"whitespace-pre-wrap pr-8\">{JSON.stringify(debugInfo, null, 2)}</pre>\n\t\t</div>\n\t{/if}\n</div>\n","import earcut from 'earcut';\nimport { flatten } from 'earcut';\nimport maplibregl from 'maplibre-gl';\nimport { type CustomRenderMethodInput, type Map as MapLibreMap, type PointLike } from 'maplibre-gl';\nimport type { Position } from 'geojson';\n\nimport type { RentalZoneFeature, RentalZoneFeatureProperties } from './zone-types';\n\ntype GLContext = WebGLRenderingContext | WebGL2RenderingContext;\n\nconst DEFAULT_OPACITY = 0.4;\nconst STRIPE_WIDTH_PX = 6.0;\nconst STRIPE_OPACITY_VARIATION = 0.1;\nconst POSITION_COMPONENTS = 2;\nconst POSITION_STRIDE_BYTES = POSITION_COMPONENTS * Float32Array.BYTES_PER_ELEMENT;\nconst COLOR_COMPONENTS = 4;\nconst COLOR_STRIDE_BYTES = COLOR_COMPONENTS * Float32Array.BYTES_PER_ELEMENT;\n\nconst FILL_VERTEX_SHADER_SOURCE = `#version 300 es\nprecision highp float;\nin vec2 a_pos;\nin vec4 a_color;\nout vec4 v_color;\nuniform vec4 u_zone_base;\nuniform vec4 u_zone_scale_x;\nuniform vec4 u_zone_scale_y;\nvoid main() {\n\tv_color = a_color;\n\tgl_Position = u_zone_base + a_pos.x * u_zone_scale_x + a_pos.y * u_zone_scale_y;\n}\n`;\n\nconst FILL_FRAGMENT_SHADER_SOURCE = `#version 300 es\nprecision mediump float;\nin vec4 v_color;\nout vec4 fragColor;\nvoid main() {\n\tfragColor = v_color;\n}\n`;\n\ntype ZoneGeometry = {\n\tvertices: number[]; // mercator [x0, y0, x1, y1, ...]\n\tminX: number;\n\tminY: number;\n\tmaxX: number;\n\tmaxY: number;\n};\n\ntype FillProgramState = {\n\tprogram: WebGLProgram;\n\tpositionLocation: number;\n\tcolorLocation: number;\n\tbaseLocation: WebGLUniformLocation | null;\n\tscaleXLocation: WebGLUniformLocation | null;\n\tscaleYLocation: WebGLUniformLocation | null;\n};\n\ntype ZoneFillLayerOptions = {\n\tid: string;\n\topacity?: number;\n};\n\nconst QUAD_VERTICES = new Float32Array([-1, -1, 0, 0, 1, -1, 1, 0, -1, 1, 0, 1, 1, 1, 1, 1]);\n\nconst SCREEN_VERTEX_SHADER_SOURCE = `\nattribute vec2 a_pos;\nattribute vec2 a_tex_coord;\nvarying vec2 v_tex_coord;\nvoid main() {\n\tv_tex_coord = a_tex_coord;\n\tgl_Position = vec4(a_pos, 0.0, 1.0);\n}\n`;\n\nconst SCREEN_FRAGMENT_SHADER_SOURCE = `\nprecision highp float;\nuniform sampler2D u_texture;\nuniform float u_opacity_primary;\nuniform float u_opacity_secondary;\nuniform float u_stripe_width;\nvarying vec2 v_tex_coord;\nvoid main() {\n\tvec4 color = texture2D(u_texture, v_tex_coord);\n\tif (color.a == 0.0) {\n\t\tdiscard;\n\t}\n\tfloat diagonal = gl_FragCoord.x + gl_FragCoord.y;\n\tfloat stripeIndex = mod(floor(diagonal / u_stripe_width), 2.0);\n\tfloat opacity = mix(u_opacity_primary, u_opacity_secondary, stripeIndex);\n\tgl_FragColor = vec4(color.rgb, color.a * opacity);\n}\n`;\n\nconst ZONE_COLOR_ALLOWED = new Float32Array([0.13333333, 0.77254902, 0.36862745, 1]); // #22c55e (green)\nconst ZONE_COLOR_FORBIDDEN = new Float32Array([0.9372549, 0.26666667, 0.26666667, 1]); // #ef4444 (red)\nconst ZONE_COLOR_RESTRICTED = new Float32Array([1, 0.84313725, 0, 1]); // #ffd700 (yellow)\nconst ZONE_COLOR_STATION = new Float32Array([0.25882354, 0.52156866, 0.95686275, 1]); // #4287f5 (blue)\n\nexport const getZoneColor = (properties: RentalZoneFeatureProperties) => {\n\tif (properties.stationArea) {\n\t\treturn ZONE_COLOR_STATION;\n\t}\n\tif (properties.rideEndAllowed) {\n\t\treturn ZONE_COLOR_ALLOWED;\n\t}\n\tif (!properties.rideThroughAllowed) {\n\t\treturn ZONE_COLOR_FORBIDDEN;\n\t}\n\treturn ZONE_COLOR_RESTRICTED;\n};\n\nconst encodePickingColor = (i: number): Float32Array => {\n\treturn new Float32Array([\n\t\t((i >> 16) & 0xff) / 0xff,\n\t\t((i >> 8) & 0xff) / 0xff,\n\t\t(i & 0xff) / 0xff,\n\t\t1\n\t]);\n};\n\nconst decodePickingColor = (px: Uint8Array): number => {\n\treturn (px[0] << 16) | (px[1] << 8) | px[2];\n};\n\ntype ZoneClipFrame = {\n\tbase: Float32Array;\n\tscaleX: Float32Array;\n\tscaleY: Float32Array;\n};\n\nconst toClipCoordinates = (\n\tmap: MapLibreMap,\n\twidth: number,\n\theight: number,\n\tpixelRatioX: number,\n\tpixelRatioY: number,\n\tlngLat: maplibregl.LngLat\n): Float32Array => {\n\tconst point = map.project(lngLat);\n\tconst px = point.x * pixelRatioX;\n\tconst py = point.y * pixelRatioY;\n\tconst clipX = (px / width) * 2 - 1;\n\tconst clipY = 1 - (py / height) * 2;\n\treturn new Float32Array([clipX, clipY, 0, 1]);\n};\n\nconst computeZoneClipFrame = (\n\tmap: MapLibreMap,\n\twidth: number,\n\theight: number,\n\tpixelRatioX: number,\n\tpixelRatioY: number,\n\torigin: Float32Array,\n\textent: Float32Array\n): ZoneClipFrame => {\n\tconst originLngLat = new maplibregl.MercatorCoordinate(origin[0], origin[1]).toLngLat();\n\tconst maxLngLat = new maplibregl.MercatorCoordinate(\n\t\torigin[0] + extent[0],\n\t\torigin[1] + extent[1]\n\t).toLngLat();\n\n\tconst base = toClipCoordinates(map, width, height, pixelRatioX, pixelRatioY, originLngLat);\n\tconst maxClip = toClipCoordinates(map, width, height, pixelRatioX, pixelRatioY, maxLngLat);\n\n\tconst scaleX = new Float32Array([maxClip[0] - base[0], 0, 0, 0]);\n\tconst scaleY = new Float32Array([0, maxClip[1] - base[1], 0, 0]);\n\n\treturn { base, scaleX, scaleY };\n};\n\nconst toPoint = (p: PointLike): maplibregl.Point => {\n\treturn Array.isArray(p) ? new maplibregl.Point(p[0], p[1]) : p;\n};\n\nexport class ZoneFillLayer implements maplibregl.CustomLayerInterface {\n\tid: string;\n\ttype: 'custom' = 'custom' as const;\n\trenderingMode: '2d' = '2d' as const;\n\n\tprivate opacity: number;\n\tprivate gl: GLContext | null = null;\n\tprivate map: MapLibreMap | null = null;\n\tprivate screenProgram: WebGLProgram | null = null;\n\tprivate framebuffer: WebGLFramebuffer | null = null;\n\tprivate texture: WebGLTexture | null = null;\n\tprivate pickingFramebuffer: WebGLFramebuffer | null = null;\n\tprivate pickingTexture: WebGLTexture | null = null;\n\tprivate quadBuffer: WebGLBuffer | null = null;\n\tprivate features: RentalZoneFeature[] = [];\n\tprivate geometryDirty = true;\n\tprivate width = 0;\n\tprivate height = 0;\n\tprivate pickingWidth = 0;\n\tprivate pickingHeight = 0;\n\tprivate fillProgram: FillProgramState | null = null;\n\tprivate pickingLookup = new Map<number, RentalZoneFeature>();\n\tprivate pickingPixel = new Uint8Array(4);\n\tprivate positionBuffer: WebGLBuffer | null = null;\n\tprivate colorBuffer: WebGLBuffer | null = null;\n\tprivate pickingColorBuffer: WebGLBuffer | null = null;\n\tprivate vertexCount = 0;\n\tprivate globalOrigin = new Float32Array([0, 0]);\n\tprivate globalExtent = new Float32Array([1, 1]);\n\n\tprivate screenPositionLocation = -1;\n\tprivate screenTexCoordLocation = -1;\n\tprivate screenTextureLocation: WebGLUniformLocation | null = null;\n\tprivate screenOpacityPrimaryLocation: WebGLUniformLocation | null = null;\n\tprivate screenOpacitySecondaryLocation: WebGLUniformLocation | null = null;\n\tprivate screenStripeWidthLocation: WebGLUniformLocation | null = null;\n\n\tconstructor(options: ZoneFillLayerOptions) {\n\t\tthis.id = options.id;\n\t\tthis.opacity = options.opacity ?? DEFAULT_OPACITY;\n\t}\n\n\tsetOpacity(opacity: number) {\n\t\tif (this.opacity === opacity) {\n\t\t\treturn;\n\t\t}\n\t\tthis.opacity = opacity;\n\t\tthis.map?.triggerRepaint();\n\t}\n\n\tsetFeatures(features: RentalZoneFeature[]) {\n\t\tthis.features = features;\n\t\tthis.geometryDirty = true;\n\t\tthis.updateGeometry();\n\t\tthis.map?.triggerRepaint();\n\t}\n\n\tonAdd(map: MapLibreMap, gl: GLContext) {\n\t\tthis.map = map;\n\t\tthis.gl = gl;\n\t\tthis.initialize(gl);\n\t\tthis.updateGeometry();\n\t}\n\n\tonRemove(_map: MapLibreMap, gl: GLContext) {\n\t\tthis.cleanup(gl);\n\t}\n\n\tcleanup(gl?: GLContext) {\n\t\tif (!gl && this.gl) {\n\t\t\tgl = this.gl;\n\t\t}\n\t\tif (!gl) {\n\t\t\treturn;\n\t\t}\n\t\tthis.deleteGeometryBuffers(gl);\n\t\tif (this.framebuffer) {\n\t\t\tgl.deleteFramebuffer(this.framebuffer);\n\t\t\tthis.framebuffer = null;\n\t\t}\n\t\tif (this.texture) {\n\t\t\tgl.deleteTexture(this.texture);\n\t\t\tthis.texture = null;\n\t\t}\n\t\tif (this.pickingFramebuffer) {\n\t\t\tgl.deleteFramebuffer(this.pickingFramebuffer);\n\t\t\tthis.pickingFramebuffer = null;\n\t\t}\n\t\tif (this.pickingTexture) {\n\t\t\tgl.deleteTexture(this.pickingTexture);\n\t\t\tthis.pickingTexture = null;\n\t\t}\n\t\tif (this.quadBuffer) {\n\t\t\tgl.deleteBuffer(this.quadBuffer);\n\t\t\tthis.quadBuffer = null;\n\t\t}\n\t\tif (this.fillProgram) {\n\t\t\tgl.deleteProgram(this.fillProgram.program);\n\t\t\tthis.fillProgram = null;\n\t\t}\n\t\tthis.pickingLookup.clear();\n\t\tif (this.screenProgram) {\n\t\t\tgl.deleteProgram(this.screenProgram);\n\t\t\tthis.screenProgram = null;\n\t\t}\n\t\tthis.geometryDirty = true;\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t\tthis.pickingWidth = 0;\n\t\tthis.pickingHeight = 0;\n\t\tthis.gl = null;\n\t\tthis.map = null;\n\t}\n\n\tprerender(gl: GLContext, _options: CustomRenderMethodInput) {\n\t\tif (\n\t\t\t!this.map ||\n\t\t\tthis.vertexCount === 0 ||\n\t\t\t!this.positionBuffer ||\n\t\t\t!this.colorBuffer ||\n\t\t\t!this.pickingColorBuffer\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst map = this.map;\n\t\tconst width = gl.drawingBufferWidth;\n\t\tconst height = gl.drawingBufferHeight;\n\t\tif (width === 0 || height === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst fillProgram = this.ensureFillProgram(gl);\n\t\tif (!fillProgram || fillProgram.positionLocation < 0 || fillProgram.colorLocation < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst canvas = map.getCanvas();\n\t\tconst rect = canvas.getBoundingClientRect();\n\t\tconst cssWidth = rect.width;\n\t\tconst cssHeight = rect.height;\n\t\tif (cssWidth === 0 || cssHeight === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst pixelRatioX = width / cssWidth;\n\t\tconst pixelRatioY = height / cssHeight;\n\t\tconst clipFrame = computeZoneClipFrame(\n\t\t\tmap,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tpixelRatioX,\n\t\t\tpixelRatioY,\n\t\t\tthis.globalOrigin,\n\t\t\tthis.globalExtent\n\t\t);\n\n\t\tthis.ensureFramebuffer(gl, width, height);\n\t\tthis.ensurePickingFramebuffer(gl, width, height);\n\t\tif (!this.framebuffer || !this.texture || !this.pickingFramebuffer || !this.pickingTexture) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst previousFramebuffer = gl.getParameter(gl.FRAMEBUFFER_BINDING) as WebGLFramebuffer | null;\n\t\tconst previousViewport = gl.getParameter(gl.VIEWPORT) as Int32Array;\n\t\tconst blendEnabled = gl.isEnabled(gl.BLEND);\n\t\tconst depthTestEnabled = gl.isEnabled(gl.DEPTH_TEST);\n\t\tconst stencilTestEnabled = gl.isEnabled(gl.STENCIL_TEST);\n\t\tconst cullFaceEnabled = gl.isEnabled(gl.CULL_FACE);\n\n\t\tgl.disable(gl.BLEND);\n\t\tgl.disable(gl.DEPTH_TEST);\n\t\tgl.disable(gl.STENCIL_TEST);\n\t\tgl.disable(gl.CULL_FACE);\n\n\t\tconst renderToFramebuffer = (fb: WebGLFramebuffer, colorBuffer: WebGLBuffer) => {\n\t\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, fb);\n\t\t\tgl.viewport(0, 0, width, height);\n\t\t\tgl.clearColor(0, 0, 0, 0);\n\t\t\tgl.clear(gl.COLOR_BUFFER_BIT);\n\n\t\t\tgl.useProgram(fillProgram.program);\n\t\t\tgl.uniform4fv(fillProgram.baseLocation, clipFrame.base);\n\t\t\tgl.uniform4fv(fillProgram.scaleXLocation, clipFrame.scaleX);\n\t\t\tgl.uniform4fv(fillProgram.scaleYLocation, clipFrame.scaleY);\n\n\t\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);\n\t\t\tgl.enableVertexAttribArray(fillProgram.positionLocation);\n\t\t\tgl.vertexAttribPointer(\n\t\t\t\tfillProgram.positionLocation,\n\t\t\t\tPOSITION_COMPONENTS,\n\t\t\t\tgl.FLOAT,\n\t\t\t\tfalse,\n\t\t\t\tPOSITION_STRIDE_BYTES,\n\t\t\t\t0\n\t\t\t);\n\n\t\t\tgl.bindBuffer(gl.ARRAY_BUFFER, colorBuffer);\n\t\t\tgl.enableVertexAttribArray(fillProgram.colorLocation);\n\t\t\tgl.vertexAttribPointer(\n\t\t\t\tfillProgram.colorLocation,\n\t\t\t\tCOLOR_COMPONENTS,\n\t\t\t\tgl.FLOAT,\n\t\t\t\tfalse,\n\t\t\t\tCOLOR_STRIDE_BYTES,\n\t\t\t\t0\n\t\t\t);\n\n\t\t\tgl.drawArrays(gl.TRIANGLES, 0, this.vertexCount);\n\n\t\t\tgl.disableVertexAttribArray(fillProgram.positionLocation);\n\t\t\tgl.disableVertexAttribArray(fillProgram.colorLocation);\n\t\t\tgl.bindBuffer(gl.ARRAY_BUFFER, null);\n\t\t};\n\n\t\trenderToFramebuffer(this.framebuffer, this.colorBuffer);\n\t\trenderToFramebuffer(this.pickingFramebuffer, this.pickingColorBuffer);\n\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, previousFramebuffer);\n\t\tgl.viewport(previousViewport[0], previousViewport[1], previousViewport[2], previousViewport[3]);\n\n\t\tif (blendEnabled) {\n\t\t\tgl.enable(gl.BLEND);\n\t\t}\n\t\tif (depthTestEnabled) {\n\t\t\tgl.enable(gl.DEPTH_TEST);\n\t\t}\n\t\tif (stencilTestEnabled) {\n\t\t\tgl.enable(gl.STENCIL_TEST);\n\t\t}\n\t\tif (cullFaceEnabled) {\n\t\t\tgl.enable(gl.CULL_FACE);\n\t\t}\n\t}\n\n\trender(gl: GLContext, _options: CustomRenderMethodInput) {\n\t\tif (!this.screenProgram || !this.texture || !this.quadBuffer || this.vertexCount === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tgl.useProgram(this.screenProgram);\n\n\t\tconst prevBlendSrcRGB = gl.getParameter(gl.BLEND_SRC_RGB) as number;\n\t\tconst prevBlendDstRGB = gl.getParameter(gl.BLEND_DST_RGB) as number;\n\t\tconst prevBlendSrcAlpha = gl.getParameter(gl.BLEND_SRC_ALPHA) as number;\n\t\tconst prevBlendDstAlpha = gl.getParameter(gl.BLEND_DST_ALPHA) as number;\n\t\tconst prevBlendEquationRGB = gl.getParameter(gl.BLEND_EQUATION_RGB) as number;\n\t\tconst prevBlendEquationAlpha = gl.getParameter(gl.BLEND_EQUATION_ALPHA) as number;\n\n\t\tgl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n\n\t\tgl.enableVertexAttribArray(this.screenPositionLocation);\n\t\tgl.enableVertexAttribArray(this.screenTexCoordLocation);\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.quadBuffer);\n\t\tgl.vertexAttribPointer(this.screenPositionLocation, 2, gl.FLOAT, false, 16, 0);\n\t\tgl.vertexAttribPointer(this.screenTexCoordLocation, 2, gl.FLOAT, false, 16, 8);\n\n\t\tgl.activeTexture(gl.TEXTURE0);\n\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture);\n\t\tgl.uniform1i(this.screenTextureLocation, 0);\n\t\tconst minOpacity = Math.max(this.opacity - STRIPE_OPACITY_VARIATION, 0.0);\n\t\tconst maxOpacity = Math.min(this.opacity + STRIPE_OPACITY_VARIATION, 1.0);\n\t\tgl.uniform1f(this.screenOpacityPrimaryLocation, minOpacity);\n\t\tgl.uniform1f(this.screenOpacitySecondaryLocation, maxOpacity);\n\t\tgl.uniform1f(this.screenStripeWidthLocation, STRIPE_WIDTH_PX);\n\n\t\tgl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n\n\t\tgl.bindTexture(gl.TEXTURE_2D, null);\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, null);\n\t\tgl.disableVertexAttribArray(this.screenPositionLocation);\n\t\tgl.disableVertexAttribArray(this.screenTexCoordLocation);\n\n\t\tgl.blendFuncSeparate(prevBlendSrcRGB, prevBlendDstRGB, prevBlendSrcAlpha, prevBlendDstAlpha);\n\t\tgl.blendEquationSeparate(prevBlendEquationRGB, prevBlendEquationAlpha);\n\t}\n\n\tprivate initialize(gl: GLContext) {\n\t\tthis.screenProgram = this.createProgram(\n\t\t\tgl,\n\t\t\tSCREEN_VERTEX_SHADER_SOURCE,\n\t\t\tSCREEN_FRAGMENT_SHADER_SOURCE\n\t\t);\n\n\t\tif (!this.screenProgram) {\n\t\t\tthrow new Error('Failed to initialize zone fill shaders');\n\t\t}\n\n\t\tthis.screenPositionLocation = gl.getAttribLocation(this.screenProgram, 'a_pos');\n\t\tthis.screenTexCoordLocation = gl.getAttribLocation(this.screenProgram, 'a_tex_coord');\n\t\tthis.screenTextureLocation = gl.getUniformLocation(this.screenProgram, 'u_texture');\n\t\tthis.screenOpacityPrimaryLocation = gl.getUniformLocation(\n\t\t\tthis.screenProgram,\n\t\t\t'u_opacity_primary'\n\t\t);\n\t\tthis.screenOpacitySecondaryLocation = gl.getUniformLocation(\n\t\t\tthis.screenProgram,\n\t\t\t'u_opacity_secondary'\n\t\t);\n\t\tthis.screenStripeWidthLocation = gl.getUniformLocation(this.screenProgram, 'u_stripe_width');\n\n\t\tthis.quadBuffer = gl.createBuffer();\n\t\tif (!this.quadBuffer) {\n\t\t\tthrow new Error('Failed to allocate quad buffer');\n\t\t}\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.quadBuffer);\n\t\tgl.bufferData(gl.ARRAY_BUFFER, QUAD_VERTICES, gl.STATIC_DRAW);\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, null);\n\t}\n\n\tprivate ensureFramebuffer(gl: GLContext, width: number, height: number) {\n\t\tif (this.framebuffer && this.texture && this.width === width && this.height === height) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\n\t\tif (!this.framebuffer) {\n\t\t\tthis.framebuffer = gl.createFramebuffer();\n\t\t}\n\t\tif (!this.texture) {\n\t\t\tthis.texture = gl.createTexture();\n\t\t}\n\t\tif (!this.framebuffer || !this.texture) {\n\t\t\treturn;\n\t\t}\n\n\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\t\tgl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\n\t\tgl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.texture, 0);\n\n\t\tconst status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n\t\tif (status !== gl.FRAMEBUFFER_COMPLETE) {\n\t\t\tconsole.error('[ZoneFillLayer] Incomplete framebuffer:', status);\n\t\t}\n\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\t\tgl.bindTexture(gl.TEXTURE_2D, null);\n\t}\n\n\tprivate ensurePickingFramebuffer(gl: GLContext, width: number, height: number) {\n\t\tif (\n\t\t\tthis.pickingFramebuffer &&\n\t\t\tthis.pickingTexture &&\n\t\t\tthis.pickingWidth === width &&\n\t\t\tthis.pickingHeight === height\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.pickingFramebuffer) {\n\t\t\tthis.pickingFramebuffer = gl.createFramebuffer();\n\t\t}\n\t\tif (!this.pickingTexture) {\n\t\t\tthis.pickingTexture = gl.createTexture();\n\t\t}\n\t\tif (!this.pickingFramebuffer || !this.pickingTexture) {\n\t\t\treturn;\n\t\t}\n\n\t\tgl.bindTexture(gl.TEXTURE_2D, this.pickingTexture);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\t\tgl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, this.pickingFramebuffer);\n\t\tgl.framebufferTexture2D(\n\t\t\tgl.FRAMEBUFFER,\n\t\t\tgl.COLOR_ATTACHMENT0,\n\t\t\tgl.TEXTURE_2D,\n\t\t\tthis.pickingTexture,\n\t\t\t0\n\t\t);\n\n\t\tconst status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n\t\tif (status !== gl.FRAMEBUFFER_COMPLETE) {\n\t\t\tconsole.error('[ZoneFillLayer] Incomplete picking framebuffer:', status);\n\t\t}\n\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\t\tgl.bindTexture(gl.TEXTURE_2D, null);\n\n\t\tthis.pickingWidth = width;\n\t\tthis.pickingHeight = height;\n\t}\n\n\tprivate ensureFillProgram(gl: GLContext): FillProgramState | null {\n\t\tif (this.fillProgram) {\n\t\t\treturn this.fillProgram;\n\t\t}\n\n\t\tconst program = this.createProgram(gl, FILL_VERTEX_SHADER_SOURCE, FILL_FRAGMENT_SHADER_SOURCE);\n\t\tif (!program) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst state: FillProgramState = {\n\t\t\tprogram,\n\t\t\tpositionLocation: gl.getAttribLocation(program, 'a_pos'),\n\t\t\tcolorLocation: gl.getAttribLocation(program, 'a_color'),\n\t\t\tbaseLocation: gl.getUniformLocation(program, 'u_zone_base'),\n\t\t\tscaleXLocation: gl.getUniformLocation(program, 'u_zone_scale_x'),\n\t\t\tscaleYLocation: gl.getUniformLocation(program, 'u_zone_scale_y')\n\t\t};\n\n\t\tthis.fillProgram = state;\n\t\treturn state;\n\t}\n\n\tprivate createProgram(\n\t\tgl: GLContext,\n\t\tvertexSrc: string,\n\t\tfragmentSrc: string\n\t): WebGLProgram | null {\n\t\tconst vertexShader = this.compileShader(gl, gl.VERTEX_SHADER, vertexSrc);\n\t\tconst fragmentShader = this.compileShader(gl, gl.FRAGMENT_SHADER, fragmentSrc);\n\t\tif (!vertexShader || !fragmentShader) {\n\t\t\treturn null;\n\t\t}\n\t\tconst program = gl.createProgram();\n\t\tif (!program) {\n\t\t\treturn null;\n\t\t}\n\t\tgl.attachShader(program, vertexShader);\n\t\tgl.attachShader(program, fragmentShader);\n\t\tgl.linkProgram(program);\n\t\tif (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n\t\t\tconsole.error('Failed to link shader program', gl.getProgramInfoLog(program));\n\t\t\tgl.deleteProgram(program);\n\t\t\treturn null;\n\t\t}\n\t\tgl.deleteShader(vertexShader);\n\t\tgl.deleteShader(fragmentShader);\n\t\treturn program;\n\t}\n\n\tprivate compileShader(gl: GLContext, type: number, source: string): WebGLShader | null {\n\t\tconst shader = gl.createShader(type);\n\t\tif (!shader) {\n\t\t\treturn null;\n\t\t}\n\t\tgl.shaderSource(shader, source);\n\t\tgl.compileShader(shader);\n\t\tif (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n\t\t\tconsole.error('Failed to compile shader', gl.getShaderInfoLog(shader));\n\t\t\tgl.deleteShader(shader);\n\t\t\treturn null;\n\t\t}\n\t\treturn shader;\n\t}\n\n\tprivate updateGeometry() {\n\t\tconst gl = this.gl;\n\t\tif (!gl || !this.geometryDirty) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.deleteGeometryBuffers(gl);\n\t\tthis.pickingLookup.clear();\n\n\t\tconst features = [...this.features].sort((a, b) => a.properties.z - b.properties.z);\n\t\tconst zoneGeometries: ZoneGeometry[] = [];\n\t\tconst colorValues: number[] = [];\n\t\tconst pickingValues: number[] = [];\n\t\tlet totalVertices = 0;\n\t\tlet globalMinX = Number.POSITIVE_INFINITY;\n\t\tlet globalMinY = Number.POSITIVE_INFINITY;\n\t\tlet globalMaxX = Number.NEGATIVE_INFINITY;\n\t\tlet globalMaxY = Number.NEGATIVE_INFINITY;\n\t\tlet zoneIdx = 0;\n\n\t\tfor (const feature of features) {\n\t\t\tconst geometry = this.buildZoneGeometry(feature);\n\t\t\tif (!geometry) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst vertexCount = geometry.vertices.length / POSITION_COMPONENTS;\n\t\t\tif (vertexCount === 0) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tzoneGeometries.push(geometry);\n\t\t\ttotalVertices += vertexCount;\n\t\t\tglobalMinX = Math.min(globalMinX, geometry.minX);\n\t\t\tglobalMinY = Math.min(globalMinY, geometry.minY);\n\t\t\tglobalMaxX = Math.max(globalMaxX, geometry.maxX);\n\t\t\tglobalMaxY = Math.max(globalMaxY, geometry.maxY);\n\n\t\t\tconst pickingIdx = zoneIdx + 1;\n\t\t\tzoneIdx += 1;\n\t\t\tconst color = getZoneColor(feature.properties);\n\t\t\tconst pickingColor = encodePickingColor(pickingIdx);\n\t\t\tthis.pickingLookup.set(pickingIdx, feature);\n\n\t\t\tfor (let i = 0; i < vertexCount; ++i) {\n\t\t\t\tcolorValues.push(color[0], color[1], color[2], color[3]);\n\t\t\t\tpickingValues.push(pickingColor[0], pickingColor[1], pickingColor[2], pickingColor[3]);\n\t\t\t}\n\t\t}\n\n\t\tconst extentX = globalMaxX - globalMinX;\n\t\tconst extentY = globalMaxY - globalMinY;\n\n\t\tif (\n\t\t\ttotalVertices === 0 ||\n\t\t\tglobalMinX === Number.POSITIVE_INFINITY ||\n\t\t\tglobalMinY === Number.POSITIVE_INFINITY ||\n\t\t\tglobalMaxX === Number.NEGATIVE_INFINITY ||\n\t\t\tglobalMaxY === Number.NEGATIVE_INFINITY ||\n\t\t\textentX === 0 ||\n\t\t\textentY === 0\n\t\t) {\n\t\t\tthis.vertexCount = 0;\n\t\t\tthis.geometryDirty = false;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.globalOrigin = new Float32Array([globalMinX, globalMinY]);\n\t\tthis.globalExtent = new Float32Array([extentX, extentY]);\n\n\t\tconst positions = new Float32Array(totalVertices * POSITION_COMPONENTS);\n\t\tlet posOffset = 0;\n\t\tfor (const geometry of zoneGeometries) {\n\t\t\tfor (let i = 0; i < geometry.vertices.length; i += POSITION_COMPONENTS) {\n\t\t\t\tconst x = geometry.vertices[i];\n\t\t\t\tconst y = geometry.vertices[i + 1];\n\t\t\t\tpositions[posOffset++] = (x - globalMinX) / extentX;\n\t\t\t\tpositions[posOffset++] = (y - globalMinY) / extentY;\n\t\t\t}\n\t\t}\n\n\t\tconst colorArray = new Float32Array(colorValues);\n\t\tconst pickingArray = new Float32Array(pickingValues);\n\n\t\tthis.positionBuffer = gl.createBuffer();\n\t\tthis.colorBuffer = gl.createBuffer();\n\t\tthis.pickingColorBuffer = gl.createBuffer();\n\t\tif (!this.positionBuffer || !this.colorBuffer || !this.pickingColorBuffer) {\n\t\t\tconsole.error('[ZoneFillLayer] Failed to allocate geometry buffers');\n\t\t\tthis.deleteGeometryBuffers(gl);\n\t\t\tthis.geometryDirty = false;\n\t\t\treturn;\n\t\t}\n\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);\n\t\tgl.bufferData(gl.ARRAY_BUFFER, positions, gl.STATIC_DRAW);\n\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.colorBuffer);\n\t\tgl.bufferData(gl.ARRAY_BUFFER, colorArray, gl.STATIC_DRAW);\n\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.pickingColorBuffer);\n\t\tgl.bufferData(gl.ARRAY_BUFFER, pickingArray, gl.STATIC_DRAW);\n\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, null);\n\n\t\tthis.vertexCount = totalVertices;\n\t\tthis.geometryDirty = false;\n\t}\n\n\tprivate deleteGeometryBuffers(gl: GLContext) {\n\t\tif (this.positionBuffer) {\n\t\t\tgl.deleteBuffer(this.positionBuffer);\n\t\t\tthis.positionBuffer = null;\n\t\t}\n\t\tif (this.colorBuffer) {\n\t\t\tgl.deleteBuffer(this.colorBuffer);\n\t\t\tthis.colorBuffer = null;\n\t\t}\n\t\tif (this.pickingColorBuffer) {\n\t\t\tgl.deleteBuffer(this.pickingColorBuffer);\n\t\t\tthis.pickingColorBuffer = null;\n\t\t}\n\t\tthis.vertexCount = 0;\n\t\tthis.globalOrigin = new Float32Array([0, 0]);\n\t\tthis.globalExtent = new Float32Array([1, 1]);\n\t}\n\n\tpickFeatureAt(pointLike: PointLike): RentalZoneFeature | null {\n\t\tif (!this.map || !this.gl || !this.pickingFramebuffer || !this.pickingTexture) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst pt = toPoint(pointLike);\n\t\tconst canvas = this.map.getCanvas();\n\t\tconst rect = canvas.getBoundingClientRect();\n\t\tif (rect.width === 0 || rect.height === 0) {\n\t\t\treturn null;\n\t\t}\n\t\tconst scaleX = canvas.width / rect.width;\n\t\tconst scaleY = canvas.height / rect.height;\n\t\tconst pixelX = Math.floor(pt.x * scaleX);\n\t\tconst pixelY = Math.floor(canvas.height - pt.y * scaleY - 1);\n\n\t\tconst previousFramebuffer = this.gl.getParameter(\n\t\t\tthis.gl.FRAMEBUFFER_BINDING\n\t\t) as WebGLFramebuffer | null;\n\t\tthis.gl.bindFramebuffer(this.gl.FRAMEBUFFER, this.pickingFramebuffer);\n\t\tthis.gl.readPixels(\n\t\t\tpixelX,\n\t\t\tpixelY,\n\t\t\t1,\n\t\t\t1,\n\t\t\tthis.gl.RGBA,\n\t\t\tthis.gl.UNSIGNED_BYTE,\n\t\t\tthis.pickingPixel\n\t\t);\n\t\tthis.gl.bindFramebuffer(this.gl.FRAMEBUFFER, previousFramebuffer);\n\n\t\tconst index = decodePickingColor(this.pickingPixel);\n\t\tif (index === 0) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.pickingLookup.get(index) ?? null;\n\t}\n\n\tprivate buildZoneGeometry(feature: RentalZoneFeature): ZoneGeometry | null {\n\t\tconst vertices: number[] = [];\n\t\tlet minX = Number.POSITIVE_INFINITY;\n\t\tlet minY = Number.POSITIVE_INFINITY;\n\t\tlet maxX = Number.NEGATIVE_INFINITY;\n\t\tlet maxY = Number.NEGATIVE_INFINITY;\n\n\t\tconst appendPoly = (coords: Position[][]) => {\n\t\t\tif (!coords.length) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst mercatorCoords = coords.map((ring) =>\n\t\t\t\tring.map(([lng, lat]) => {\n\t\t\t\t\tconst merc = maplibregl.MercatorCoordinate.fromLngLat([lng, lat]);\n\t\t\t\t\tminX = Math.min(minX, merc.x);\n\t\t\t\t\tminY = Math.min(minY, merc.y);\n\t\t\t\t\tmaxX = Math.max(maxX, merc.x);\n\t\t\t\t\tmaxY = Math.max(maxY, merc.y);\n\t\t\t\t\treturn [merc.x, merc.y];\n\t\t\t\t})\n\t\t\t);\n\t\t\tconst data = flatten(mercatorCoords);\n\t\t\tconst indices = earcut(data.vertices, data.holes, data.dimensions);\n\t\t\tconst stride = data.dimensions;\n\n\t\t\tfor (const index of indices) {\n\t\t\t\tconst base = index * stride;\n\t\t\t\tvertices.push(data.vertices[base], data.vertices[base + 1]);\n\t\t\t}\n\t\t};\n\n\t\tfor (const polygon of feature.geometry.coordinates) {\n\t\t\tappendPoly(polygon);\n\t\t}\n\n\t\tif (vertices.length === 0) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn { vertices, minX, minY, maxX, maxY };\n\t}\n}\n","<script lang=\"ts\">\n\timport maplibregl from 'maplibre-gl';\n\timport type { PointLike } from 'maplibre-gl';\n\timport { getContext, onDestroy } from 'svelte';\n\n\timport { ZoneFillLayer } from './zone-fill-layer';\n\timport type { RentalZoneFeature } from './zone-types';\n\n\tclass Props {\n\t\tid!: string;\n\t\tfeatures!: RentalZoneFeature[];\n\t\tbeforeLayerId?: string;\n\t\topacity?: number;\n\t}\n\n\tconst ZONE_FILL_OPACITY = 0.4;\n\n\tlet { id, features, beforeLayerId, opacity = ZONE_FILL_OPACITY }: Props = $props();\n\n\ttype MapContext = { map: maplibregl.Map | null };\n\tconst ctx: MapContext = getContext('map');\n\n\tlet layerInstance = $state<ZoneFillLayer | null>(null);\n\tlet pendingRetryHandler: ((event?: unknown) => void) | null = null;\n\tlet currentFeatures: RentalZoneFeature[] | null = null;\n\tlet lastOpacity = opacity;\n\n\tconst ensureLayerInstance = () => {\n\t\tif (!layerInstance) {\n\t\t\tlayerInstance = new ZoneFillLayer({ id, opacity });\n\t\t}\n\t\treturn layerInstance;\n\t};\n\n\tconst disposeLayerInstance = () => {\n\t\tif (!layerInstance) {\n\t\t\treturn;\n\t\t}\n\t\tlayerInstance.cleanup();\n\t\tlayerInstance = null;\n\t\tcurrentFeatures = null;\n\t};\n\n\tconst getLayerIndex = (mapInstance: maplibregl.Map, layerId: string) => {\n\t\tconst style = mapInstance.getStyle();\n\t\tconst layers = style?.layers ?? [];\n\t\treturn layers.findIndex((layer) => layer.id === layerId);\n\t};\n\n\tconst clearPendingRetry = (map: maplibregl.Map | null | undefined) => {\n\t\tif (!map || !pendingRetryHandler) {\n\t\t\treturn;\n\t\t}\n\t\tmap.off('styledata', pendingRetryHandler);\n\t\tmap.off('idle', pendingRetryHandler);\n\t\tpendingRetryHandler = null;\n\t};\n\n\tconst removeFromMap = (map: maplibregl.Map | null | undefined) => {\n\t\tconst instance = layerInstance;\n\t\tif (!instance) {\n\t\t\treturn;\n\t\t}\n\t\tif (map && map.getLayer(id)) {\n\t\t\ttry {\n\t\t\t\tmap.removeLayer(id);\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('[ZoneLayer] failed to remove layer', error);\n\t\t\t}\n\t\t}\n\t\tinstance.setFeatures([]);\n\t\tdisposeLayerInstance();\n\t};\n\n\t$effect(() => {\n\t\tconst map = ctx.map;\n\t\tif (!map || features.length === 0) {\n\t\t\tclearPendingRetry(map);\n\t\t\tremoveFromMap(map);\n\t\t\tcurrentFeatures = null;\n\t\t\treturn;\n\t\t}\n\n\t\tconst layer = ensureLayerInstance();\n\t\tif (lastOpacity !== opacity) {\n\t\t\tlayer.setOpacity(opacity);\n\t\t\tlastOpacity = opacity;\n\t\t}\n\t\tif (features !== currentFeatures) {\n\t\t\tcurrentFeatures = features;\n\t\t\tlayer.setFeatures(features);\n\t\t}\n\n\t\tconst ensureLayerOrder = () => {\n\t\t\tif (!beforeLayerId || beforeLayerId === id) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!map.getLayer(id) || !map.getLayer(beforeLayerId)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst layerIndex = getLayerIndex(map, id);\n\t\t\tconst targetIndex = getLayerIndex(map, beforeLayerId);\n\t\t\tif (layerIndex === -1 || targetIndex === -1) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (layerIndex >= targetIndex) {\n\t\t\t\tmap.moveLayer(id, beforeLayerId);\n\t\t\t}\n\t\t};\n\n\t\tconst addLayerIfNeeded = () => {\n\t\t\tif (!map.getLayer(id)) {\n\t\t\t\ttry {\n\t\t\t\t\tconst before = beforeLayerId && map.getLayer(beforeLayerId) ? beforeLayerId : undefined;\n\t\t\t\t\tif (before) {\n\t\t\t\t\t\tmap.addLayer(layer, before);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmap.addLayer(layer);\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('[ZoneLayer] failed to add layer', error);\n\t\t\t\t}\n\t\t\t}\n\t\t\tensureLayerOrder();\n\t\t};\n\n\t\tconst attemptAddLayer = () => {\n\t\t\tif (!map.isStyleLoaded()) {\n\t\t\t\tif (!pendingRetryHandler) {\n\t\t\t\t\tconst retry = () => {\n\t\t\t\t\t\tif (!pendingRetryHandler) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmap.off('styledata', retry);\n\t\t\t\t\t\tmap.off('idle', retry);\n\t\t\t\t\t\tpendingRetryHandler = null;\n\t\t\t\t\t\tattemptAddLayer();\n\t\t\t\t\t};\n\t\t\t\t\tpendingRetryHandler = retry;\n\t\t\t\t\tmap.on('styledata', retry);\n\t\t\t\t\tmap.on('idle', retry);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\taddLayerIfNeeded();\n\t\t};\n\n\t\tconst handleStyleData = () => {\n\t\t\tattemptAddLayer();\n\t\t\tensureLayerOrder();\n\t\t};\n\n\t\tattemptAddLayer();\n\t\tmap.on('styledata', handleStyleData);\n\n\t\treturn () => {\n\t\t\tmap.off('styledata', handleStyleData);\n\t\t\tclearPendingRetry(map);\n\t\t};\n\t});\n\n\tonDestroy(() => {\n\t\tconst mapInstance = ctx.map;\n\t\tclearPendingRetry(mapInstance);\n\t\tremoveFromMap(mapInstance);\n\t\tdisposeLayerInstance();\n\t\tlastOpacity = opacity;\n\t});\n\n\texport function pick(point: PointLike) {\n\t\treturn layerInstance?.pickFeatureAt(point) ?? null;\n\t}\n</script>\n","<script lang=\"ts\">\n\timport { browser } from '$app/environment';\n\timport {\n\t\trentals,\n\t\ttype RentalFormFactor,\n\t\ttype RentalProviderGroup,\n\t\ttype RentalProvider,\n\t\ttype RentalStation,\n\t\ttype RentalVehicle,\n\t\ttype RentalZone,\n\t\ttype MultiPolygon\n\t} from '@motis-project/motis-client';\n\timport { lngLatToStr } from '$lib/lngLatToStr';\n\timport Control from '$lib/map/Control.svelte';\n\timport GeoJSON from '$lib/map/GeoJSON.svelte';\n\timport Layer from '$lib/map/Layer.svelte';\n\timport {\n\t\tDEFAULT_FORM_FACTOR,\n\t\tICON_TYPES,\n\t\tformFactorAssets,\n\t\tcolorizeIcon,\n\t\tgetIconBaseName,\n\t\tgetIconUrl,\n\t\tgetIconDimensions,\n\t\ttype IconType\n\t} from '$lib/map/rentals/assets';\n\timport { cn } from '$lib/utils';\n\timport polyline from '@mapbox/polyline';\n\timport maplibregl from 'maplibre-gl';\n\timport type { GeoJSONSource, MapLayerMouseEvent } from 'maplibre-gl';\n\timport { mount, onDestroy, unmount } from 'svelte';\n\timport type { FeatureCollection, Point, Position } from 'geojson';\n\timport RBush from 'rbush';\n\timport { point } from '@turf/helpers';\n\timport { booleanPointInPolygon } from '@turf/boolean-point-in-polygon';\n\timport StationPopup from '$lib/map/rentals/StationPopup.svelte';\n\timport VehiclePopup from '$lib/map/rentals/VehiclePopup.svelte';\n\timport ZonePopup from '$lib/map/rentals/ZonePopup.svelte';\n\timport {\n\t\tDEFAULT_COLOR,\n\t\tzoomScaledIconSize,\n\t\tzoomScaledTextOffset,\n\t\tzoomScaledTextSizeMedium,\n\t\tzoomScaledTextSizeSmall\n\t} from './style';\n\timport ZoneLayer from './ZoneLayer.svelte';\n\timport type {\n\t\tRentalZoneFeature,\n\t\tRentalZoneFeatureCollection,\n\t\tRentalZoneFeatureProperties\n\t} from './zone-types';\n\timport { SvelteSet } from 'svelte/reactivity';\n\n\tlet zoneLayerRef = $state<ZoneLayer | null>(null);\n\n\tlet {\n\t\tmap,\n\t\tbounds,\n\t\tzoom,\n\t\ttheme,\n\t\tdebug = false\n\t}: {\n\t\tmap: maplibregl.Map | undefined;\n\t\tbounds: maplibregl.LngLatBoundsLike | undefined;\n\t\tzoom: number;\n\t\ttheme: 'light' | 'dark';\n\t\tdebug?: boolean;\n\t} = $props();\n\n\tconst MIN_ZOOM = 11;\n\tconst FETCH_PADDING_RATIO = 0.5;\n\tconst STATION_SOURCE_ID = 'rentals-stations';\n\tconst STATION_ICON_LAYER_ID = 'rentals-stations-icons';\n\tconst VEHICLE_SOURCE_PREFIX = 'rentals-vehicles';\n\tconst VEHICLE_CLUSTER_RADIUS = 50;\n\tconst ZONE_LAYER_ID = 'rentals-zones';\n\n\tconst formFactors = Object.keys(formFactorAssets) as RentalFormFactor[];\n\n\tconst getIconId = (formFactor: RentalFormFactor, type: IconType, color: string) =>\n\t\t`${getIconBaseName(formFactor, type)}-${color}`;\n\n\ttype RentalsPayload = Awaited<ReturnType<typeof rentals>>['data'];\n\ttype RentalsPayloadData = NonNullable<RentalsPayload>;\n\n\ttype DisplayFilter = {\n\t\tproviderGroupId: string;\n\t\tproviderGroupName: string;\n\t\tformFactor: RentalFormFactor;\n\t\tcolor: string;\n\t};\n\n\tlet rentalsData = $state<RentalsPayload | null>(null);\n\tlet loadedBounds = $state<maplibregl.LngLatBounds | null>(null);\n\tlet requestToken = 0;\n\tlet displayFilter = $state<DisplayFilter | null>(null);\n\tlet iconsReady = $state(false);\n\tlet iconRequestToken = 0;\n\tlet activeIconIds = new SvelteSet<string>();\n\n\ttype StationFeatureProperties = {\n\t\ticon: string;\n\t\tavailable: number;\n\t\tproviderId: string;\n\t\tstationId: string;\n\t\tcolor: string;\n\t};\n\n\ttype VehicleFeatureProperties = {\n\t\ticon: string;\n\t\tclusterIcon: string;\n\t\tproviderId: string;\n\t\tvehicleId: string;\n\t\tcolor: string;\n\t};\n\n\ttype VehicleCollections = Record<\n\t\tRentalFormFactor,\n\t\tFeatureCollection<Point, VehicleFeatureProperties>\n\t>;\n\n\tconst vehicleLayerConfigs = formFactors.map((formFactor) => {\n\t\tconst slug = formFactor.toLowerCase();\n\t\treturn {\n\t\t\tformFactor,\n\t\t\tsourceId: `${VEHICLE_SOURCE_PREFIX}-${slug}`,\n\t\t\tclusterLayerId: `${VEHICLE_SOURCE_PREFIX}-${slug}-cluster`,\n\t\t\tpointLayerId: `${VEHICLE_SOURCE_PREFIX}-${slug}-point`\n\t\t};\n\t});\n\n\tconst buildProviderGroupOptions = (providerGroups: RentalProviderGroup[]): DisplayFilter[] =>\n\t\tproviderGroups\n\t\t\t.flatMap((group) =>\n\t\t\t\tgroup.formFactors.map((formFactor) => ({\n\t\t\t\t\tproviderGroupId: group.id,\n\t\t\t\t\tproviderGroupName: group.name,\n\t\t\t\t\tformFactor,\n\t\t\t\t\tcolor: group.color || DEFAULT_COLOR\n\t\t\t\t}))\n\t\t\t)\n\t\t\t.sort(\n\t\t\t\t(a, b) =>\n\t\t\t\t\ta.providerGroupName.localeCompare(b.providerGroupName, undefined, {\n\t\t\t\t\t\tsensitivity: 'base'\n\t\t\t\t\t}) || a.formFactor.localeCompare(b.formFactor, undefined, { sensitivity: 'base' })\n\t\t\t);\n\n\tlet providerGroupOptions = $derived(\n\t\trentalsData ? buildProviderGroupOptions(rentalsData.providerGroups) : []\n\t);\n\n\tlet providerGroupColors = $derived.by(\n\t\t() =>\n\t\t\tnew Map(\n\t\t\t\t(rentalsData?.providerGroups ?? []).map((group) => [group.id, group.color || DEFAULT_COLOR])\n\t\t\t)\n\t);\n\n\tlet providerColors = $derived.by(\n\t\t() =>\n\t\t\tnew Map(\n\t\t\t\t(rentalsData?.providers ?? []).map((provider) => [\n\t\t\t\t\tprovider.id,\n\t\t\t\t\tprovider.color || providerGroupColors.get(provider.groupId) || DEFAULT_COLOR\n\t\t\t\t])\n\t\t\t)\n\t);\n\n\ttype VehicleTypeFormFactors = Record<string, RentalFormFactor>;\n\n\tlet vehicleTypeFormFactorsByProviderId = $derived.by(\n\t\t(): Record<string, VehicleTypeFormFactors> => {\n\t\t\tif (!rentalsData) {\n\t\t\t\treturn {};\n\t\t\t}\n\t\t\treturn Object.fromEntries(\n\t\t\t\trentalsData.providers.map((provider) => [\n\t\t\t\t\tprovider.id,\n\t\t\t\t\tObject.fromEntries(provider.vehicleTypes.map((type) => [type.id, type.formFactor]))\n\t\t\t\t])\n\t\t\t);\n\t\t}\n\t);\n\n\tconst isSameFilter = (a: DisplayFilter | null, b: DisplayFilter | null) =>\n\t\ta?.providerGroupId === b?.providerGroupId && a?.formFactor === b?.formFactor;\n\n\tconst toggleFilter = (option: DisplayFilter) => {\n\t\tdisplayFilter = isSameFilter(displayFilter, option) ? null : option;\n\t};\n\n\tconst clamp = (value: number, min: number, max: number) => Math.min(max, Math.max(min, value));\n\n\tconst expandBounds = (value: maplibregl.LngLatBounds) => {\n\t\tconst sw = value.getSouthWest();\n\t\tconst ne = value.getNorthEast();\n\t\tconst padLng = (ne.lng - sw.lng) * FETCH_PADDING_RATIO;\n\t\tconst padLat = (ne.lat - sw.lat) * FETCH_PADDING_RATIO;\n\t\treturn new maplibregl.LngLatBounds(\n\t\t\t[clamp(sw.lng - padLng, -180, 180), clamp(sw.lat - padLat, -90, 90)],\n\t\t\t[clamp(ne.lng + padLng, -180, 180), clamp(ne.lat + padLat, -90, 90)]\n\t\t);\n\t};\n\n\tconst boundsContain = (outer: maplibregl.LngLatBounds | null, inner: maplibregl.LngLatBounds) =>\n\t\t!!outer && outer.contains(inner.getSouthWest()) && outer.contains(inner.getNorthEast());\n\n\tconst fetchRentals = async (mapBounds: maplibregl.LngLatBounds) => {\n\t\tconst expandedBounds = expandBounds(mapBounds);\n\t\tconst max = lngLatToStr(expandedBounds.getNorthWest());\n\t\tconst min = lngLatToStr(expandedBounds.getSouthEast());\n\t\tconst token = ++requestToken;\n\t\tconsole.debug('[Rentals] requesting rentals', { min, max });\n\n\t\tconst { data, error } = await rentals({ query: { max, min } });\n\t\tif (token !== requestToken) {\n\t\t\treturn;\n\t\t}\n\t\tif (error) {\n\t\t\tconsole.error('[Rentals] rentals request failed', error);\n\t\t\treturn;\n\t\t}\n\n\t\trentalsData = data;\n\t\tloadedBounds = expandedBounds;\n\t\tconst current = data;\n\t\tconsole.debug('[Rentals] received rentals', {\n\t\t\tproviders: current.providers.length,\n\t\t\tstations: current.stations.length,\n\t\t\tvehicles: current.vehicles.length,\n\t\t\tzones: current.zones.length\n\t\t});\n\t};\n\n\tconst collectFormFactorsByColor = (data: RentalsPayloadData) => {\n\t\t/* eslint-disable svelte/prefer-svelte-reactivity */\n\t\tconst formFactorsByColor = new Map<string, Set<RentalFormFactor>>();\n\t\tconst providerColorById = new Map<string, string>();\n\t\tconst providerGroupColorById = new Map<string, string>(\n\t\t\tdata.providerGroups.map((group) => [group.id, group.color || DEFAULT_COLOR])\n\t\t);\n\t\t/* eslint-enable svelte/prefer-svelte-reactivity */\n\n\t\tconst addFormFactor = (color: string, formFactor: RentalFormFactor) => {\n\t\t\tlet formFactors = formFactorsByColor.get(color);\n\t\t\tif (!formFactors) {\n\t\t\t\t/* eslint-disable-next-line svelte/prefer-svelte-reactivity */\n\t\t\t\tformFactors = new Set<RentalFormFactor>();\n\t\t\t\tformFactorsByColor.set(color, formFactors);\n\t\t\t}\n\t\t\tformFactors.add(formFactor);\n\t\t};\n\n\t\tfor (const provider of data.providers) {\n\t\t\tconst color = provider.color || providerGroupColorById.get(provider.groupId) || DEFAULT_COLOR;\n\t\t\tproviderColorById.set(provider.id, color);\n\t\t\tfor (const formFactor of provider.formFactors) {\n\t\t\t\taddFormFactor(color, formFactor);\n\t\t\t}\n\t\t}\n\t\tfor (const station of data.stations) {\n\t\t\tconst color =\n\t\t\t\tproviderColorById.get(station.providerId) ||\n\t\t\t\tproviderGroupColorById.get(station.providerGroupId) ||\n\t\t\t\tDEFAULT_COLOR;\n\t\t\tif (station.formFactors.length === 0) {\n\t\t\t\taddFormFactor(color, DEFAULT_FORM_FACTOR);\n\t\t\t}\n\t\t\tfor (const formFactor of station.formFactors) {\n\t\t\t\taddFormFactor(color, formFactor);\n\t\t\t}\n\t\t}\n\t\tfor (const vehicle of data.vehicles) {\n\t\t\tconst color =\n\t\t\t\tproviderColorById.get(vehicle.providerId) ||\n\t\t\t\tproviderGroupColorById.get(vehicle.providerGroupId) ||\n\t\t\t\tDEFAULT_COLOR;\n\t\t\taddFormFactor(color, vehicle.formFactor);\n\t\t}\n\t\treturn formFactorsByColor;\n\t};\n\n\tconst stationAvailability = (\n\t\tstation: RentalStation,\n\t\tformFactorsByProvider: Record<string, VehicleTypeFormFactors>,\n\t\tfilter: DisplayFilter | null\n\t) => {\n\t\tif (!filter) {\n\t\t\treturn station.numVehiclesAvailable;\n\t\t}\n\t\tconst formFactors = formFactorsByProvider[station.providerId];\n\t\tif (!formFactors) {\n\t\t\treturn station.numVehiclesAvailable;\n\t\t}\n\t\treturn Object.entries(station.vehicleTypesAvailable).reduce((sum, [typeId, count]) => {\n\t\t\treturn formFactors[typeId] === filter.formFactor ? sum + count : sum;\n\t\t}, 0);\n\t};\n\n\tlet stationFeatures = $derived.by((): FeatureCollection<Point, StationFeatureProperties> => {\n\t\tif (!rentalsData || !iconsReady) {\n\t\t\treturn { type: 'FeatureCollection', features: [] };\n\t\t}\n\t\tconst filter = displayFilter;\n\t\tconst stations = filter\n\t\t\t? rentalsData.stations.filter(\n\t\t\t\t\t(station) =>\n\t\t\t\t\t\tstation.providerGroupId === filter.providerGroupId &&\n\t\t\t\t\t\tstation.formFactors.includes(filter.formFactor)\n\t\t\t\t)\n\t\t\t: ([] as RentalStation[]);\n\t\treturn {\n\t\t\ttype: 'FeatureCollection',\n\t\t\tfeatures: stations.map((station) => {\n\t\t\t\tconst color =\n\t\t\t\t\tproviderColors.get(station.providerId) ||\n\t\t\t\t\tproviderGroupColors.get(station.providerGroupId) ||\n\t\t\t\t\tDEFAULT_COLOR;\n\t\t\t\tconst formFactor = filter\n\t\t\t\t\t? filter.formFactor\n\t\t\t\t\t: (station.formFactors[0] ?? DEFAULT_FORM_FACTOR);\n\t\t\t\treturn {\n\t\t\t\t\ttype: 'Feature',\n\t\t\t\t\tgeometry: {\n\t\t\t\t\t\ttype: 'Point',\n\t\t\t\t\t\tcoordinates: [station.lon, station.lat]\n\t\t\t\t\t},\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\ticon: getIconId(formFactor, 'station', color),\n\t\t\t\t\t\tavailable: stationAvailability(station, vehicleTypeFormFactorsByProviderId, filter),\n\t\t\t\t\t\tproviderId: station.providerId,\n\t\t\t\t\t\tstationId: station.id,\n\t\t\t\t\t\tcolor\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t})\n\t\t};\n\t});\n\n\tlet vehicleCollections = $derived.by((): VehicleCollections => {\n\t\tconst collections = formFactors.reduce((acc, formFactor) => {\n\t\t\tacc[formFactor] = { type: 'FeatureCollection', features: [] };\n\t\t\treturn acc;\n\t\t}, {} as VehicleCollections);\n\t\tif (!rentalsData || !iconsReady) {\n\t\t\treturn collections;\n\t\t}\n\t\tconst filter = displayFilter;\n\t\tconst vehicles = filter\n\t\t\t? rentalsData.vehicles.filter(\n\t\t\t\t\t(vehicle) =>\n\t\t\t\t\t\tvehicle.providerGroupId === filter.providerGroupId &&\n\t\t\t\t\t\tvehicle.formFactor === filter.formFactor\n\t\t\t\t)\n\t\t\t: ([] as RentalVehicle[]);\n\t\tvehicles\n\t\t\t.filter((vehicle) => !vehicle.stationId)\n\t\t\t.forEach((vehicle) => {\n\t\t\t\tconst collection = collections[vehicle.formFactor];\n\t\t\t\tconst color =\n\t\t\t\t\tproviderColors.get(vehicle.providerId) ||\n\t\t\t\t\tproviderGroupColors.get(vehicle.providerGroupId) ||\n\t\t\t\t\tDEFAULT_COLOR;\n\t\t\t\tcollection.features.push({\n\t\t\t\t\ttype: 'Feature',\n\t\t\t\t\tgeometry: {\n\t\t\t\t\t\ttype: 'Point',\n\t\t\t\t\t\tcoordinates: [vehicle.lon, vehicle.lat]\n\t\t\t\t\t},\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\ticon: getIconId(vehicle.formFactor, 'vehicle', color),\n\t\t\t\t\t\tclusterIcon: getIconId(vehicle.formFactor, 'cluster', color),\n\t\t\t\t\t\tproviderId: vehicle.providerId,\n\t\t\t\t\t\tvehicleId: vehicle.id,\n\t\t\t\t\t\tcolor\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\treturn collections;\n\t});\n\n\tconst buildZoneGeometry = (mp: MultiPolygon): RentalZoneFeature['geometry'] => {\n\t\treturn {\n\t\t\ttype: 'MultiPolygon',\n\t\t\tcoordinates: mp.map((polygon) =>\n\t\t\t\tpolygon.map((encoded) =>\n\t\t\t\t\tpolyline\n\t\t\t\t\t\t.decode(encoded.points, encoded.precision)\n\t\t\t\t\t\t.map(([lat, lng]) => [lng, lat] as Position)\n\t\t\t\t)\n\t\t\t)\n\t\t};\n\t};\n\n\tconst findMatchingRule = (\n\t\tzone: RentalZone,\n\t\tprovider: RentalProvider,\n\t\tformFactor: RentalFormFactor\n\t) => {\n\t\treturn zone.rules.find((rule) => {\n\t\t\tif (!rule.vehicleTypeIdxs.length) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn rule.vehicleTypeIdxs.some(\n\t\t\t\t(idx) => provider.vehicleTypes[idx]?.formFactor === formFactor\n\t\t\t);\n\t\t});\n\t};\n\n\tlet zoneFeatures = $derived.by((): RentalZoneFeatureCollection => {\n\t\tconst data = rentalsData;\n\t\tconst filter = displayFilter;\n\n\t\tif (!data || !filter) {\n\t\t\treturn { type: 'FeatureCollection', features: [] };\n\t\t}\n\n\t\tconst features: RentalZoneFeature[] = [];\n\t\tlet maxGeofencingZ = 0;\n\n\t\tdata.zones.forEach((zone, index) => {\n\t\t\tif (zone.providerGroupId !== filter.providerGroupId) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst provider = data.providers.find((candidate) => candidate.id === zone.providerId);\n\t\t\tif (!provider) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst rule = findMatchingRule(zone, provider, filter.formFactor);\n\t\t\tif (!rule) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfeatures.push({\n\t\t\t\ttype: 'Feature',\n\t\t\t\tgeometry: buildZoneGeometry(zone.area),\n\t\t\t\tproperties: {\n\t\t\t\t\tzoneIndex: index,\n\t\t\t\t\tproviderId: zone.providerId,\n\t\t\t\t\tz: zone.z,\n\t\t\t\t\trideEndAllowed: rule.rideEndAllowed && !rule.stationParking,\n\t\t\t\t\trideThroughAllowed: rule.rideThroughAllowed,\n\t\t\t\t\tstationArea: false\n\t\t\t\t}\n\t\t\t} satisfies RentalZoneFeature);\n\t\t\tif (zone.z > maxGeofencingZ) {\n\t\t\t\tmaxGeofencingZ = zone.z;\n\t\t\t}\n\t\t});\n\n\t\tconst stationAreaZ = maxGeofencingZ + 1;\n\t\tdata.stations.forEach((station, index) => {\n\t\t\tif (\n\t\t\t\t!station.stationArea ||\n\t\t\t\tstation.providerGroupId !== filter.providerGroupId ||\n\t\t\t\t!station.formFactors.includes(filter.formFactor)\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfeatures.push({\n\t\t\t\ttype: 'Feature',\n\t\t\t\tgeometry: buildZoneGeometry(station.stationArea),\n\t\t\t\tproperties: {\n\t\t\t\t\tstationIndex: index,\n\t\t\t\t\tproviderId: station.providerId,\n\t\t\t\t\tz: stationAreaZ,\n\t\t\t\t\trideEndAllowed: true,\n\t\t\t\t\trideThroughAllowed: true,\n\t\t\t\t\tstationArea: true\n\t\t\t\t}\n\t\t\t} satisfies RentalZoneFeature);\n\t\t});\n\n\t\tfeatures.sort((a, b) => b.properties.z - a.properties.z);\n\n\t\treturn {\n\t\t\ttype: 'FeatureCollection',\n\t\t\tfeatures\n\t\t};\n\t});\n\n\tlet zoneRTree = $derived.by(() => {\n\t\tconst data = rentalsData;\n\t\tconst rtree = new RBush<{\n\t\t\tminX: number;\n\t\t\tminY: number;\n\t\t\tmaxX: number;\n\t\t\tmaxY: number;\n\t\t\tfeature: RentalZoneFeature;\n\t\t}>();\n\t\tif (data && debug) {\n\t\t\trtree.load(\n\t\t\t\tzoneFeatures.features.map((feature) => {\n\t\t\t\t\tconst bbox =\n\t\t\t\t\t\tfeature.properties.zoneIndex !== undefined\n\t\t\t\t\t\t\t? data.zones[feature.properties.zoneIndex].bbox\n\t\t\t\t\t\t\t: data.stations[feature.properties.stationIndex!].bbox;\n\t\t\t\t\treturn {\n\t\t\t\t\t\tminX: bbox[0],\n\t\t\t\t\t\tminY: bbox[1],\n\t\t\t\t\t\tmaxX: bbox[2],\n\t\t\t\t\t\tmaxY: bbox[3],\n\t\t\t\t\t\tfeature\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t\treturn rtree;\n\t});\n\n\tconst createScopedId = (providerId: string, entityId: string) => `${providerId}::${entityId}`;\n\n\tlet providerById = $derived.by(\n\t\t(): Map<string, RentalProvider> => new Map(rentalsData?.providers.map((p) => [p.id, p]) ?? [])\n\t);\n\n\tlet stationById = $derived.by(\n\t\t(): Map<string, RentalStation> =>\n\t\t\tnew Map(rentalsData?.stations.map((s) => [createScopedId(s.providerId, s.id), s]) ?? [])\n\t);\n\n\tlet vehicleById = $derived.by(\n\t\t(): Map<string, RentalVehicle> =>\n\t\t\tnew Map(rentalsData?.vehicles.map((v) => [createScopedId(v.providerId, v.id), v]) ?? [])\n\t);\n\n\tconst lookupStation = (properties: StationFeatureProperties) => {\n\t\tconst key = createScopedId(properties.providerId, properties.stationId);\n\t\treturn {\n\t\t\tkey,\n\t\t\tprovider: providerById.get(properties.providerId),\n\t\t\tstation: stationById.get(key)\n\t\t};\n\t};\n\n\tconst lookupVehicle = (properties: VehicleFeatureProperties) => {\n\t\tconst key = createScopedId(properties.providerId, properties.vehicleId);\n\t\treturn {\n\t\t\tkey,\n\t\t\tprovider: providerById.get(properties.providerId),\n\t\t\tvehicle: vehicleById.get(key)\n\t\t};\n\t};\n\n\tconst lookupZoneOrStation = (properties: RentalZoneFeatureProperties) => {\n\t\tconst zone =\n\t\t\tproperties.zoneIndex !== undefined ? rentalsData?.zones[properties.zoneIndex] : undefined;\n\t\tconst station =\n\t\t\tproperties.stationIndex !== undefined\n\t\t\t\t? rentalsData?.stations[properties.stationIndex]\n\t\t\t\t: undefined;\n\t\treturn {\n\t\t\tkey:\n\t\t\t\tproperties.zoneIndex !== undefined\n\t\t\t\t\t? `zone-${properties.zoneIndex}`\n\t\t\t\t\t: `station-${properties.stationIndex}`,\n\t\t\tprovider: providerById.get(properties.providerId),\n\t\t\tzone,\n\t\t\tstation,\n\t\t\trideThroughAllowed: properties.rideThroughAllowed,\n\t\t\trideEndAllowed: properties.rideEndAllowed,\n\t\t\tstationArea: properties.stationArea\n\t\t};\n\t};\n\n\tconst createStationContent = (\n\t\tprovider: RentalProvider,\n\t\tstation: RentalStation,\n\t\tshowActions: boolean\n\t) => {\n\t\tconst container = document.createElement('div');\n\t\tconst component = mount(StationPopup, {\n\t\t\ttarget: container,\n\t\t\tprops: { provider, station, showActions, debug }\n\t\t});\n\t\treturn {\n\t\t\telement: container,\n\t\t\tdestroy: () => {\n\t\t\t\tunmount(component);\n\t\t\t}\n\t\t};\n\t};\n\n\tconst createVehicleContent = (\n\t\tprovider: RentalProvider,\n\t\tvehicle: RentalVehicle,\n\t\tshowActions: boolean\n\t) => {\n\t\tconst container = document.createElement('div');\n\t\tconst component = mount(VehiclePopup, {\n\t\t\ttarget: container,\n\t\t\tprops: { provider, vehicle, showActions, debug }\n\t\t});\n\t\treturn {\n\t\t\telement: container,\n\t\t\tdestroy: () => {\n\t\t\t\tunmount(component);\n\t\t\t}\n\t\t};\n\t};\n\n\tconst createZoneContent = (\n\t\tprovider: RentalProvider,\n\t\tzone: RentalZone | undefined,\n\t\tstation: RentalStation | undefined,\n\t\trideThroughAllowed: boolean,\n\t\trideEndAllowed: boolean,\n\t\tallZonesAtPoint: RentalZoneFeature[]\n\t) => {\n\t\tconst container = document.createElement('div');\n\t\tconst component = mount(ZonePopup, {\n\t\t\ttarget: container,\n\t\t\tprops: {\n\t\t\t\tprovider,\n\t\t\t\tzone,\n\t\t\t\tstation,\n\t\t\t\trideThroughAllowed,\n\t\t\t\trideEndAllowed,\n\t\t\t\tdebug,\n\t\t\t\tallZonesAtPoint,\n\t\t\t\tzoneData: rentalsData?.zones ?? [],\n\t\t\t\tstationData: rentalsData?.stations ?? []\n\t\t\t}\n\t\t});\n\t\treturn {\n\t\t\telement: container,\n\t\t\tdestroy: () => {\n\t\t\t\tunmount(component);\n\t\t\t}\n\t\t};\n\t};\n\n\tlet tooltipPopup: maplibregl.Popup | null = null;\n\tlet detailPopup: maplibregl.Popup | null = null;\n\tlet activeTooltipKey: string | null = null;\n\tlet activePopupKey: string | null = null;\n\tlet lastHoverCanvas: HTMLCanvasElement | null = null;\n\tlet tooltipContentDestroy: (() => void) | null = null;\n\tlet popupContentDestroy: (() => void) | null = null;\n\n\tconst ensureTooltipPopup = () => {\n\t\tif (!tooltipPopup) {\n\t\t\ttooltipPopup = new maplibregl.Popup({\n\t\t\t\tcloseButton: false,\n\t\t\t\tcloseOnClick: false,\n\t\t\t\toffset: 12,\n\t\t\t\tmaxWidth: 'none'\n\t\t\t});\n\t\t\ttooltipPopup.on('close', () => {\n\t\t\t\ttooltipContentDestroy?.();\n\t\t\t\ttooltipContentDestroy = null;\n\t\t\t\tactiveTooltipKey = null;\n\t\t\t});\n\t\t}\n\t\treturn tooltipPopup;\n\t};\n\n\tconst ensureDetailPopup = () => {\n\t\tif (!detailPopup) {\n\t\t\tdetailPopup = new maplibregl.Popup({\n\t\t\t\tcloseButton: true,\n\t\t\t\tcloseOnClick: true,\n\t\t\t\toffset: 12,\n\t\t\t\tmaxWidth: 'none'\n\t\t\t});\n\t\t\tdetailPopup.on('close', () => {\n\t\t\t\tpopupContentDestroy?.();\n\t\t\t\tpopupContentDestroy = null;\n\t\t\t\tactivePopupKey = null;\n\t\t\t});\n\t\t}\n\t\treturn detailPopup;\n\t};\n\n\tconst hideTooltip = () => {\n\t\ttooltipContentDestroy?.();\n\t\ttooltipContentDestroy = null;\n\t\tif (tooltipPopup) {\n\t\t\ttooltipPopup.remove();\n\t\t}\n\t\tactiveTooltipKey = null;\n\t};\n\n\tconst hidePopup = () => {\n\t\tpopupContentDestroy?.();\n\t\tpopupContentDestroy = null;\n\t\tif (detailPopup) {\n\t\t\tdetailPopup.remove();\n\t\t}\n\t\tactivePopupKey = null;\n\t};\n\n\tconst resetHoverCursor = () => {\n\t\tif (lastHoverCanvas) {\n\t\t\tlastHoverCanvas.style.cursor = '';\n\t\t\tlastHoverCanvas = null;\n\t\t}\n\t};\n\n\tconst showTooltip = (\n\t\ttargetMap: maplibregl.Map,\n\t\tlngLat: maplibregl.LngLatLike,\n\t\tkey: string,\n\t\tcreateContent: () => { element: HTMLElement; destroy: () => void }\n\t) => {\n\t\tconst popup = ensureTooltipPopup();\n\t\tif (activeTooltipKey !== key) {\n\t\t\ttooltipContentDestroy?.();\n\t\t\tconst { element, destroy } = createContent();\n\t\t\ttooltipContentDestroy = destroy;\n\t\t\tpopup.setDOMContent(element);\n\t\t\tactiveTooltipKey = key;\n\t\t}\n\t\tpopup.setLngLat(lngLat);\n\t\tif (!popup.isOpen()) {\n\t\t\tpopup.addTo(targetMap);\n\t\t}\n\t};\n\n\tconst showPopup = (\n\t\ttargetMap: maplibregl.Map,\n\t\tlngLat: maplibregl.LngLatLike,\n\t\tkey: string,\n\t\tcreateContent: () => { element: HTMLElement; destroy: () => void }\n\t) => {\n\t\tconst popup = ensureDetailPopup();\n\t\tpopupContentDestroy?.();\n\t\tconst { element, destroy } = createContent();\n\t\tpopupContentDestroy = destroy;\n\t\tpopup.setDOMContent(element);\n\t\tpopup.setLngLat(lngLat);\n\t\tif (!popup.isOpen()) {\n\t\t\tpopup.addTo(targetMap);\n\t\t}\n\t\tactivePopupKey = key;\n\t};\n\n\tconst createMouseMoveHandler =\n\t\t<T,>(\n\t\t\tlookup: (properties: T) => {\n\t\t\t\tkey: string;\n\t\t\t\tprovider: RentalProvider | undefined;\n\t\t\t\tstation?: RentalStation;\n\t\t\t\tvehicle?: RentalVehicle;\n\t\t\t},\n\t\t\tcreateContent: (\n\t\t\t\tprovider: RentalProvider,\n\t\t\t\tentity: RentalStation | RentalVehicle\n\t\t\t) => { element: HTMLElement; destroy: () => void }\n\t\t) =>\n\t\t(event: MapLayerMouseEvent, mapInstance: maplibregl.Map) => {\n\t\t\tconst feature = event.features?.[0];\n\t\t\tif (!mapInstance || !feature) {\n\t\t\t\thideTooltip();\n\t\t\t\tresetHoverCursor();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst result = lookup(feature.properties as T);\n\t\t\tconst entity = result.station || result.vehicle;\n\t\t\tif (!entity || !result.provider) {\n\t\t\t\thideTooltip();\n\t\t\t\tresetHoverCursor();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlastHoverCanvas = mapInstance.getCanvas();\n\t\t\tlastHoverCanvas.style.cursor = 'pointer';\n\t\t\tif (activePopupKey === result.key) {\n\t\t\t\thideTooltip();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tshowTooltip(mapInstance, event.lngLat, result.key, () =>\n\t\t\t\tcreateContent(result.provider!, entity)\n\t\t\t);\n\t\t};\n\n\tconst createMouseLeaveHandler =\n\t\t() => (_event: MapLayerMouseEvent, _mapInstance: maplibregl.Map) => {\n\t\t\tresetHoverCursor();\n\t\t\thideTooltip();\n\t\t};\n\n\tconst createClickHandler =\n\t\t<T,>(\n\t\t\tlookup: (properties: T) => {\n\t\t\t\tkey: string;\n\t\t\t\tprovider: RentalProvider | undefined;\n\t\t\t\tstation?: RentalStation;\n\t\t\t\tvehicle?: RentalVehicle;\n\t\t\t},\n\t\t\tcreateContent: (\n\t\t\t\tprovider: RentalProvider,\n\t\t\t\tentity: RentalStation | RentalVehicle\n\t\t\t) => { element: HTMLElement; destroy: () => void }\n\t\t) =>\n\t\t(event: MapLayerMouseEvent, mapInstance: maplibregl.Map) => {\n\t\t\tconst feature = event.features?.[0];\n\t\t\tif (!mapInstance || !feature) {\n\t\t\t\thidePopup();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst result = lookup(feature.properties as T);\n\t\t\tconst entity = result.station || result.vehicle;\n\t\t\tif (!entity || !result.provider) {\n\t\t\t\thidePopup();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\thideTooltip();\n\t\t\thidePopup();\n\t\t\tshowPopup(mapInstance, event.lngLat, result.key, () =>\n\t\t\t\tcreateContent(result.provider!, entity)\n\t\t\t);\n\t\t};\n\n\tconst handleStationMouseMove = createMouseMoveHandler(lookupStation, (provider, entity) =>\n\t\tcreateStationContent(provider, entity as RentalStation, true)\n\t);\n\tconst handleStationMouseLeave = createMouseLeaveHandler();\n\tconst handleStationClick = createClickHandler(lookupStation, (provider, entity) =>\n\t\tcreateStationContent(provider, entity as RentalStation, true)\n\t);\n\n\tconst handleClusterClick = async (event: MapLayerMouseEvent, mapInstance: maplibregl.Map) => {\n\t\tconst feature = event.features?.[0];\n\t\tconst clusterId = feature?.properties?.cluster_id;\n\t\tconst sourceId = feature?.source;\n\t\tif (!mapInstance || !feature || typeof clusterId !== 'number' || !sourceId) {\n\t\t\treturn;\n\t\t}\n\t\tconst source = mapInstance.getSource(sourceId) as GeoJSONSource | undefined;\n\t\tif (!source) {\n\t\t\treturn;\n\t\t}\n\n\t\thideTooltip();\n\t\thidePopup();\n\t\tmapInstance.getCanvas().style.cursor = '';\n\n\t\tconst zoom = await source.getClusterExpansionZoom(clusterId);\n\t\tmapInstance.easeTo({\n\t\t\tcenter: (feature.geometry as Point).coordinates as [number, number],\n\t\t\tzoom\n\t\t});\n\t};\n\n\tconst handleClusterMouseEnter = (_event: MapLayerMouseEvent, mapInstance: maplibregl.Map) => {\n\t\tmapInstance.getCanvas().style.cursor = 'pointer';\n\t};\n\n\tconst handleClusterMouseLeave = (_event: MapLayerMouseEvent, mapInstance: maplibregl.Map) => {\n\t\tmapInstance.getCanvas().style.cursor = '';\n\t};\n\n\tconst handleVehicleMouseMove = createMouseMoveHandler(lookupVehicle, (provider, entity) =>\n\t\tcreateVehicleContent(provider, entity as RentalVehicle, true)\n\t);\n\tconst handleVehicleMouseLeave = createMouseLeaveHandler();\n\tconst handleVehicleClick = createClickHandler(lookupVehicle, (provider, entity) =>\n\t\tcreateVehicleContent(provider, entity as RentalVehicle, true)\n\t);\n\n\tconst handleZoneClick = (\n\t\tevent: maplibregl.MapMouseEvent,\n\t\tmapInstance: maplibregl.Map,\n\t\tlayer: ZoneLayer\n\t) => {\n\t\tif (!mapInstance) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Check if there's a station or vehicle at this location (they should take priority)\n\t\tconst priorityLayers = [\n\t\t\tSTATION_ICON_LAYER_ID,\n\t\t\t...vehicleLayerConfigs.map((c) => c.pointLayerId),\n\t\t\t...vehicleLayerConfigs.map((c) => c.clusterLayerId)\n\t\t];\n\t\tconst priorityFeatures = mapInstance.queryRenderedFeatures(event.point, {\n\t\t\tlayers: priorityLayers\n\t\t});\n\t\tif (priorityFeatures.length > 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst feature = layer.pick(event.point);\n\t\tif (!feature) {\n\t\t\thidePopup();\n\t\t\treturn;\n\t\t}\n\n\t\tconst result = lookupZoneOrStation(feature.properties);\n\t\tif ((!result.zone && !result.station) || !result.provider) {\n\t\t\thidePopup();\n\t\t\treturn;\n\t\t}\n\n\t\tconst allZonesAtPoint = zoneRTree\n\t\t\t.search({\n\t\t\t\tminX: event.lngLat.lng,\n\t\t\t\tminY: event.lngLat.lat,\n\t\t\t\tmaxX: event.lngLat.lng,\n\t\t\t\tmaxY: event.lngLat.lat\n\t\t\t})\n\t\t\t.map((item) => item.feature)\n\t\t\t.filter((feature) =>\n\t\t\t\tbooleanPointInPolygon(point([event.lngLat.lng, event.lngLat.lat]), feature)\n\t\t\t)\n\t\t\t.sort((a, b) => b.properties.z - a.properties.z);\n\t\thideTooltip();\n\t\thidePopup();\n\t\tshowPopup(mapInstance, event.lngLat, result.key, () =>\n\t\t\tcreateZoneContent(\n\t\t\t\tresult.provider!,\n\t\t\t\tresult.zone,\n\t\t\t\tresult.station,\n\t\t\t\tresult.rideThroughAllowed,\n\t\t\t\tresult.rideEndAllowed,\n\t\t\t\tallZonesAtPoint\n\t\t\t)\n\t\t);\n\t};\n\n\t$effect(() => {\n\t\tif (!map || !bounds || zoom <= MIN_ZOOM) {\n\t\t\tif (zoom <= MIN_ZOOM) {\n\t\t\t\trentalsData = null;\n\t\t\t\tloadedBounds = null;\n\t\t\t\trequestToken += 1;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tconst mapBounds = maplibregl.LngLatBounds.convert(bounds);\n\t\tif (boundsContain(loadedBounds, mapBounds)) {\n\t\t\treturn;\n\t\t}\n\n\t\tvoid fetchRentals(mapBounds);\n\t});\n\n\t$effect(() => {\n\t\tif (\n\t\t\tdisplayFilter &&\n\t\t\t!providerGroupOptions.some((option) => isSameFilter(option, displayFilter))\n\t\t) {\n\t\t\tdisplayFilter = null;\n\t\t}\n\t});\n\n\tconst clearMapIcons = (mapInstance: maplibregl.Map | undefined) => {\n\t\tif (!mapInstance || activeIconIds.size === 0) {\n\t\t\treturn;\n\t\t}\n\t\tfor (const id of activeIconIds) {\n\t\t\tif (mapInstance.hasImage(id)) {\n\t\t\t\tmapInstance.removeImage(id);\n\t\t\t}\n\t\t}\n\t\tactiveIconIds = new SvelteSet<string>();\n\t};\n\n\t$effect(() => {\n\t\tconst mapInstance = map;\n\t\tconst data = rentalsData;\n\t\tif (!browser || !mapInstance) {\n\t\t\ticonsReady = false;\n\t\t\ticonRequestToken += 1;\n\t\t\tclearMapIcons(mapInstance);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!data) {\n\t\t\ticonsReady = false;\n\t\t\ticonRequestToken += 1;\n\t\t\tclearMapIcons(mapInstance);\n\t\t\treturn;\n\t\t}\n\n\t\tconst dataPayload = data as RentalsPayloadData;\n\t\tconst formFactorsByColor = collectFormFactorsByColor(dataPayload);\n\t\tif (formFactorsByColor.size === 0) {\n\t\t\ticonRequestToken += 1;\n\t\t\tclearMapIcons(mapInstance);\n\t\t\ticonsReady = true;\n\t\t\treturn;\n\t\t}\n\n\t\tconst token = ++iconRequestToken;\n\t\ticonsReady = false;\n\t\t/* eslint-disable-next-line svelte/prefer-svelte-reactivity */\n\t\tconst neededIds = new Set<string>();\n\t\tconst tasks: Promise<void>[] = [];\n\n\t\tformFactorsByColor.forEach((formFactors, color) => {\n\t\t\tformFactors.forEach((formFactor) => {\n\t\t\t\tICON_TYPES.forEach((type) => {\n\t\t\t\t\tconst dimensions = getIconDimensions(type);\n\t\t\t\t\tconst id = getIconId(formFactor, type, color);\n\t\t\t\t\tneededIds.add(id);\n\t\t\t\t\tif (!mapInstance.hasImage(id)) {\n\t\t\t\t\t\ttasks.push(\n\t\t\t\t\t\t\t(async () => {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tconst image = await colorizeIcon(getIconUrl(formFactor, type), color, dimensions);\n\t\t\t\t\t\t\t\t\tif (token !== iconRequestToken || !mapInstance) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!mapInstance.hasImage(id)) {\n\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\tmapInstance.addImage(id, image);\n\t\t\t\t\t\t\t\t\t\t} catch (addError) {\n\t\t\t\t\t\t\t\t\t\t\tconsole.error(`[Rentals] failed to register icon ${id}`, addError);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\t\tconsole.error(`[Rentals] failed to prepare icon ${id}`, error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})()\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\tvoid (async () => {\n\t\t\tawait Promise.allSettled(tasks);\n\t\t\tif (token !== iconRequestToken || !mapInstance) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst previousIds = Array.from(activeIconIds);\n\t\t\tfor (const id of previousIds) {\n\t\t\t\tif (!neededIds.has(id) && mapInstance.hasImage(id)) {\n\t\t\t\t\tmapInstance.removeImage(id);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst newActiveIds = new SvelteSet<string>();\n\t\t\tneededIds.forEach((id) => {\n\t\t\t\tif (mapInstance.hasImage(id)) {\n\t\t\t\t\tnewActiveIds.add(id);\n\t\t\t\t}\n\t\t\t});\n\t\t\tactiveIconIds = newActiveIds;\n\t\t\ticonsReady = neededIds.size === newActiveIds.size;\n\t\t})();\n\t});\n\n\t$effect(() => {\n\t\tconst mapInstance = map;\n\t\tconst layer = zoneLayerRef;\n\t\tconst hasZones = zoneFeatures.features.length > 0;\n\t\tif (!mapInstance || !layer || !hasZones) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst handler = (event: maplibregl.MapMouseEvent) => {\n\t\t\thandleZoneClick(event, mapInstance, layer);\n\t\t};\n\t\tmapInstance.on('click', handler);\n\t\treturn () => {\n\t\t\tmapInstance.off('click', handler);\n\t\t};\n\t});\n\n\t$effect(() => {\n\t\tif (!rentalsData) {\n\t\t\thideTooltip();\n\t\t\thidePopup();\n\t\t\tresetHoverCursor();\n\t\t\treturn;\n\t\t}\n\t\tif (\n\t\t\tactiveTooltipKey &&\n\t\t\t!stationById.has(activeTooltipKey) &&\n\t\t\t!vehicleById.has(activeTooltipKey)\n\t\t) {\n\t\t\thideTooltip();\n\t\t}\n\t\tif (activePopupKey && !stationById.has(activePopupKey) && !vehicleById.has(activePopupKey)) {\n\t\t\thidePopup();\n\t\t}\n\t});\n\n\tonDestroy(() => {\n\t\trequestToken += 1;\n\t\thideTooltip();\n\t\thidePopup();\n\t\tresetHoverCursor();\n\t\tclearMapIcons(map);\n\t\ttooltipPopup = null;\n\t\tdetailPopup = null;\n\t});\n</script>\n\n{#if zoneFeatures.features.length > 0}\n\t{@const beforeLayerId = vehicleLayerConfigs[0]?.pointLayerId ?? STATION_ICON_LAYER_ID}\n\t<ZoneLayer\n\t\tbind:this={zoneLayerRef}\n\t\tid={ZONE_LAYER_ID}\n\t\tfeatures={zoneFeatures.features}\n\t\t{beforeLayerId}\n\t\topacity={theme === 'dark' ? 0.3 : 0.4}\n\t/>\n{/if}\n\n<GeoJSON id={STATION_SOURCE_ID} data={stationFeatures}>\n\t<Layer\n\t\tid={STATION_ICON_LAYER_ID}\n\t\tbeforeLayerId=\"\"\n\t\ttype=\"symbol\"\n\t\tfilter={true}\n\t\tlayout={{\n\t\t\t'icon-image': ['get', 'icon'],\n\t\t\t'icon-size': zoomScaledIconSize,\n\t\t\t'icon-allow-overlap': false,\n\t\t\t'icon-ignore-placement': true,\n\t\t\t'text-field': ['to-string', ['get', 'available']],\n\t\t\t'text-allow-overlap': false,\n\t\t\t'text-ignore-placement': true,\n\t\t\t'text-anchor': 'center',\n\t\t\t'text-offset': zoomScaledTextOffset,\n\t\t\t'text-size': zoomScaledTextSizeMedium,\n\t\t\t'text-font': ['Noto Sans Regular']\n\t\t}}\n\t\tonmousemove={handleStationMouseMove}\n\t\tonmouseleave={handleStationMouseLeave}\n\t\tonclick={handleStationClick}\n\t\tpaint={{\n\t\t\t'text-color': '#000'\n\t\t}}\n\t/>\n</GeoJSON>\n\n{#each vehicleLayerConfigs as config (config.sourceId)}\n\t<GeoJSON\n\t\tid={config.sourceId}\n\t\tdata={vehicleCollections[config.formFactor]}\n\t\toptions={{\n\t\t\tcluster: true,\n\t\t\tclusterRadius: VEHICLE_CLUSTER_RADIUS,\n\t\t\tclusterProperties: {\n\t\t\t\tcolor: ['coalesce', ['get', 'color']],\n\t\t\t\ticon: ['coalesce', ['get', 'icon']],\n\t\t\t\tclusterIcon: ['coalesce', ['get', 'clusterIcon']]\n\t\t\t}\n\t\t}}\n\t>\n\t\t<Layer\n\t\t\tid={config.clusterLayerId}\n\t\t\tbeforeLayerId={STATION_ICON_LAYER_ID}\n\t\t\ttype=\"symbol\"\n\t\t\tfilter={['has', 'point_count']}\n\t\t\tlayout={{\n\t\t\t\t'icon-image': ['get', 'clusterIcon'],\n\t\t\t\t'icon-size': zoomScaledIconSize,\n\t\t\t\t'icon-allow-overlap': true,\n\t\t\t\t'icon-ignore-placement': true,\n\t\t\t\t'text-field': ['to-string', ['get', 'point_count']],\n\t\t\t\t'text-allow-overlap': true,\n\t\t\t\t'text-ignore-placement': true,\n\t\t\t\t'text-anchor': 'center',\n\t\t\t\t'text-offset': zoomScaledTextOffset,\n\t\t\t\t'text-size': zoomScaledTextSizeSmall,\n\t\t\t\t'text-font': ['Noto Sans Regular']\n\t\t\t}}\n\t\t\tpaint={{\n\t\t\t\t'text-color': '#000'\n\t\t\t}}\n\t\t\tonclick={handleClusterClick}\n\t\t\tonmouseenter={handleClusterMouseEnter}\n\t\t\tonmouseleave={handleClusterMouseLeave}\n\t\t/>\n\t\t<Layer\n\t\t\tid={config.pointLayerId}\n\t\t\tbeforeLayerId={config.clusterLayerId}\n\t\t\ttype=\"symbol\"\n\t\t\tfilter={['!', ['has', 'point_count']]}\n\t\t\tlayout={{\n\t\t\t\t'icon-image': ['get', 'icon'],\n\t\t\t\t'icon-size': zoomScaledIconSize,\n\t\t\t\t'icon-allow-overlap': true,\n\t\t\t\t'icon-ignore-placement': true\n\t\t\t}}\n\t\t\tpaint={{}}\n\t\t\tonmousemove={handleVehicleMouseMove}\n\t\t\tonmouseleave={handleVehicleMouseLeave}\n\t\t\tonclick={handleVehicleClick}\n\t\t/>\n\t</GeoJSON>\n{/each}\n\n{#if providerGroupOptions.length > 0}\n\t<Control position=\"top-right\" class=\"mb-5\">\n\t\t<div class=\"flex flex-col items-end space-y-2\">\n\t\t\t{#each providerGroupOptions as option (`${option.providerGroupId}::${option.formFactor}`)}\n\t\t\t\t{@const active = isSameFilter(displayFilter, option)}\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\ttitle={`${option.providerGroupName} (${formFactorAssets[option.formFactor].label})`}\n\t\t\t\t\tclass={cn(\n\t\t\t\t\t\t'inline-flex max-w-72 items-center gap-2 rounded-md border-2 px-3 py-1.5 text-sm font-semibold transition-colors focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-500',\n\t\t\t\t\t\tactive\n\t\t\t\t\t\t\t? 'border-blue-600 bg-accent text-accent-foreground'\n\t\t\t\t\t\t\t: 'border-muted bg-popover text-foreground hover:bg-accent hover:text-accent-foreground'\n\t\t\t\t\t)}\n\t\t\t\t\tonclick={() => toggleFilter(option)}\n\t\t\t\t\taria-pressed={active}\n\t\t\t\t>\n\t\t\t\t\t<span class=\"truncate\">{option.providerGroupName}</span>\n\t\t\t\t\t<span class=\"flex items-center gap-1 text-xs font-medium\">\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\tclass=\"h-4 w-4 fill-current\"\n\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\tfocusable=\"false\"\n\t\t\t\t\t\t\tstyle={`color: ${option.color}`}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<use href={`#${formFactorAssets[option.formFactor].svg}`} />\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</span>\n\t\t\t\t</button>\n\t\t\t{/each}\n\t\t</div>\n\t</Control>\n{/if}\n","<script lang=\"ts\">\n\timport Layer from '$lib/map/Layer.svelte';\n\timport GeoJSON from '$lib/map/GeoJSON.svelte';\n\timport type { Itinerary, Leg } from '@motis-project/motis-client';\n\timport { onClickStop } from '../../utils';\n\timport { getColor } from '../../modeStyle';\n\n\tlet {\n\t\titinerary = $bindable(),\n\t\ttheme\n\t}: {\n\t\titinerary: Itinerary;\n\t\ttheme: 'dark' | 'light';\n\t} = $props();\n\n\tfunction stopsToGeoJSON(legs: Leg[]): GeoJSON.GeoJSON {\n\t\treturn {\n\t\t\ttype: 'FeatureCollection',\n\t\t\tfeatures: legs\n\t\t\t\t.filter((l) => {\n\t\t\t\t\treturn l.mode !== 'WALK' && l.mode !== 'BIKE' && l.mode !== 'CAR';\n\t\t\t\t})\n\t\t\t\t.flatMap((l) => {\n\t\t\t\t\tconst stops = [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'Feature' as const,\n\t\t\t\t\t\t\tgeometry: { type: 'Point' as const, coordinates: [l.from.lon, l.from.lat] },\n\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\tstopId: l.from.stopId,\n\t\t\t\t\t\t\t\tname: l.from.name,\n\t\t\t\t\t\t\t\ttime: l.from.arrival ?? l.from.departure,\n\t\t\t\t\t\t\t\tcolor: getColor(l)[0]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'Feature' as const,\n\t\t\t\t\t\t\tgeometry: { type: 'Point' as const, coordinates: [l.to.lon, l.to.lat] },\n\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\tstopId: l.to.stopId,\n\t\t\t\t\t\t\t\tname: l.to.name,\n\t\t\t\t\t\t\t\ttime: l.to.arrival,\n\t\t\t\t\t\t\t\tcolor: getColor(l)[0]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\t\t\t\t\tconst intermediateStops = l.intermediateStops\n\t\t\t\t\t\t? l.intermediateStops.map((s) => ({\n\t\t\t\t\t\t\t\ttype: 'Feature' as const,\n\t\t\t\t\t\t\t\tgeometry: {\n\t\t\t\t\t\t\t\t\ttype: 'Point' as const,\n\t\t\t\t\t\t\t\t\tcoordinates: [s.lon, s.lat]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\tstopId: s.stopId,\n\t\t\t\t\t\t\t\t\tname: s.name,\n\t\t\t\t\t\t\t\t\ttime: s.arrival,\n\t\t\t\t\t\t\t\t\tcolor: getColor(l)[0]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t: [];\n\n\t\t\t\t\treturn [...stops, ...intermediateStops];\n\t\t\t\t})\n\t\t};\n\t}\n\tconst geojson = $derived(stopsToGeoJSON(itinerary.legs));\n</script>\n\n<GeoJSON id=\"stops\" data={geojson}>\n\t<Layer\n\t\tid=\"stops\"\n\t\ttype=\"circle\"\n\t\tlayout={{}}\n\t\tfilter={['all']}\n\t\tpaint={{\n\t\t\t'circle-radius': 5,\n\t\t\t'circle-color': 'white',\n\t\t\t'circle-stroke-width': 4,\n\t\t\t'circle-stroke-color': ['get', 'color']\n\t\t}}\n\t\tonclick={(e) => {\n\t\t\tconst s = e.features?.[0];\n\t\t\tif (!s?.properties?.stopId) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconsole.log('Clicked Stop:', s.properties.name);\n\t\t\tonClickStop(s.properties.name, s.properties.stopId, new Date(s.properties.time));\n\t\t}}\n\t\tonmousemove={(_, map) => (map.getCanvas().style.cursor = 'pointer')}\n\t\tonmouseleave={(_, map) => (map.getCanvas().style.cursor = '')}\n\t/>\n\t<Layer\n\t\tid=\"intermediate-stops-name\"\n\t\ttype=\"symbol\"\n\t\tlayout={{\n\t\t\t'text-field': ['get', 'name'],\n\t\t\t'text-font': ['Noto Sans Regular'],\n\t\t\t'text-size': 12,\n\t\t\t'text-offset': [0, 1],\n\t\t\t'text-anchor': 'top'\n\t\t}}\n\t\tfilter={true}\n\t\tpaint={{\n\t\t\t'text-halo-width': 2,\n\t\t\t// Use a darker hue of the line color for dark theme and a lighter hue for light theme\n\t\t\t'text-halo-color': [\n\t\t\t\t'interpolate-hcl',\n\t\t\t\t['linear'],\n\t\t\t\t0.6,\n\t\t\t\t0,\n\t\t\t\t['get', 'color'],\n\t\t\t\t1,\n\t\t\t\ttheme == 'dark' ? '#000' : '#fff'\n\t\t\t],\n\t\t\t'text-color': theme == 'dark' ? '#fff' : '#000'\n\t\t}}\n\t/>\n</GeoJSON>\n","import { browser } from '$app/environment';\n\nexport function createTripIcon(size: number): HTMLCanvasElement | undefined {\n\tif (!browser) {\n\t\treturn undefined;\n\t}\n\n\tconst border = (2 / 64) * size;\n\tconst padding = (size - size / 2) / 2 + border;\n\tconst innerSize = size - 2 * padding;\n\tconst mid = size / 2;\n\tconst rad = innerSize / 3.5;\n\tconst cv = document.createElement('canvas');\n\tcv.width = size;\n\tcv.height = size;\n\tconst ctx = cv.getContext('2d', { alpha: true });\n\n\tif (!ctx) {\n\t\treturn cv;\n\t}\n\n\tctx.beginPath();\n\n\tctx.arc(padding + rad, mid, rad, (1 / 2) * Math.PI, (3 / 2) * Math.PI, false);\n\n\tctx.bezierCurveTo(padding + rad + rad, mid - rad, size - padding, mid, size - padding, mid);\n\tctx.bezierCurveTo(size - padding, mid, padding + rad + rad, mid + rad, padding + rad, mid + rad);\n\n\tctx.closePath();\n\n\tctx.fillStyle = 'rgba(255, 0, 0, 0.7)';\n\tctx.fill();\n\tctx.lineWidth = border;\n\tctx.strokeStyle = 'rgba(120, 120, 120, 1.0)';\n\tctx.stroke();\n\treturn cv;\n}\n","export type RGBA = [number, number, number, number];\nexport function hexToRgb(hex: string): RGBA {\n\tconst result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n\tif (!result) {\n\t\tthrow `${hex} is not a hex color #RRGGBB`;\n\t}\n\treturn [parseInt(result[1], 16), parseInt(result[2], 16), parseInt(result[3], 16), 255];\n}\n\nexport function rgbToHex(rgba: RGBA): string {\n\treturn '#' + ((1 << 24) | (rgba[0] << 16) | (rgba[1] << 8) | rgba[2]).toString(16).slice(1);\n}\n\nexport const getDelayColor = (delay: number, realTime: boolean): RGBA => {\n\tdelay = delay / 60000;\n\tif (!realTime) {\n\t\treturn [100, 100, 100, 255];\n\t}\n\tif (delay <= -30) {\n\t\treturn [255, 0, 255, 255];\n\t} else if (delay <= -6) {\n\t\treturn [138, 82, 254, 255];\n\t} else if (delay <= 3) {\n\t\treturn [69, 194, 74, 255];\n\t} else if (delay <= 5) {\n\t\treturn [255, 237, 0, 255];\n\t} else if (delay <= 10) {\n\t\treturn [255, 102, 0, 255];\n\t} else if (delay <= 15) {\n\t\treturn [255, 48, 71, 255];\n\t}\n\treturn [163, 0, 10, 255];\n};\n","<script lang=\"ts\">\n\timport { lngLatToStr } from '$lib/lngLatToStr';\n\timport { MapboxOverlay } from '@deck.gl/mapbox';\n\timport { IconLayer } from '@deck.gl/layers';\n\timport { createTripIcon } from '$lib/map/createTripIcon';\n\timport maplibregl from 'maplibre-gl';\n\timport { onDestroy, onMount, untrack } from 'svelte';\n\timport { formatTime } from './toDateTime';\n\timport { onClickTrip } from './utils';\n\timport { getDelayColor, rgbToHex } from './Color';\n\timport type { MetaData } from './types';\n\timport Control from './map/Control.svelte';\n\timport { SvelteMap } from 'svelte/reactivity';\n\timport { client } from '@motis-project/motis-client';\n\tlet {\n\t\tmap,\n\t\tbounds,\n\t\tzoom,\n\t\tcolorMode\n\t}: {\n\t\tmap: maplibregl.Map | undefined;\n\t\tbounds: maplibregl.LngLatBoundsLike | undefined;\n\t\tzoom: number;\n\t\tcolorMode: 'rt' | 'route' | 'mode' | 'none';\n\t} = $props();\n\n\t//QUERY\n\tlet startTime = $state(new Date(Date.now()));\n\tlet endTime = $derived(new Date(startTime.getTime() + 180000));\n\tlet canceled = $derived(colorMode === 'none');\n\tlet query = $derived.by(() => {\n\t\tif (!bounds || !zoom) return null;\n\t\tconst b = maplibregl.LngLatBounds.convert(bounds);\n\t\tconst max = lngLatToStr(b.getNorthWest());\n\t\tconst min = lngLatToStr(b.getSouthEast());\n\t\treturn {\n\t\t\tmin,\n\t\t\tmax,\n\t\t\tstartTime: startTime.toISOString(),\n\t\t\tendTime: endTime.toISOString(),\n\t\t\tzoom\n\t\t};\n\t});\n\n\t//TRANSFERABLES\n\tlet isProcessing = false;\n\tconst TRIPS_NUM = 12000;\n\tconst positions = new Float64Array(TRIPS_NUM * 2);\n\tconst angles = new Float32Array(TRIPS_NUM);\n\tconst colors = new Uint8Array(TRIPS_NUM * 3);\n\tconst DATA = {\n\t\tlength: TRIPS_NUM,\n\t\tpositions,\n\t\tcolors,\n\t\tangles\n\t};\n\n\t//INTERACTION\n\tconst popup = new maplibregl.Popup({\n\t\tcloseButton: false,\n\t\tcloseOnClick: false,\n\t\tmaxWidth: 'none'\n\t});\n\ttype HoverEvent = {\n\t\tindex?: number;\n\t\tcoordinate?: number[];\n\t};\n\n\ttype ClickEvent = {\n\t\tindex: number;\n\t};\n\n\tlet hoverCoordinate: maplibregl.LngLatLike | null = $state(null);\n\tlet activeHoverIndex: number | null = $state(null);\n\n\tconst onHover = ({ index, coordinate }: HoverEvent) => {\n\t\tif (index == null || index === -1 || !coordinate) {\n\t\t\tactiveHoverIndex = null; // Clear index\n\t\t\thoverCoordinate = null;\n\t\t\tpopup.remove();\n\t\t\tif (map) map.getCanvas().style.cursor = '';\n\t\t\treturn;\n\t\t}\n\t\tif (index !== activeHoverIndex) {\n\t\t\tmetadata = undefined;\n\t\t}\n\t\thoverCoordinate = coordinate as maplibregl.LngLatLike;\n\t\tactiveHoverIndex = index;\n\t\tif (metaDataMap.has(index)) {\n\t\t\tmetadata = metaDataMap.get(index);\n\t\t}\n\t};\n\tconst onClick = ({ index }: ClickEvent) => {\n\t\tif (index !== -1 && metadata) {\n\t\t\tonClickTrip(metadata.id);\n\t\t}\n\t};\n\tconst updatePopup = (trip: MetaData) => {\n\t\tif (!trip || !map || !hoverCoordinate) return;\n\n\t\tmap.getCanvas().style.cursor = 'pointer';\n\t\tconst content = trip.realtime\n\t\t\t? `<strong>${trip.displayName}</strong><br>\n           <span style=\"color: ${rgbToHex(getDelayColor(trip.departureDelay, true))}\">${formatTime(new Date(trip.departure), trip.tz)}</span>\n           <span ${trip.departureDelay != 0 ? 'class=\"line-through\"' : ''}>${formatTime(new Date(trip.scheduledDeparture), trip.tz)}</span> ${trip.from}<br>\n           <span style=\"color: ${rgbToHex(getDelayColor(trip.arrivalDelay, true))}\">${formatTime(new Date(trip.arrival), trip.tz)}</span>\n           <span ${trip.arrivalDelay != 0 ? 'class=\"line-through\"' : ''}>${formatTime(new Date(trip.scheduledArrival), trip.tz)}</span> ${trip.to}`\n\t\t\t: `<strong>${trip.displayName}</strong><br>\n           ${formatTime(new Date(trip.departure), trip.tz)} ${trip.from}<br>\n           ${formatTime(new Date(trip.arrival), trip.tz)} ${trip.to}`;\n\n\t\tpopup.setLngLat(hoverCoordinate).setHTML(content).addTo(map);\n\t};\n\n\t//ANIMATION\n\tconst TripIcon = createTripIcon(128);\n\tconst IconMapping = {\n\t\tmarker: {\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\twidth: 128,\n\t\t\theight: 128,\n\t\t\tanchorY: 64,\n\t\t\tanchorX: 64,\n\t\t\tmask: true\n\t\t}\n\t};\n\tconst createLayer = () => {\n\t\tif (!DATA.positions || DATA.positions.byteLength === 0) return;\n\t\treturn new IconLayer({\n\t\t\tid: 'trips-layer',\n\t\t\tdata: {\n\t\t\t\tlength: DATA.length,\n\t\t\t\tattributes: {\n\t\t\t\t\tgetPosition: { value: DATA.positions, size: 2 },\n\t\t\t\t\tgetAngle: { value: DATA.angles, size: 1 },\n\t\t\t\t\tgetColor: { value: DATA.colors, size: 3, normalized: true }\n\t\t\t\t}\n\t\t\t},\n\t\t\tbeforeId: 'road-name-text',\n\t\t\t// @ts-expect-error: canvas element seems to work fine\n\t\t\ticonAtlas: TripIcon,\n\t\t\ticonMapping: IconMapping,\n\t\t\tpickable: colorMode != 'none',\n\t\t\tsizeScale: 5,\n\t\t\tgetSize: 10,\n\t\t\tgetIcon: (_) => 'marker',\n\t\t\tcolorFormat: 'RGB',\n\t\t\tvisible: colorMode !== 'none',\n\t\t\tuseDevicePixels: false,\n\t\t\tparameters: { depthTest: false }\n\t\t});\n\t};\n\tlet animationId: number;\n\tconst animate = () => {\n\t\tif (!DATA.positions || DATA.positions.length === 0) return;\n\t\tworker.postMessage(\n\t\t\t{\n\t\t\t\ttype: 'update',\n\t\t\t\tcolorMode,\n\t\t\t\tpositions: DATA.positions,\n\t\t\t\tindex:\n\t\t\t\t\tactiveHoverIndex !== null && !metaDataMap.has(activeHoverIndex) ? activeHoverIndex : -1,\n\t\t\t\tangles: DATA.angles,\n\t\t\t\tcolors: DATA.colors,\n\t\t\t\tlength: DATA.length\n\t\t\t},\n\t\t\t[DATA.positions.buffer, DATA.angles.buffer, DATA.colors.buffer]\n\t\t);\n\t};\n\n\t// UPDATE\n\t$effect(() => {\n\t\tif (!query || isProcessing || canceled) return;\n\t\tuntrack(() => {\n\t\t\tisProcessing = true;\n\t\t\tworker.postMessage({ type: 'fetch', query });\n\t\t});\n\t});\n\t$effect(() => {\n\t\tif (activeHoverIndex && hoverCoordinate && metadata) {\n\t\t\tupdatePopup(metadata);\n\t\t}\n\t});\n\tsetInterval(() => {\n\t\tif (query && colorMode !== 'none') {\n\t\t\tstartTime = new Date();\n\t\t}\n\t}, 60000);\n\n\t//SETUP\n\tlet status = $state();\n\tlet overlay: MapboxOverlay;\n\tlet worker: Worker;\n\tlet metadata: MetaData | undefined = $state();\n\tconst metaDataMap = new SvelteMap<number, MetaData>();\n\n\tonMount(() => {\n\t\tworker = new Worker(new URL('tripsWorker.ts', import.meta.url), { type: 'module' });\n\t\tworker.postMessage({ type: 'init', baseUrl: client.getConfig().baseUrl });\n\t\tworker.onmessage = (e) => {\n\t\t\tif (e.data.type == 'fetch-complete') {\n\t\t\t\tmetaDataMap.clear();\n\t\t\t\tstatus = e.data.status;\n\t\t\t\tisProcessing = false;\n\t\t\t} else {\n\t\t\t\tconst { positions, angles, length, colors, metadata: incomingMetaData } = e.data;\n\t\t\t\tDATA.positions = new Float64Array(positions.buffer);\n\t\t\t\tDATA.angles = new Float32Array(angles.buffer);\n\t\t\t\tDATA.colors = new Uint8Array(colors.buffer);\n\t\t\t\tDATA.length = length;\n\t\t\t\tif (activeHoverIndex !== null) {\n\t\t\t\t\tif (e.data.metadata) {\n\t\t\t\t\t\tmetaDataMap.set(activeHoverIndex, incomingMetaData);\n\t\t\t\t\t\tmetadata = e.data.metadata;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmetadata = metaDataMap.get(activeHoverIndex);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tmetadata = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t\toverlay.setProps({ layers: [createLayer()] });\n\t\t\tif (canceled) {\n\t\t\t\tcancelAnimationFrame(animationId);\n\t\t\t} else {\n\t\t\t\tanimationId = requestAnimationFrame(animate);\n\t\t\t}\n\t\t};\n\t\toverlay = new MapboxOverlay({\n\t\t\tinterleaved: true,\n\t\t\tonHover,\n\t\t\tonClick\n\t\t});\n\t});\n\t$effect(() => {\n\t\tif (!map || !overlay) return;\n\t\tmap.addControl(overlay);\n\t});\n\tonDestroy(() => {\n\t\tif (animationId) cancelAnimationFrame(animationId);\n\t\tif (overlay) map?.removeControl(overlay);\n\t\tworker.terminate();\n\t\tpopup.remove();\n\t});\n</script>\n\n{#if status && status !== 200}\n\t<Control position=\"bottom-left\">trips response status: {status}</Control>\n{/if}\n","<script lang=\"ts\">\n\timport { X, Palette, Rss, Ban, LocateFixed, TrainFront } from '@lucide/svelte';\n\timport { getStyle } from '$lib/map/style';\n\timport Map from '$lib/map/Map.svelte';\n\timport Control from '$lib/map/Control.svelte';\n\timport SearchMask from '$lib/SearchMask.svelte';\n\timport { parseLocation, posToLocation, type Location } from '$lib/Location';\n\timport { Card } from '$lib/components/ui/card';\n\timport {\n\t\tinitial,\n\t\toneToAll,\n\t\tplan,\n\t\ttype ElevationCosts,\n\t\ttype OneToAllData,\n\t\ttype PlanResponse,\n\t\ttype Itinerary,\n\t\ttype Mode,\n\t\ttype PedestrianProfile,\n\t\ttype PlanData,\n\t\ttype ReachablePlace,\n\t\ttype RentalFormFactor,\n\t\ttype ServerConfig\n\t} from '@motis-project/motis-client';\n\timport ItineraryList from '$lib/ItineraryList.svelte';\n\timport ConnectionDetail from '$lib/ConnectionDetail.svelte';\n\timport { Button } from '$lib/components/ui/button';\n\timport ItineraryGeoJson from '$lib/map/itineraries/ItineraryGeoJSON.svelte';\n\timport maplibregl from 'maplibre-gl';\n\timport { browser } from '$app/environment';\n\timport { cn, getUrlArray, onClickStop, onClickTrip, pushStateWithQueryString } from '$lib/utils';\n\timport Debug from '$lib/Debug.svelte';\n\timport Marker from '$lib/map/Marker.svelte';\n\timport Popup from '$lib/map/Popup.svelte';\n\timport LevelSelect from '$lib/LevelSelect.svelte';\n\timport { lngLatToStr } from '$lib/lngLatToStr';\n\timport Drawer from '$lib/map/Drawer.svelte';\n\timport { client } from '@motis-project/motis-client';\n\timport StopTimes from '$lib/StopTimes.svelte';\n\timport { onMount, tick, untrack } from 'svelte';\n\timport { t } from '$lib/i18n/translation';\n\timport { pushState } from '$app/navigation';\n\timport { page } from '$app/state';\n\timport { preprocessItinerary } from '$lib/preprocessItinerary';\n\timport * as Tabs from '$lib/components/ui/tabs';\n\timport DeparturesMask from '$lib/DeparturesMask.svelte';\n\timport Isochrones from '$lib/map/Isochrones.svelte';\n\timport IsochronesInfo from '$lib/IsochronesInfo.svelte';\n\timport type { DisplayLevel, IsochronesOptions, IsochronesPos } from '$lib/map/IsochronesShared';\n\timport IsochronesMask from '$lib/IsochronesMask.svelte';\n\timport Rentals from '$lib/map/rentals/Rentals.svelte';\n\timport {\n\t\tgetFormFactors,\n\t\tgetPrePostDirectModes,\n\t\tpossibleTransitModes,\n\t\tprePostModesToModes,\n\t\ttype PrePostDirectMode\n\t} from '$lib/Modes';\n\timport { defaultQuery, omitDefaults } from '$lib/defaults';\n\timport { LEVEL_MIN_ZOOM } from '$lib/constants';\n\timport StopGeoJSON from '$lib/map/stops/StopsGeoJSON.svelte';\n\timport RailViz from '$lib/RailViz.svelte';\n\n\tconst urlParams = browser ? new URLSearchParams(window.location.search) : undefined;\n\n\tconst hasDebug: boolean = Boolean(urlParams?.has('debug'));\n\tconst hasDark: boolean = Boolean(urlParams?.has('dark'));\n\tconst hasLight: boolean = Boolean(urlParams?.has('light'));\n\tconst isSmallScreen = browser && window.innerWidth < 768;\n\tlet activeTab = $derived<'connections' | 'departures' | 'isochrones'>(\n\t\tpage.state.activeTab ??\n\t\t\t(urlParams?.has('one')\n\t\t\t\t? 'isochrones'\n\t\t\t\t: urlParams?.has('stopId')\n\t\t\t\t\t? 'departures'\n\t\t\t\t\t: 'connections')\n\t);\n\tlet dataAttributionLink: string | undefined = $state(undefined);\n\tlet colorMode = $state<'rt' | 'route' | 'mode' | 'none'>('none');\n\tlet showMap = $state(!isSmallScreen);\n\tlet lastOneToAllQuery: OneToAllData | undefined = undefined;\n\tlet lastPlanQuery: PlanData | undefined = undefined;\n\tlet serverConfig: ServerConfig | undefined = $state();\n\tlet dataLoaded: boolean = $state(false);\n\n\t$effect(() => {\n\t\tif (activeTab == 'isochrones') {\n\t\t\tcolorMode = 'none';\n\t\t}\n\t});\n\n\tlet theme: 'light' | 'dark' =\n\t\t(hasDark ? 'dark' : hasLight ? 'light' : undefined) ??\n\t\t(browser && window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches\n\t\t\t? 'dark'\n\t\t\t: 'light');\n\tif (theme === 'dark') {\n\t\tdocument.documentElement.classList.add('dark');\n\t}\n\n\tlet center = $state.raw<[number, number]>([2.258882912876089, 48.72559118651327]);\n\tlet level = $state(0);\n\tlet zoom = $state(15);\n\tlet bounds = $state<maplibregl.LngLatBoundsLike>();\n\tlet map = $state<maplibregl.Map>();\n\tlet style = $derived(\n\t\tbrowser\n\t\t\t? getStyle(\n\t\t\t\t\ttheme,\n\t\t\t\t\tlevel,\n\t\t\t\t\twindow.location.origin + window.location.pathname,\n\t\t\t\t\tclient.getConfig().baseUrl\n\t\t\t\t\t\t? client.getConfig().baseUrl + '/'\n\t\t\t\t\t\t: window.location.origin + window.location.pathname\n\t\t\t\t)\n\t\t\t: undefined\n\t);\n\n\tconst geolocate = new maplibregl.GeolocateControl({\n\t\tpositionOptions: {\n\t\t\tenableHighAccuracy: true\n\t\t},\n\t\tshowAccuracyCircle: false\n\t});\n\n\tconst getLocation = () => {\n\t\tgeolocate.trigger();\n\t};\n\n\tonMount(async () => {\n\t\tinitial().then((d) => {\n\t\t\tif (d.response.headers.has('Link')) {\n\t\t\t\tdataAttributionLink = d.response.headers\n\t\t\t\t\t.get('Link')!\n\t\t\t\t\t.replace(/^<(.*)>; rel=\"license\"$/, '$1');\n\t\t\t}\n\t\t\tconst r = d.data;\n\t\t\tif (r) {\n\t\t\t\tcenter = [r.lon, r.lat];\n\t\t\t\tzoom = r.zoom;\n\t\t\t\tserverConfig = r.serverConfig;\n\t\t\t}\n\t\t\tdataLoaded = true;\n\t\t});\n\t\tawait tick();\n\t\tapplyPageStateFromURL();\n\t});\n\n\tconst applyPageStateFromURL = () => {\n\t\tif (browser && urlParams) {\n\t\t\tconst tripId = urlParams.get('tripId');\n\t\t\tif (tripId !== null) {\n\t\t\t\tonClickTrip(tripId, true);\n\t\t\t}\n\n\t\t\tconst stopId = urlParams.get('stopId');\n\t\t\tif (stopId !== null) {\n\t\t\t\tconst time = urlParams.has('time') ? new Date(urlParams.get('time')!) : new Date();\n\t\t\t\tonClickStop('', stopId, time, urlParams.get('stopArriveBy') == 'true', true);\n\t\t\t}\n\t\t}\n\t};\n\n\tfunction parseIntOr<T>(s: string | null | undefined, d: T): T | number {\n\t\tif (s) {\n\t\t\tconst v = parseInt(s);\n\t\t\treturn isNaN(v) ? d : v;\n\t\t} else {\n\t\t\treturn d;\n\t\t}\n\t}\n\n\tlet fromMarker = $state<maplibregl.Marker>();\n\tlet toMarker = $state<maplibregl.Marker>();\n\tlet oneMarker = $state<maplibregl.Marker>();\n\tlet stopMarker = $state<maplibregl.Marker>();\n\tlet from = $state<Location>(\n\t\tparseLocation(urlParams?.get('fromPlace'), urlParams?.get('fromName'))\n\t);\n\tlet to = $state<Location>(parseLocation(urlParams?.get('toPlace'), urlParams?.get('toName')));\n\tlet one = $state<Location>(parseLocation(urlParams?.get('one'), urlParams?.get('oneName')));\n\tlet stop = $state<Location>();\n\n\tlet viaParam = getUrlArray('via');\n\tlet viaLabels = $state(\n\t\turlParams?.has('viaLabel0')\n\t\t\t? Array.from({ length: viaParam.length }).reduce<Record<string, string>>((acc, _, i) => {\n\t\t\t\t\tacc[`viaLabel${i}`] = urlParams?.get(`viaLabel${i}`) ?? '';\n\t\t\t\t\treturn acc;\n\t\t\t\t}, {})\n\t\t\t: {}\n\t);\n\tlet via = $state(\n\t\turlParams?.has('via')\n\t\t\t? viaParam.map((str, i) => parseLocation(str, viaLabels[`viaLabel${i}`]))\n\t\t\t: undefined\n\t);\n\tlet viaMinimumStay = $state(\n\t\turlParams?.has('via') ? getUrlArray('viaMinimumStay').map((s) => parseIntOr(s, 0)) : undefined\n\t);\n\n\tlet time = $state<Date>(new Date(urlParams?.get('time') || Date.now()));\n\tlet timetableView = $state(urlParams?.get('timetableView') != 'false');\n\tlet searchWindow = $state(\n\t\turlParams?.get('searchWindow')\n\t\t\t? parseInt(urlParams.get('searchWindow')!)\n\t\t\t: defaultQuery.searchWindow\n\t);\n\tlet numItineraries = $state(\n\t\turlParams?.get('numItineraries')\n\t\t\t? parseIntOr(urlParams.get('numItineraries'), defaultQuery.numItineraries)\n\t\t\t: defaultQuery.numItineraries\n\t);\n\tlet maxItineraries = $state(\n\t\turlParams?.get('maxItineraries')\n\t\t\t? parseIntOr(urlParams.get('maxItineraries'), undefined)\n\t\t\t: undefined\n\t);\n\tlet arriveBy = $state<boolean>(urlParams?.get('arriveBy') == 'true');\n\tlet algorithm = $state<PlanData['query']['algorithm']>(\n\t\t(urlParams?.get('algorithm') ?? defaultQuery.algorithm) as PlanData['query']['algorithm']\n\t);\n\tlet useRoutedTransfers = $state(\n\t\turlParams?.get('useRoutedTransfers') == 'true' || defaultQuery.useRoutedTransfers\n\t);\n\tlet pedestrianProfile = $state<PedestrianProfile>(\n\t\t(urlParams?.has('pedestrianProfile')\n\t\t\t? urlParams.get('pedestrianProfile')\n\t\t\t: defaultQuery.pedestrianProfile) as PedestrianProfile\n\t);\n\tlet requireBikeTransport = $state(urlParams?.get('requireBikeTransport') == 'true');\n\tlet requireCarTransport = $state(urlParams?.get('requireCarTransport') == 'true');\n\tlet transitModes = $state<Mode[]>(\n\t\tgetUrlArray('transitModes', defaultQuery.transitModes) as Mode[]\n\t);\n\tlet preTransitModes = $state<PrePostDirectMode[]>(\n\t\tgetPrePostDirectModes(\n\t\t\tgetUrlArray('preTransitModes', defaultQuery.preTransitModes) as Mode[],\n\t\t\tgetUrlArray('preTransitRentalFormFactors') as RentalFormFactor[]\n\t\t)\n\t);\n\tlet postTransitModes = $state<PrePostDirectMode[]>(\n\t\tgetPrePostDirectModes(\n\t\t\tgetUrlArray('postTransitModes', defaultQuery.postTransitModes) as Mode[],\n\t\t\tgetUrlArray('postTransitRentalFormFactors') as RentalFormFactor[]\n\t\t)\n\t);\n\tlet directModes = $state<PrePostDirectMode[]>(\n\t\tgetPrePostDirectModes(\n\t\t\tgetUrlArray('directModes', defaultQuery.directModes) as Mode[],\n\t\t\tgetUrlArray('directRentalFormFactors') as RentalFormFactor[]\n\t\t)\n\t);\n\tlet preTransitProviderGroups = $state<string[]>(getUrlArray('preTransitRentalProviderGroups'));\n\tlet postTransitProviderGroups = $state<string[]>(getUrlArray('postTransitRentalProviderGroups'));\n\tlet directProviderGroups = $state<string[]>(getUrlArray('directRentalProviderGroups'));\n\tlet elevationCosts = $state<ElevationCosts>(\n\t\t(urlParams?.get('elevationCosts') ?? 'NONE') as ElevationCosts\n\t);\n\tlet maxTransfers = $state<number>(\n\t\tparseIntOr(urlParams?.get('maxTransfers'), defaultQuery.maxTransfers)\n\t);\n\tlet maxTravelTime = $derived<number>(\n\t\tparseIntOr(\n\t\t\turlParams?.get('maxTravelTime'),\n\t\t\tMath.min(\n\t\t\t\tdefaultQuery.maxTravelTime,\n\t\t\t\t60 * (serverConfig?.maxOneToAllTravelTimeLimit ?? Infinity)\n\t\t\t)\n\t\t)\n\t);\n\tlet maxPreTransitTime = $derived<number>(\n\t\tparseIntOr(\n\t\t\turlParams?.get('maxPreTransitTime'),\n\t\t\tMath.min(defaultQuery.maxPreTransitTime, serverConfig?.maxPrePostTransitTimeLimit ?? Infinity)\n\t\t)\n\t);\n\tlet maxPostTransitTime = $derived<number>(\n\t\tparseIntOr(\n\t\t\turlParams?.get('maxPostTransitTime'),\n\t\t\tMath.min(\n\t\t\t\tdefaultQuery.maxPostTransitTime,\n\t\t\t\tserverConfig?.maxPrePostTransitTimeLimit ?? Infinity\n\t\t\t)\n\t\t)\n\t);\n\tlet maxDirectTime = $derived<number>(\n\t\tparseIntOr(\n\t\t\turlParams?.get('maxDirectTime'),\n\t\t\tMath.min(defaultQuery.maxDirectTime, serverConfig?.maxDirectTimeLimit ?? Infinity)\n\t\t)\n\t);\n\tlet ignorePreTransitRentalReturnConstraints = $state(\n\t\turlParams?.get('ignorePreTransitRentalReturnConstraints') == 'true'\n\t);\n\tlet ignorePostTransitRentalReturnConstraints = $state(\n\t\turlParams?.get('ignorePostTransitRentalReturnConstraints') == 'true'\n\t);\n\tlet ignoreDirectRentalReturnConstraints = $state(\n\t\turlParams?.get('ignoreDirectRentalReturnConstraints') == 'true'\n\t);\n\tlet slowDirect = $state(urlParams?.get('slowDirect') == 'true');\n\n\tlet isochronesData = $state<IsochronesPos[]>([]);\n\tlet isochronesOptions = $state<IsochronesOptions>({\n\t\tdisplayLevel:\n\t\t\t(urlParams?.get('isochronesDisplayLevel') as DisplayLevel) ??\n\t\t\tdefaultQuery.isochronesDisplayLevel,\n\t\tcolor: urlParams?.get('isochronesColor') ?? defaultQuery.isochronesColor,\n\t\topacity: parseIntOr(urlParams?.get('isochronesOpacity'), defaultQuery.isochronesOpacity),\n\t\tstatus: 'DONE',\n\t\terrorMessage: undefined,\n\t\terrorCode: undefined\n\t});\n\tconst isochronesCircleResolution = urlParams?.get('isochronesCircleResolution')\n\t\t? parseIntOr(urlParams.get('isochronesCircleResolution'), defaultQuery.circleResolution)\n\t\t: defaultQuery.circleResolution;\n\n\tconst toPlaceString = (l: Location) => {\n\t\tif (l.match?.type === 'STOP') {\n\t\t\treturn l.match.id;\n\t\t} else if (l.match?.level) {\n\t\t\treturn `${lngLatToStr(l.match!)},${l.match.level}`;\n\t\t} else {\n\t\t\treturn `${lngLatToStr(l.match!)}`;\n\t\t}\n\t};\n\n\tconst providerGroupsForQuery = (modes: PrePostDirectMode[], groups: string[]): string[] => {\n\t\tif (!modes.some((mode) => mode.startsWith('RENTAL_'))) {\n\t\t\treturn [];\n\t\t}\n\t\treturn Array.from(new Set(groups));\n\t};\n\n\tlet baseQuery = $derived(\n\t\tfrom.match && to.match\n\t\t\t? ({\n\t\t\t\t\tquery: omitDefaults({\n\t\t\t\t\t\ttime: time.toISOString(),\n\t\t\t\t\t\tfromPlace: toPlaceString(from),\n\t\t\t\t\t\ttoPlace: toPlaceString(to),\n\t\t\t\t\t\tarriveBy,\n\t\t\t\t\t\ttimetableView,\n\t\t\t\t\t\tsearchWindow,\n\t\t\t\t\t\tnumItineraries,\n\t\t\t\t\t\tmaxItineraries,\n\t\t\t\t\t\twithFares: true,\n\t\t\t\t\t\tslowDirect,\n\t\t\t\t\t\tfastestDirectFactor: 1.5,\n\t\t\t\t\t\tpedestrianProfile,\n\t\t\t\t\t\tjoinInterlinedLegs: false,\n\t\t\t\t\t\ttransitModes:\n\t\t\t\t\t\t\ttransitModes.length == possibleTransitModes.length\n\t\t\t\t\t\t\t\t? defaultQuery.transitModes\n\t\t\t\t\t\t\t\t: transitModes,\n\t\t\t\t\t\tpreTransitModes: prePostModesToModes(preTransitModes),\n\t\t\t\t\t\tpostTransitModes: prePostModesToModes(postTransitModes),\n\t\t\t\t\t\tdirectModes: prePostModesToModes(directModes),\n\t\t\t\t\t\tpreTransitRentalFormFactors: getFormFactors(preTransitModes),\n\t\t\t\t\t\tpostTransitRentalFormFactors: getFormFactors(postTransitModes),\n\t\t\t\t\t\tdirectRentalFormFactors: getFormFactors(directModes),\n\t\t\t\t\t\tpreTransitRentalProviderGroups: providerGroupsForQuery(\n\t\t\t\t\t\t\tpreTransitModes,\n\t\t\t\t\t\t\tpreTransitProviderGroups\n\t\t\t\t\t\t),\n\t\t\t\t\t\tpostTransitRentalProviderGroups: providerGroupsForQuery(\n\t\t\t\t\t\t\tpostTransitModes,\n\t\t\t\t\t\t\tpostTransitProviderGroups\n\t\t\t\t\t\t),\n\t\t\t\t\t\tdirectRentalProviderGroups: providerGroupsForQuery(directModes, directProviderGroups),\n\t\t\t\t\t\trequireBikeTransport,\n\t\t\t\t\t\trequireCarTransport,\n\t\t\t\t\t\televationCosts,\n\t\t\t\t\t\tuseRoutedTransfers,\n\t\t\t\t\t\tmaxTransfers: maxTransfers,\n\t\t\t\t\t\tmaxMatchingDistance: pedestrianProfile == 'WHEELCHAIR' ? 8 : 250,\n\t\t\t\t\t\tmaxPreTransitTime,\n\t\t\t\t\t\tmaxPostTransitTime,\n\t\t\t\t\t\tmaxDirectTime,\n\t\t\t\t\t\tignorePreTransitRentalReturnConstraints,\n\t\t\t\t\t\tignorePostTransitRentalReturnConstraints,\n\t\t\t\t\t\tignoreDirectRentalReturnConstraints,\n\t\t\t\t\t\talgorithm,\n\t\t\t\t\t\tvia: via ? via.map((v) => v.match?.id) : undefined,\n\t\t\t\t\t\tviaMinimumStay\n\t\t\t\t\t} as PlanData['query'])\n\t\t\t\t} as PlanData)\n\t\t\t: undefined\n\t);\n\n\tlet isochronesQuery = $derived(\n\t\tone?.match\n\t\t\t? ({\n\t\t\t\t\tquery: {\n\t\t\t\t\t\tone: toPlaceString(one),\n\t\t\t\t\t\tmaxTravelTime: Math.ceil(maxTravelTime / 60),\n\t\t\t\t\t\ttime: time.toISOString(),\n\t\t\t\t\t\ttransitModes,\n\t\t\t\t\t\tmaxTransfers,\n\t\t\t\t\t\tarriveBy,\n\t\t\t\t\t\tuseRoutedTransfers,\n\t\t\t\t\t\tpedestrianProfile,\n\t\t\t\t\t\trequireBikeTransport,\n\t\t\t\t\t\trequireCarTransport,\n\t\t\t\t\t\tpreTransitModes: prePostModesToModes(preTransitModes),\n\t\t\t\t\t\tpostTransitModes: prePostModesToModes(postTransitModes),\n\t\t\t\t\t\tmaxPreTransitTime,\n\t\t\t\t\t\tmaxPostTransitTime,\n\t\t\t\t\t\televationCosts,\n\t\t\t\t\t\tmaxMatchingDistance: pedestrianProfile == 'WHEELCHAIR' ? 8 : 250,\n\t\t\t\t\t\tignorePreTransitRentalReturnConstraints,\n\t\t\t\t\t\tignorePostTransitRentalReturnConstraints\n\t\t\t\t\t}\n\t\t\t\t} as OneToAllData)\n\t\t\t: undefined\n\t);\n\n\tlet searchDebounceTimer: number;\n\tlet baseResponse = $state<Promise<PlanResponse>>();\n\tlet routingResponses = $state<Array<Promise<PlanResponse>>>([]);\n\tlet stopNameFromResponse = $state<string>('');\n\t$effect(() => {\n\t\tif (baseQuery && baseQuery != lastPlanQuery && activeTab == 'connections') {\n\t\t\tlastPlanQuery = baseQuery;\n\t\t\tclearTimeout(searchDebounceTimer);\n\t\t\tsearchDebounceTimer = setTimeout(() => {\n\t\t\t\tconst base = plan(baseQuery).then(preprocessItinerary(from, to));\n\t\t\t\tconst q = baseQuery.query;\n\t\t\t\tbaseResponse = base;\n\t\t\t\troutingResponses = [base];\n\t\t\t\tpushStateWithQueryString(\n\t\t\t\t\t{\n\t\t\t\t\t\t...q,\n\t\t\t\t\t\t...(q.fromPlace == from.label ? {} : { fromName: from.label }),\n\t\t\t\t\t\t...(q.toPlace == to.label ? {} : { toName: to.label }),\n\t\t\t\t\t\t...viaLabels\n\t\t\t\t\t},\n\t\t\t\t\t{ activeTab: 'connections' },\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}, 400);\n\t\t}\n\t});\n\tlet isochronesQueryTimeout: number;\n\t$effect(() => {\n\t\tif (isochronesQuery && activeTab == 'isochrones') {\n\t\t\tconst [isochronesColor, isochronesOpacity, isochronesDisplayLevel] = [\n\t\t\t\tisochronesOptions.color,\n\t\t\t\tisochronesOptions.opacity,\n\t\t\t\tisochronesOptions.displayLevel\n\t\t\t];\n\t\t\tif (lastOneToAllQuery != isochronesQuery) {\n\t\t\t\tlastOneToAllQuery = isochronesQuery;\n\t\t\t\tclearTimeout(isochronesQueryTimeout);\n\t\t\t\tisochronesOptions.status = 'WORKING';\n\t\t\t\tisochronesOptions.errorMessage = undefined;\n\t\t\t\tisochronesQueryTimeout = setTimeout(async () => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst { data, error, response } = await oneToAll(isochronesQuery);\n\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\tisochronesOptions.status = 'FAILED';\n\t\t\t\t\t\t\tisochronesOptions.errorCode = response.status;\n\t\t\t\t\t\t\tisochronesOptions.errorMessage = error.error;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst all = data!.all!.map((p: ReachablePlace) => {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tlat: p.place?.lat,\n\t\t\t\t\t\t\t\tlng: p.place?.lon,\n\t\t\t\t\t\t\t\tseconds: maxTravelTime - 60 * (p.duration ?? 0),\n\t\t\t\t\t\t\t\tname: p.place?.name\n\t\t\t\t\t\t\t} as IsochronesPos;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tisochronesData = [...all];\n\t\t\t\t\t\tisochronesOptions.status = isochronesData.length == 0 ? 'EMPTY' : 'WORKING';\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tisochronesOptions.status = 'FAILED';\n\t\t\t\t\t\tisochronesOptions.errorMessage = String(e);\n\t\t\t\t\t\tisochronesOptions.errorCode = 404;\n\t\t\t\t\t}\n\t\t\t\t}, 60);\n\t\t\t}\n\t\t\tuntrack(() => {\n\t\t\t\tconst q = isochronesQuery.query;\n\t\t\t\tpushStateWithQueryString(\n\t\t\t\t\t{\n\t\t\t\t\t\t...q,\n\t\t\t\t\t\t...(q.one == one.label ? {} : { oneName: one.label }),\n\t\t\t\t\t\tmaxTravelTime: q.maxTravelTime * 60,\n\t\t\t\t\t\tisochronesColor,\n\t\t\t\t\t\tisochronesOpacity,\n\t\t\t\t\t\tisochronesDisplayLevel,\n\t\t\t\t\t\t...(isochronesCircleResolution && isochronesCircleResolution > 2\n\t\t\t\t\t\t\t? { isochronesCircleResolution }\n\t\t\t\t\t\t\t: {})\n\t\t\t\t\t},\n\t\t\t\t\t{ activeTab: 'isochrones' },\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t});\n\n\tif (browser) {\n\t\taddEventListener('paste', (event: ClipboardEvent) => {\n\t\t\tconst paste = event.clipboardData!.getData('text');\n\t\t\tconst json = JSON.parse(paste);\n\t\t\tconsole.log('paste: ', json);\n\t\t\tconst response = new Promise<PlanResponse>((resolve, _) => {\n\t\t\t\tresolve(json as PlanResponse);\n\t\t\t});\n\t\t\tbaseResponse = response;\n\t\t\troutingResponses = [response];\n\t\t});\n\t}\n\n\tconst flyToItineraries = (itineraries: Itinerary[], map: maplibregl.Map) => {\n\t\tconst start = maplibregl.LngLat.convert(itineraries[0].legs[0].from);\n\t\tconst box = new maplibregl.LngLatBounds(start, start);\n\t\titineraries.forEach((i) => {\n\t\t\ti.legs.forEach((l) => {\n\t\t\t\tbox.extend(l.from);\n\t\t\t\tbox.extend(l.to);\n\t\t\t\tl.intermediateStops?.forEach((x) => {\n\t\t\t\t\tbox.extend(x);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t\tmap.flyTo({\n\t\t\t...map.cameraForBounds(box, {\n\t\t\t\tpadding: {\n\t\t\t\t\ttop: 96,\n\t\t\t\t\tright: 96,\n\t\t\t\t\tbottom: isSmallScreen ? window.innerHeight * 0.3 : 96,\n\t\t\t\t\tleft: isSmallScreen ? 96 : 640\n\t\t\t\t}\n\t\t\t})\n\t\t});\n\t};\n\n\tconst flyToLocation = (location: Location) => {\n\t\tmap?.flyTo({ center: location.match, zoom: 11 });\n\t};\n\n\tconst flyToSelectedItinerary = () => {\n\t\tif (page.state.selectedItinerary && map) {\n\t\t\tflyToItineraries([page.state.selectedItinerary], map);\n\t\t}\n\t};\n\n\t$effect(() => {\n\t\tif (map) {\n\t\t\tmap.addControl(geolocate);\n\t\t}\n\t});\n\n\t$effect(() => {\n\t\tif (map) {\n\t\t\tif (page.state.selectedItinerary && activeTab == 'connections') {\n\t\t\t\tflyToSelectedItinerary();\n\t\t\t} else if (activeTab == 'departures' && stop && stop.match) {\n\t\t\t\tflyToLocation(stop);\n\t\t\t} else if (activeTab == 'isochrones' && one && one.match) {\n\t\t\t\tflyToLocation(one);\n\t\t\t}\n\t\t}\n\t});\n\n\t$effect(() => {\n\t\tif (!map || activeTab != 'connections' || !baseQuery) return;\n\t\tPromise.all(routingResponses).then((responses) => {\n\t\t\tif (map) {\n\t\t\t\tlet it = responses.flatMap((response) => response.itineraries);\n\t\t\t\tif (it.length !== 0) {\n\t\t\t\t\tflyToItineraries(it, map);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\ttype CloseFn = () => void;\n</script>\n\n{#snippet contextMenu(e: maplibregl.MapMouseEvent, close: CloseFn)}\n\t{#if activeTab == 'connections'}\n\t\t<Button\n\t\t\tvariant=\"outline\"\n\t\t\tonclick={() => {\n\t\t\t\tfrom = posToLocation(e.lngLat, zoom > LEVEL_MIN_ZOOM ? level : undefined);\n\t\t\t\tfromMarker?.setLngLat(from.match!);\n\t\t\t\tclose();\n\t\t\t}}\n\t\t>\n\t\t\tFrom\n\t\t</Button>\n\t\t<Button\n\t\t\tvariant=\"outline\"\n\t\t\tonclick={() => {\n\t\t\t\tto = posToLocation(e.lngLat, zoom > LEVEL_MIN_ZOOM ? level : undefined);\n\t\t\t\ttoMarker?.setLngLat(to.match!);\n\t\t\t\tclose();\n\t\t\t}}\n\t\t>\n\t\t\tTo\n\t\t</Button>\n\t{:else if activeTab == 'isochrones'}\n\t\t<Button\n\t\t\tvariant=\"outline\"\n\t\t\tonclick={() => {\n\t\t\t\tone = posToLocation(e.lngLat, zoom > LEVEL_MIN_ZOOM ? level : undefined);\n\t\t\t\toneMarker?.setLngLat(one.match!);\n\t\t\t\tclose();\n\t\t\t}}\n\t\t>\n\t\t\t{t.position}\n\t\t</Button>\n\t{/if}\n{/snippet}\n\n{#snippet resultContent()}\n\t<Control>\n\t\t<Tabs.Root\n\t\t\tbind:value={\n\t\t\t\t() => activeTab,\n\t\t\t\t(v) => {\n\t\t\t\t\tactiveTab = v;\n\t\t\t\t\tpushState('', { activeTab: v });\n\t\t\t\t}\n\t\t\t}\n\t\t\tclass=\"max-w-full w-[520px] overflow-y-auto\"\n\t\t>\n\t\t\t<Tabs.List class=\"grid grid-cols-3\">\n\t\t\t\t<Tabs.Trigger value=\"connections\">{t.connections}</Tabs.Trigger>\n\t\t\t\t<Tabs.Trigger value=\"departures\">{t.departures}</Tabs.Trigger>\n\t\t\t\t<Tabs.Trigger value=\"isochrones\">{t.isochrones.title}</Tabs.Trigger>\n\t\t\t</Tabs.List>\n\t\t\t<Tabs.Content value=\"connections\">\n\t\t\t\t<Card class=\"overflow-y-auto overflow-x-hidden bg-background rounded-lg\">\n\t\t\t\t\t<SearchMask\n\t\t\t\t\t\tgeocodingBiasPlace={center}\n\t\t\t\t\t\t{serverConfig}\n\t\t\t\t\t\tbind:from\n\t\t\t\t\t\tbind:to\n\t\t\t\t\t\tbind:time\n\t\t\t\t\t\tbind:arriveBy\n\t\t\t\t\t\tbind:useRoutedTransfers\n\t\t\t\t\t\tbind:maxTransfers\n\t\t\t\t\t\tbind:pedestrianProfile\n\t\t\t\t\t\tbind:requireCarTransport\n\t\t\t\t\t\tbind:requireBikeTransport\n\t\t\t\t\t\tbind:transitModes\n\t\t\t\t\t\tbind:preTransitModes\n\t\t\t\t\t\tbind:postTransitModes\n\t\t\t\t\t\tbind:directModes\n\t\t\t\t\t\tbind:elevationCosts\n\t\t\t\t\t\tbind:maxPreTransitTime\n\t\t\t\t\t\tbind:maxPostTransitTime\n\t\t\t\t\t\tbind:maxDirectTime\n\t\t\t\t\t\tbind:ignorePreTransitRentalReturnConstraints\n\t\t\t\t\t\tbind:ignorePostTransitRentalReturnConstraints\n\t\t\t\t\t\tbind:ignoreDirectRentalReturnConstraints\n\t\t\t\t\t\tbind:preTransitProviderGroups\n\t\t\t\t\t\tbind:postTransitProviderGroups\n\t\t\t\t\t\tbind:directProviderGroups\n\t\t\t\t\t\tbind:via\n\t\t\t\t\t\tbind:viaMinimumStay\n\t\t\t\t\t\tbind:viaLabels\n\t\t\t\t\t/>\n\t\t\t\t</Card>\n\t\t\t</Tabs.Content>\n\t\t\t<Tabs.Content value=\"departures\">\n\t\t\t\t<Card class=\"overflow-y-auto overflow-x-hidden bg-background rounded-lg\">\n\t\t\t\t\t<DeparturesMask bind:time />\n\t\t\t\t</Card>\n\t\t\t</Tabs.Content>\n\t\t\t<Tabs.Content value=\"isochrones\">\n\t\t\t\t<Card class=\"overflow-y-auto overflow-x-hidden bg-background rounded-lg\">\n\t\t\t\t\t<IsochronesMask\n\t\t\t\t\t\tbind:one\n\t\t\t\t\t\t{serverConfig}\n\t\t\t\t\t\tbind:maxTravelTime\n\t\t\t\t\t\tgeocodingBiasPlace={center}\n\t\t\t\t\t\tbind:time\n\t\t\t\t\t\tbind:useRoutedTransfers\n\t\t\t\t\t\tbind:pedestrianProfile\n\t\t\t\t\t\tbind:requireCarTransport\n\t\t\t\t\t\tbind:requireBikeTransport\n\t\t\t\t\t\tbind:transitModes\n\t\t\t\t\t\tbind:maxTransfers\n\t\t\t\t\t\tbind:preTransitModes\n\t\t\t\t\t\tbind:postTransitModes\n\t\t\t\t\t\tbind:maxPreTransitTime\n\t\t\t\t\t\tbind:maxPostTransitTime\n\t\t\t\t\t\tbind:arriveBy\n\t\t\t\t\t\tbind:elevationCosts\n\t\t\t\t\t\tbind:ignorePreTransitRentalReturnConstraints\n\t\t\t\t\t\tbind:ignorePostTransitRentalReturnConstraints\n\t\t\t\t\t\tbind:options={isochronesOptions}\n\t\t\t\t\t\tbind:preTransitProviderGroups\n\t\t\t\t\t\tbind:postTransitProviderGroups\n\t\t\t\t\t\tbind:directProviderGroups\n\t\t\t\t\t/>\n\t\t\t\t</Card>\n\t\t\t</Tabs.Content>\n\t\t</Tabs.Root>\n\t</Control>\n\n\t{#if activeTab == 'connections' && routingResponses.length !== 0 && !page.state.selectedItinerary}\n\t\t<Control class=\"min-h-0 md:flex md:flex-col md:mb-2} \">\n\t\t\t<Card\n\t\t\t\tclass=\"scrollable w-[520px] h-full md:h-[70vh] {isSmallScreen\n\t\t\t\t\t? 'border-0 shadow-none'\n\t\t\t\t\t: ''} overflow-x-hidden bg-background rounded-lg mb-2\"\n\t\t\t>\n\t\t\t\t<ItineraryList\n\t\t\t\t\t{baseResponse}\n\t\t\t\t\t{routingResponses}\n\t\t\t\t\t{baseQuery}\n\t\t\t\t\tselectItinerary={(selectedItinerary) => {\n\t\t\t\t\t\tpushState('', {\n\t\t\t\t\t\t\tselectedItinerary: selectedItinerary,\n\t\t\t\t\t\t\tscrollY: undefined,\n\t\t\t\t\t\t\tactiveTab: 'connections'\n\t\t\t\t\t\t});\n\t\t\t\t\t}}\n\t\t\t\t\tupdateStartDest={preprocessItinerary(from, to)}\n\t\t\t\t/>\n\t\t\t</Card>\n\t\t</Control>\n\t\t{#if showMap && !page.state.selectedItinerary}\n\t\t\t{#each routingResponses as r, rI (rI)}\n\t\t\t\t{#await r then r}\n\t\t\t\t\t{#each r.itineraries as it, i (i)}\n\t\t\t\t\t\t<ItineraryGeoJson\n\t\t\t\t\t\t\titinerary={it}\n\t\t\t\t\t\t\tid=\"{rI}-{i}\"\n\t\t\t\t\t\t\tselected={false}\n\t\t\t\t\t\t\tselectItinerary={() => {\n\t\t\t\t\t\t\t\tpushState('', {\n\t\t\t\t\t\t\t\t\tselectedItinerary: it,\n\t\t\t\t\t\t\t\t\tactiveTab: 'connections'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t{level}\n\t\t\t\t\t\t\t{theme}\n\t\t\t\t\t\t/>\n\t\t\t\t\t{/each}\n\t\t\t\t{/await}\n\t\t\t{/each}\n\t\t{/if}\n\t{/if}\n\n\t{#if activeTab == 'connections' && page.state.selectedItinerary}\n\t\t<Control class=\"min-h-0 md:mb-2 md:flex\">\n\t\t\t<Card class=\"w-[520px] bg-background rounded-lg  flex flex-col mb-2\">\n\t\t\t\t<div class=\"w-full flex justify-between items-center shadow-md pl-1 mb-1\">\n\t\t\t\t\t<h2 class=\"ml-2 text-base font-semibold\">{t.journeyDetails}</h2>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\thistory.back();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<X />\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass={'p-2 md:p-4 overflow-y-auto overflow-x-hidden min-h-0 ' +\n\t\t\t\t\t\t(showMap ? 'md:max-h-[60vh]' : '')}\n\t\t\t\t>\n\t\t\t\t\t<ConnectionDetail itinerary={page.state.selectedItinerary} />\n\t\t\t\t</div>\n\t\t\t</Card>\n\t\t</Control>\n\t\t{#if showMap}\n\t\t\t<ItineraryGeoJson itinerary={page.state.selectedItinerary} selected={true} {level} {theme} />\n\t\t\t<StopGeoJSON itinerary={page.state.selectedItinerary} {theme} />\n\t\t{/if}\n\t{/if}\n\n\t{#if activeTab == 'departures' && page.state.selectedStop}\n\t\t<Control class=\"min-h-0 md:mb-2\">\n\t\t\t<Card class=\"w-[520px] md:max-h-[60vh] h-full bg-background rounded-lg flex flex-col mb-2\">\n\t\t\t\t<div class=\"w-full flex justify-between items-center shadow-md pl-1 mb-1\">\n\t\t\t\t\t<h2 class=\"ml-2 text-base font-semibold\">\n\t\t\t\t\t\t{#if page.state.stopArriveBy}\n\t\t\t\t\t\t\t{t.arrivals}\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t{t.departures}\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t\tin\n\t\t\t\t\t\t{stopNameFromResponse}\n\t\t\t\t\t</h2>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\thistory.back();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<X />\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"p-2 md:p-4 overflow-y-auto overflow-x-hidden min-h-0 md:max-h-[60vh]\">\n\t\t\t\t\t<StopTimes\n\t\t\t\t\t\tstopId={page.state.selectedStop.stopId}\n\t\t\t\t\t\tstopName={page.state.selectedStop.name}\n\t\t\t\t\t\ttime={page.state.selectedStop.time}\n\t\t\t\t\t\tbind:stop\n\t\t\t\t\t\tbind:stopMarker\n\t\t\t\t\t\tbind:stopNameFromResponse\n\t\t\t\t\t\tarriveBy={page.state.stopArriveBy}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</Card>\n\t\t</Control>\n\t{/if}\n\n\t{#if activeTab == 'isochrones' && one.match}\n\t\t<Control class=\"min-h-0 md:mb-2 {isochronesOptions.status == 'DONE' ? 'hide' : ''}\">\n\t\t\t<Card class=\"w-[520px] overflow-y-auto overflow-x-hidden bg-background rounded-lg\">\n\t\t\t\t<IsochronesInfo options={isochronesOptions} />\n\t\t\t</Card>\n\t\t</Control>\n\t{/if}\n{/snippet}\n{#if dataLoaded}\n\t<Map\n\t\tbind:map\n\t\tbind:bounds\n\t\tbind:zoom\n\t\tbind:center\n\t\tclass={cn('h-dvh overflow-clip', theme)}\n\t\tstyle={showMap ? style : undefined}\n\t\tattribution={false}\n\t>\n\t\t{#if hasDebug}\n\t\t\t<Control position=\"top-right\" class=\"text-right\">\n\t\t\t\t<Debug {bounds} {level} {zoom} />\n\t\t\t</Control>\n\t\t{/if}\n\n\t\t<LevelSelect {bounds} {zoom} bind:level />\n\n\t\t{#if browser}\n\t\t\t{#if isSmallScreen}\n\t\t\t\t<Drawer class=\"relative z-10 h-full mt-5 flex flex-col\" bind:showMap>\n\t\t\t\t\t{@render resultContent()}\n\t\t\t\t</Drawer>\n\t\t\t{:else}\n\t\t\t\t<div class=\"maplibregl-ctrl-top-left flex flex-col max-h-[97vh]\">\n\t\t\t\t\t{@render resultContent()}\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t{/if}\n\n\t\t<div class=\"maplibregl-ctrl-{isSmallScreen ? 'top-left' : 'bottom-right'}\">\n\t\t\t<div class=\"maplibregl-ctrl maplibregl-ctrl-attrib\">\n\t\t\t\t<div class=\"maplibregl-ctrl-attrib-inner\">\n\t\t\t\t\t&copy; <a href=\"http://www.openstreetmap.org/copyright\" target=\"_blank\">OpenStreetMap</a>\n\t\t\t\t\t{#if dataAttributionLink}\n\t\t\t\t\t\t| <a href={dataAttributionLink} target=\"_blank\">{t.timetableSources}</a>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t{#if showMap}\n\t\t\t{#if activeTab != 'isochrones'}\n\t\t\t\t<Control position=\"top-right\" class=\"pb-4 text-right\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\tcolorMode = (function () {\n\t\t\t\t\t\t\t\tswitch (colorMode) {\n\t\t\t\t\t\t\t\t\tcase 'rt':\n\t\t\t\t\t\t\t\t\t\treturn 'route';\n\t\t\t\t\t\t\t\t\tcase 'route':\n\t\t\t\t\t\t\t\t\t\treturn 'mode';\n\t\t\t\t\t\t\t\t\tcase 'mode':\n\t\t\t\t\t\t\t\t\t\treturn 'none';\n\t\t\t\t\t\t\t\t\tcase 'none':\n\t\t\t\t\t\t\t\t\t\treturn 'rt';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{#if colorMode == 'rt'}\n\t\t\t\t\t\t\t<Rss class=\"h-[1.2rem] w-[1.2rem]\" />\n\t\t\t\t\t\t{:else if colorMode == 'mode'}\n\t\t\t\t\t\t\t<TrainFront class=\"h-[1.2rem] w-[1.2rem]\" />\n\t\t\t\t\t\t{:else if colorMode == 'none'}\n\t\t\t\t\t\t\t<Ban class=\"h-[1.2rem] w-[1.2rem]\" />\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<Palette class=\"h-[1.2rem] w-[1.2rem]\" />\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button size=\"icon\" onclick={() => getLocation()}>\n\t\t\t\t\t\t<LocateFixed class=\"w-5 h-5\" />\n\t\t\t\t\t</Button>\n\t\t\t\t</Control>\n\t\t\t\t<Rentals {map} {bounds} {zoom} {theme} debug={hasDebug} />\n\t\t\t{/if}\n\n\t\t\t<RailViz {map} {bounds} {zoom} {colorMode} />\n\t\t\t<Isochrones\n\t\t\t\t{map}\n\t\t\t\t{bounds}\n\t\t\t\t{isochronesData}\n\t\t\t\tstreetModes={arriveBy ? preTransitModes : postTransitModes}\n\t\t\t\twheelchair={pedestrianProfile === 'WHEELCHAIR'}\n\t\t\t\tmaxAllTime={arriveBy ? maxPreTransitTime : maxPostTransitTime}\n\t\t\t\tcircleResolution={isochronesCircleResolution}\n\t\t\t\tactive={activeTab == 'isochrones'}\n\t\t\t\tbind:options={isochronesOptions}\n\t\t\t/>\n\n\t\t\t<Popup trigger=\"contextmenu\" children={contextMenu} />\n\n\t\t\t{#if from && activeTab == 'connections'}\n\t\t\t\t<Marker\n\t\t\t\t\tcolor=\"green\"\n\t\t\t\t\tdraggable={true}\n\t\t\t\t\t{level}\n\t\t\t\t\tbind:location={from}\n\t\t\t\t\tbind:marker={fromMarker}\n\t\t\t\t/>\n\t\t\t{/if}\n\n\t\t\t{#if stop && activeTab == 'departures'}\n\t\t\t\t<Marker\n\t\t\t\t\tcolor=\"black\"\n\t\t\t\t\tdraggable={false}\n\t\t\t\t\t{level}\n\t\t\t\t\tbind:location={stop}\n\t\t\t\t\tbind:marker={stopMarker}\n\t\t\t\t/>\n\t\t\t{/if}\n\n\t\t\t{#if to && activeTab == 'connections'}\n\t\t\t\t<Marker color=\"red\" draggable={true} {level} bind:location={to} bind:marker={toMarker} />\n\t\t\t{/if}\n\n\t\t\t{#if one && activeTab == 'isochrones'}\n\t\t\t\t<Marker\n\t\t\t\t\tcolor=\"yellow\"\n\t\t\t\t\tdraggable={true}\n\t\t\t\t\t{level}\n\t\t\t\t\tbind:location={one}\n\t\t\t\t\tbind:marker={oneMarker}\n\t\t\t\t/>\n\t\t\t{/if}\n\t\t{/if}\n\t</Map>\n{/if}\n"],"names":["colors","getUrlBase","url","origin","pathname","getAbsoluteUrl","base","relative","getStyle","theme","level","staticBaseUrl","apiBaseUrl","c","createShield","opt","cv","ctx","l_front","l_back","lr_front","lr_back","lp_front","lp_back","p","map","$.prop","$$props","zoom","bounds","center","el","currStyle","$.proxy","setContext","updateStyle","createMap","container","tmp","maplibregl","scale","browser","e","$.user_effect","$.bind_this","div","$$value","joinInterlinedLegs","it","joinedLegs","i","pred","curr","polyline","preprocessItinerary","from","to","updateItinerary","r","translations","n","bg","pl","en","de","fr","cs","urlLanguage","translationsKey","l","language","t","cn","inputs","twMerge","clsx","urlParams","getUrlArray","key","defaultValue","value","m","preserveFromUrl","queryParams","field","pushStateWithQueryString","newState","replace","params","updateState","replaceState","pushState","tick","onClickStop","name","stopId","time","arriveBy","page","onClickTrip","tripId","itinerary","error","trip","initialized","Control","ctrl","getContext","$.set","onDestroy","$.template_effect","$0","classes","$.set_class","$.get","$.clsx","ref","className","restProps","$.rest_props","checked","$$render","consequent","$.derived","buttonVariants","tv","variant","size","href","type","a","button","alternate","COORD_LVL_REGEX","COORD_REGEX","parseCoordinatesToLocation","str","coordinateWithLevel","posToLocation","coordinate","pos","lat","lng","label","parseLocation","place","coord","getModeStyle","getColor","_","defaultColor","defaultTextColor","routeBorderColor","routeColor","color","textColor","mode","$.noop","modeIcon","modeColor","items","selected","onChange","inputValue","match","getDisplayArea","matchedArea","defaultArea","area","areas","sorted","b","getLabel","displayArea","updateGuesses","biasPlace","matches","geocode","shown","x","entry","deserialize","s","timer","$.each","node_5","item","modeCircle","consequent_2","consequent_3","consequent_1","alternate_1","alternate_2","div_3","consequent_4","consequent_5","highlighted","$.snippet","node_3","sideOffset","orientation","Root","SelectPrimitive.Root","defaultQuery","omitDefaults","query","queryCopy","formatDurationMin","hours","minutes","formatDurationSec","formatDistanceMeters","kilometers","meters","prePostDirectModes","getPrePostDirectModes","modes","formFactors","formFactor","getFormFactors","prePostModesToModes","rentalMode","possibleTransitModes","labelFormatter","v","bind_get","bind_set","$.set_text","text","option","text_1","DEFAULT_FORM_FACTOR","ICON_TYPES","ICON_BASE_PATH","formFactorAssets","propulsionTypes","Zap","PlugZap","Fuel","returnConstraints","FlagTriangleLeft","RefreshCcw","getIconBaseName","getIconUrl","iconTypeDimensions","getIconDimensions","colorizeIcon","svgUrl","dimensions","response","svgContent","svgDoc","rootElement","svgRoot","existingStyle","colorStyle","mergedStyle","serialized","blob","resolve","reject","blob_url","image","createZoomScaledSize","baseSize","zoomScaledIconSize","zoomScaledTextSizeMedium","zoomScaledTextSizeSmall","createZoomScaledTextOffset","baseOffset","zoomScaledTextOffset","DEFAULT_COLOR","maxTransitTime","ignoreRentalReturnConstraints","providerGroups","availableModes","providerGroupsQuery","createQuery","data","rentals","allProviderGroupOptions","group","selectedRentalFormFactors","providerGroupOptions","containsRental","showRental","deduped","validIds","filtered","id","selectedModesLabel","selectedProviderGroupsLabel","names","text_2","text_3","duration","$$anchor","$1","text_4","node_13","ff","icon","$.set_style","div_5","text_7","text_5","transitModes","availableTransitModes","selectTransitModesLabel","generateTimes","limit","times","via","viaMinimumStay","viaLabels","possibleViaStayDurations","viaMinimumStayOptions","vias","$.state","add","remove","index","oldVia","nextVia","f","oldViaMinimumStay","nextViaMinimumStay","nextViaLabels","_viaStop","useRoutedTransfers","wheelchair","requireBikeTransport","requireCarTransport","maxTransfers","maxTravelTime","possibleMaxTravelTimes","preTransitModes","postTransitModes","directModes","maxPreTransitTime","maxPostTransitTime","maxDirectTime","elevationCosts","ignorePreTransitRentalReturnConstraints","ignorePostTransitRentalReturnConstraints","ignoreDirectRentalReturnConstraints","preTransitProviderGroups","postTransitProviderGroups","directProviderGroups","possibleMaxTransfers","possibleDirectDurations","possiblePrePostDurations","setModes","possibleElevationCosts","expanded","allowElevationCosts","allowStreetRouting","allowRoutedTransfers","costs","div_2","dateTimeLocalValue","input","fakeUtcTime","pedestrianProfile","fromItems","toItems","getLocation","applyPosition","position","tmpItems","bind_get_1","bind_set_1","restoreScroll","saveScroll","handlePopState","event","resetScroll","onMount","getErrorType","status","Icon","CircleCheck","CircleAlert","SearchX","ServerCrash","formatTime","d","timeZone","formatDate","formatDateTime","getTz","timeZoneOffset","part","scheduled","delayMinutes","highDelay","lowDelay","early","notOnTime","roughlyOnTime","isValidDate","isSameAsBrowserTimezone","weekday","modeStyles","leg","$.index","$$item","$$array","throwOnError","promise","res","rI","plan","button_1","$$array_1","legSummary","text_6","button_2","text_9","DialogPrimitive.Root","Trigger","DialogPrimitive.Trigger","Portal","DialogPrimitive.Portal","alerts","node_10","alert","impactPeriod","start","end","text_10","getModeName","getModeLabel","timestamp","scheduledTimestamp","isRealtime","isStartOrEnd","hidePlatform","pickupNotAllowedOrEnd","dropoffNotAllowedOrStart","switchTo","stepsWithElevation","stepsWithToll","stepsWithAccessRestriction","consequent_6","consequent_7","text_11","acc","consequent_8","text_14","consequent_9","text_15","array","consequent_10","product","consequent_11","consequent_12","consequent_13","consequent_14","text_16","ticketInfo","prevTransitLeg","fareTransfer","includedInTransfer","text_21","productOptions","text_22","consequent_16","ul","products","node_29","productInfo","consequent_15","alternate_3","consequent_17","consequent_18","isRelevantLeg","lastLeg","node_31","isLast","isLastPred","next","text_23","consequent_19","text_24","consequent_20","transferProducts","text_25","consequent_21","ul_1","consequent_22","consequent_23","consequent_24","stopTimes","node_41","consequent_25","text_26","text_28","consequent_26","alternate_4","text_29","consequent_27","text_30","consequent_28","text_31","consequent_29","node_51","node_52","consequent_30","alternate_5","consequent_31","consequent_32","div_20","node_57","consequent_34","streetLeg","consequent_35","div_28","consequent_36","consequent_33","alternate_6","node_61","div_31","beforeLayerId","pendingMoves","ensurePendingState","state","click","mousemove","mouseenter","mouseleave","processPendingMoves","layerId","beforeId","scheduleMoveLayer","clearPendingForLayer","layer","source","currFilter","$.snapshot","currLayout","currPaint","currBefore","updateLayer","before","lineMetrics","sourceId","updateSource","src","currentLevel","ceilFromLevel","ceilToLevel","floorFromLevel","floorToLevel","isCurrentLevelRoutingFilter","isLowerLevelRoutingFilter","isUpperLevelRoutingFilter","leadsToUpperLevelRoutingFilter","leadsDownToCurrentLevelRoutingFilter","leadsToLowerLevelRoutingFilter","leadsUpToCurrentLevelRoutingFilter","routingPathFillColor","routingPathOutlineColor","routingPathOtherLevelFillColor","routingPathOtherLevelOutlineColor","routingPathWidth","routingPathOutlineWidth","layers","PRECISION","isIndividualTransport","getIndividualModeColor","itineraryToGeoJSON","outlineColor","colord","y","geojson","node_1","node_6","table","tbody","td","th","thead","tr","location","marker","popupEl","popup","features","close","onTrigger","onMouseEnter","onMouseLeave","_1","_2","node","baseUrl","client","post","path","req","get","toLocation","getRoute","getMatches","getFlex","min","max","getElevators","updateElevator","getGraph","debug","fps","transfers","flex","parseElevator","graph","elevators","profile","destination","route","elevatorUpdate","elevator","$.await","text_27","node_62","props","propertiesTable","node_66","node_72","lngLatToStr","LEVEL_MIN_ZOOM","availableLevels","levels","showMap","maxTranslate","minTranslate","startY","currentY","isDragging","fromHandle","getScrollableElement","element","overflowY","ontouchstart","target","scrollableElement","ontouchmove","delta","baseTranslate","ontouchend","div_1","div_4","stopNameFromResponse","stop","responses","stoptimes","placeFromResponse","node_2","stopTime","$$restProps","TabsPrimitive.Root","DisplayLevels","isLess","minDisplayLevel","isCanvasLevel","options","emptyGeometry","objects","bestAvailableDisplayLevel","kilometersPerSecond","boundingBox","boxCoords","lastData","lastMaxAllTime","lastSpeed","dataIndex","canvasLayer","circlesLayer","canvas","offscreenCanvas","canvasSource","circlesSource","worker","WebWorker","method","currentDisplayLevel","nextLevel","displayLevels","possibleDisplayLevels","$.bind_value","one","minutesToSeconds","oneItems","lastSearchDir","swapPrePostData","searchDir","tmpModes","tmpTime","tmpProviderGroups","showActions","debugInfo","vt","copyDebugInfo","vehicleRows","count","vehicle","PropulsionIcon","ReturnIcon","$.set_attribute","use","td_3","text_8","vehicleType","propulsion","returnConstraint","span","span_2","allZonesAtPoint","zoneData","stationData","feature","zone","station","DEFAULT_OPACITY","STRIPE_WIDTH_PX","STRIPE_OPACITY_VARIATION","POSITION_COMPONENTS","POSITION_STRIDE_BYTES","COLOR_COMPONENTS","COLOR_STRIDE_BYTES","FILL_VERTEX_SHADER_SOURCE","FILL_FRAGMENT_SHADER_SOURCE","QUAD_VERTICES","SCREEN_VERTEX_SHADER_SOURCE","SCREEN_FRAGMENT_SHADER_SOURCE","ZONE_COLOR_ALLOWED","ZONE_COLOR_FORBIDDEN","ZONE_COLOR_RESTRICTED","ZONE_COLOR_STATION","getZoneColor","properties","encodePickingColor","decodePickingColor","px","toClipCoordinates","width","height","pixelRatioX","pixelRatioY","lngLat","point","py","clipX","clipY","computeZoneClipFrame","extent","originLngLat","maxLngLat","maxClip","scaleX","scaleY","toPoint","ZoneFillLayer","opacity","gl","_map","_options","fillProgram","rect","cssWidth","cssHeight","clipFrame","previousFramebuffer","previousViewport","blendEnabled","depthTestEnabled","stencilTestEnabled","cullFaceEnabled","renderToFramebuffer","fb","colorBuffer","prevBlendSrcRGB","prevBlendDstRGB","prevBlendSrcAlpha","prevBlendDstAlpha","prevBlendEquationRGB","prevBlendEquationAlpha","minOpacity","maxOpacity","program","vertexSrc","fragmentSrc","vertexShader","fragmentShader","shader","zoneGeometries","colorValues","pickingValues","totalVertices","globalMinX","globalMinY","globalMaxX","globalMaxY","zoneIdx","geometry","vertexCount","pickingIdx","pickingColor","extentX","extentY","positions","posOffset","colorArray","pickingArray","pointLike","pt","pixelX","pixelY","vertices","minX","minY","maxX","maxY","appendPoly","coords","mercatorCoords","ring","merc","flatten","indices","earcut","stride","polygon","layerInstance","pendingRetryHandler","currentFeatures","lastOpacity","ensureLayerInstance","disposeLayerInstance","getLayerIndex","mapInstance","clearPendingRetry","removeFromMap","instance","ensureLayerOrder","layerIndex","targetIndex","addLayerIfNeeded","attemptAddLayer","retry","handleStyleData","pick","zoneLayerRef","MIN_ZOOM","FETCH_PADDING_RATIO","STATION_SOURCE_ID","STATION_ICON_LAYER_ID","VEHICLE_SOURCE_PREFIX","VEHICLE_CLUSTER_RADIUS","ZONE_LAYER_ID","getIconId","rentalsData","loadedBounds","requestToken","displayFilter","iconsReady","iconRequestToken","activeIconIds","SvelteSet","vehicleLayerConfigs","slug","buildProviderGroupOptions","providerGroupColors","providerColors","provider","vehicleTypeFormFactorsByProviderId","isSameFilter","toggleFilter","clamp","expandBounds","sw","ne","padLng","padLat","boundsContain","outer","inner","fetchRentals","mapBounds","expandedBounds","token","current","collectFormFactorsByColor","formFactorsByColor","providerColorById","providerGroupColorById","addFormFactor","stationAvailability","formFactorsByProvider","filter","sum","typeId","stationFeatures","vehicleCollections","collections","collection","buildZoneGeometry","mp","encoded","findMatchingRule","rule","idx","zoneFeatures","maxGeofencingZ","candidate","stationAreaZ","zoneRTree","rtree","RBush","bbox","createScopedId","providerId","entityId","providerById","stationById","vehicleById","lookupStation","lookupVehicle","lookupZoneOrStation","createStationContent","component","mount","StationPopup","unmount","createVehicleContent","VehiclePopup","createZoneContent","rideThroughAllowed","rideEndAllowed","ZonePopup","tooltipPopup","detailPopup","activeTooltipKey","activePopupKey","lastHoverCanvas","tooltipContentDestroy","popupContentDestroy","ensureTooltipPopup","ensureDetailPopup","hideTooltip","hidePopup","resetHoverCursor","showTooltip","targetMap","createContent","destroy","showPopup","createMouseMoveHandler","lookup","result","entity","createMouseLeaveHandler","_event","_mapInstance","createClickHandler","handleStationMouseMove","handleStationMouseLeave","handleStationClick","handleClusterClick","clusterId","handleClusterMouseEnter","handleClusterMouseLeave","handleVehicleMouseMove","handleVehicleMouseLeave","handleVehicleClick","handleZoneClick","priorityLayers","booleanPointInPolygon","clearMapIcons","neededIds","tasks","addError","previousIds","newActiveIds","hasZones","handler","config","active","svg","stopsToGeoJSON","legs","stops","intermediateStops","createTripIcon","border","padding","innerSize","mid","rad","rgbToHex","rgba","getDelayColor","delay","realTime","startTime","endTime","canceled","isProcessing","TRIPS_NUM","angles","DATA","hoverCoordinate","activeHoverIndex","onHover","metadata","metaDataMap","onClick","updatePopup","content","TripIcon","IconMapping","createLayer","IconLayer","animationId","animate","untrack","overlay","SvelteMap","length","incomingMetaData","MapboxOverlay","contextMenu","fromMarker","toMarker","oneMarker","activeTab","isochronesOptions","isSmallScreen","selectedItinerary","node_16","routingResponses","node_17","hasDebug","hasDark","hasLight","dataAttributionLink","colorMode","lastOneToAllQuery","lastPlanQuery","serverConfig","dataLoaded","style","geolocate","initial","applyPageStateFromURL","parseIntOr","stopMarker","viaParam","timetableView","searchWindow","numItineraries","maxItineraries","algorithm","slowDirect","isochronesData","isochronesCircleResolution","toPlaceString","providerGroupsForQuery","groups","baseQuery","isochronesQuery","searchDebounceTimer","baseResponse","q","isochronesQueryTimeout","isochronesColor","isochronesOpacity","isochronesDisplayLevel","oneToAll","all","paste","json","flyToItineraries","itineraries","box","flyToLocation","flyToSelectedItinerary","resultContent","node_36","$3"],"mappings":"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"}