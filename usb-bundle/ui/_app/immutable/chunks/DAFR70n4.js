function ot(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const Ot=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),Ct=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Ct&&parseFloat(Ct[1]);const Dt=globalThis,zt=globalThis.process||{},Je=globalThis.navigator||{};function pe(t){if(typeof window<"u"&&window.process?.type==="renderer"||typeof process<"u"&&process.versions?.electron)return!0;const n=typeof navigator<"u"&&navigator.userAgent;return!!(n&&n.indexOf("Electron")>=0)}function ht(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process?.browser)||pe()}function yi(t){return ht()?pe()?"Electron":(Je.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node"}const we="4.1.0";function Xe(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class tn{constructor(e,n,r="sessionStorage"){this.storage=Xe(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function en(t){let e;return t<10?e=`${t.toFixed(2)}ms`:t<100?e=`${t.toFixed(1)}ms`:t<1e3?e=`${t.toFixed(0)}ms`:e=`${(t/1e3).toFixed(2)}s`,e}function nn(t,e=8){const n=Math.max(e-t.length,0);return`${" ".repeat(n)}${t}`}var ct;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(ct||(ct={}));const rn=10;function Vt(t){return typeof t!="string"?t:(t=t.toUpperCase(),ct[t]||ct.WHITE)}function sn(t,e,n){return!ht&&typeof t=="string"&&(e&&(t=`\x1B[${Vt(e)}m${t}\x1B[39m`),n&&(t=`\x1B[${Vt(n)+rn}m${t}\x1B[49m`)),t}function on(t,e=["constructor"]){const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),s=t;for(const i of r){const o=s[i];typeof o=="function"&&(e.find(c=>i===c)||(s[i]=o.bind(t)))}}function Pt(t,e){if(!t)throw new Error("Assertion failed")}function z(){let t;if(ht()&&Dt.performance)t=Dt?.performance?.now?.();else if("hrtime"in zt){const e=zt?.hrtime?.();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}const V={debug:ht()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},cn={enabled:!0,level:0};function G(){}const Gt={},jt={once:!0};class Bt{constructor({id:e}={id:""}){this.VERSION=we,this._startTs=z(),this._deltaTs=z(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new tn(`__probe-${this.id}__`,cn),this.timeStamp(`${this.id} started`),on(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((z()-this._startTs).toPrecision(10))}getDelta(){return Number((z()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){if(!e)throw new Error(n||"Assertion failed")}warn(e){return this._getLogFunction(0,e,V.warn,arguments,jt)}error(e){return this._getLogFunction(0,e,V.error,arguments)}deprecated(e,n){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${n}\` instead`)}removed(e,n){return this.error(`\`${e}\` has been removed. Use \`${n}\` instead`)}probe(e,n){return this._getLogFunction(e,n,V.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,V.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,V.debug||V.info,arguments,jt)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||G,r&&[r],{tag:fn(n)}):G}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||G)}group(e,n,r={collapsed:!1}){const s=Ht({logLevel:e,message:n,opts:r}),{collapsed:i}=r;return s.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(s)}groupCollapsed(e,n,r={}){return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||G)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=be(e)}_getLogFunction(e,n,r,s,i){if(this._shouldLog(e)){i=Ht({logLevel:e,message:n,args:s,opts:i}),r=r||i.method,Pt(r),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=z();const o=i.tag||i.message;if(i.once&&o)if(!Gt[o])Gt[o]=z();else return G;return n=an(this.id,i.message,i),r.bind(console,n,...i.args)}return G}}Bt.VERSION=we;function be(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Pt(Number.isFinite(e)&&e>=0),e}function Ht(t){const{logLevel:e,message:n}=t;t.logLevel=be(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const s=typeof t.message;return Pt(s==="string"||s==="object"),Object.assign(t,{args:r},t.opts)}function an(t,e,n){if(typeof e=="string"){const r=n.time?nn(en(n.total)):"";e=n.time?`${t}: ${r}  ${e}`:`${t}: ${e}`,e=sn(e,n.color,n.background)}return e}function fn(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const ut="4.3.3",hn=ut[0]>="0"&&ut[0]<="9"?`v${ut}`:"";function ln(){const t=new Bt({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=t,globalThis.loaders.version=hn,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=t,t}const un=ln();function gn(t,e){return Ee(t||{},e)}function Ee(t,e,n=0){if(n>3)return e;const r={...t};for(const[s,i]of Object.entries(e))i&&typeof i=="object"&&!Array.isArray(i)?r[s]=Ee(r[s]||{},e[s],n+1):r[s]=e[s];return r}const mn="latest";function dn(){return globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3"),globalThis._loadersgl_.version}const yn=dn();function F(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const W=typeof process!="object"||String(process)!=="[object process]"||process.browser,pn=typeof window<"u"&&typeof window.orientation<"u",qt=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);qt&&parseFloat(qt[1]);class wn{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,n){this.name=e,this.workerThread=n,this.result=new Promise((r,s)=>{this._resolve=r,this._reject=s})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){F(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){F(this.isRunning),this.isRunning=!1,this._reject(e)}}class gt{terminate(){}}const mt=new Map;function bn(t){F(t.source&&!t.url||!t.source&&t.url);let e=mt.get(t.source||t.url);return e||(t.url&&(e=En(t.url),mt.set(t.url,e)),t.source&&(e=Te(t.source),mt.set(t.source,e))),F(e),e}function En(t){if(!t.startsWith("http"))return t;const e=Tn(t);return Te(e)}function Te(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Tn(t){return`try {
  importScripts('${t}');
} catch (error) {
  console.error(error);
  throw error;
}`}function Me(t,e=!0,n){const r=n||new Set;if(t){if(Yt(t))r.add(t);else if(Yt(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const s in t)Me(t[s],e,r)}}return n===void 0?Array.from(r):[]}function Yt(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const dt=()=>{};class Tt{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return typeof Worker<"u"&&W||typeof gt<"u"&&!W}constructor(e){const{name:n,source:r,url:s}=e;F(r||s),this.name=n,this.source=r,this.url=s,this.onMessage=dt,this.onError=i=>console.log(i),this.worker=W?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=dt,this.onError=dt,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||Me(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+=`worker ${this.name} from ${this.url}. `,e.message&&(n+=`${e.message} in `),e.lineno&&(n+=`:${e.lineno}:${e.colno}`),new Error(n)}_createBrowserWorker(){this._loadableURL=bn({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new gt(r,{eval:!1})}else if(this.source)e=new gt(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class Mn{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return Tt.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,n=(s,i,o)=>s.done(o),r=(s,i)=>s.error(i)){const s=new Promise(i=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:i}),this));return this._startQueuedJob(),await s}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new wn(n.name,e);e.onMessage=s=>n.onMessage(r,s.type,s.payload),e.onError=s=>n.onError(r,s),n.onStart(r);try{await r.result}catch(s){console.error(`Worker exception: ${s}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!W||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new Tt({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return pn?this.maxMobileConcurrency:this.maxConcurrency}}const An={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class v{props;workerPools=new Map;static _workerFarm;static isSupported(){return Tt.isSupported()}static getWorkerFarm(e={}){return v._workerFarm=v._workerFarm||new v({}),v._workerFarm.setProps(e),v._workerFarm}constructor(e){this.props={...An},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:s}=e;let i=this.workerPools.get(n);return i||(i=new Mn({name:n,source:r,url:s}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function Ln(t,e={}){const n=e[t.id]||{},r=W?`${t.id}-worker.js`:`${t.id}-worker-node.js`;let s=n.workerUrl;if(!s&&t.id==="compression"&&(s=e.workerUrl),e._workerType==="test"&&(W?s=`modules/${t.module}/dist/${r}`:s=`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!s){let i=t.version;i==="latest"&&(i=mn);const o=i?`@${i}`:"";s=`https://unpkg.com/@loaders.gl/${t.module}${o}/dist/${r}`}return F(s),s}function _n(t,e=yn){F(t,"no worker provided");const n=t.version;return!(!e||!n)}function kn(t,e){return!v.isSupported()||!W&&!e?._nodeWorkers?!1:t.worker&&e?.worker}async function Sn(t,e,n,r,s){const i=t.id,o=Ln(t,n),a=v.getWorkerFarm(n).getWorkerPool({name:i,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const f=await a.startJob("process-on-worker",xn.bind(null,s));return f.postMessage("process",{input:e,options:n,context:r}),await(await f.result).result}async function xn(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:s,input:i,options:o}=r;try{const c=await t(i,o);e.postMessage("done",{id:s,result:c})}catch(c){const a=c instanceof Error?c.message:"unknown error";e.postMessage("error",{id:s,error:a})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}function Rn(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),s=new Uint8Array(e);for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}function Nn(...t){return On(t)}function On(t){const e=t.map(i=>i instanceof ArrayBuffer?new Uint8Array(i):i),n=e.reduce((i,o)=>i+o.byteLength,0),r=new Uint8Array(n);let s=0;for(const i of e)r.set(i,s),s+=i.byteLength;return r.buffer}async function Pn(t){const e=[];for await(const n of t)e.push(n);return Nn(...e)}function Qt(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class Kt{constructor(e,n){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Qt(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Qt()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class pi{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,n="count"){return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let s=this.stats[n];return s||(e instanceof Kt?s=e:s=new Kt(n,r),this.stats[n]=s),s}}let Bn="";const Zt={};function $n(t){for(const e in Zt)if(t.startsWith(e)){const n=Zt[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t=`${Bn}${t}`),t}function Un(t){return t&&typeof t=="object"&&t.isBuffer}function Ae(t){if(Un(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function Le(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function In(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const vn=t=>typeof t=="boolean",K=t=>typeof t=="function",X=t=>t!==null&&typeof t=="object",Jt=t=>X(t)&&t.constructor==={}.constructor,Fn=t=>!!t&&typeof t[Symbol.iterator]=="function",Wn=t=>t&&typeof t[Symbol.asyncIterator]=="function",C=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,D=t=>typeof Blob<"u"&&t instanceof Blob,Cn=t=>t&&typeof t=="object"&&t.isBuffer,Dn=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||X(t)&&K(t.tee)&&K(t.cancel)&&K(t.getReader),zn=t=>X(t)&&K(t.read)&&K(t.pipe)&&vn(t.readable),_e=t=>Dn(t)||zn(t);class Vn extends Error{constructor(e,n){super(e),this.reason=n.reason,this.url=n.url,this.response=n.response}reason;url;response}const Gn=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,jn=/^([-\w.]+\/[-\w.+]+)/;function Xt(t,e){return t.toLowerCase()===e.toLowerCase()}function Hn(t){const e=jn.exec(t);return e?e[1]:t}function te(t){const e=Gn.exec(t);return e?e[1]:""}const ke=/\?.*/;function qn(t){const e=t.match(ke);return e&&e[0]}function $t(t){return t.replace(ke,"")}function Yn(t){if(t.length<50)return t;const e=t.slice(t.length-15);return`${t.substr(0,32)}...${e}`}function lt(t){return C(t)?t.url:D(t)?t.name||"":typeof t=="string"?t:""}function Ut(t){if(C(t)){const e=t,n=e.headers.get("content-type")||"",r=$t(e.url);return Hn(n)||te(r)}return D(t)?t.type||"":typeof t=="string"?te(t):""}function Qn(t){return C(t)?t.headers["content-length"]||-1:D(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function Se(t){if(C(t))return t;const e={},n=Qn(t);n>=0&&(e["content-length"]=String(n));const r=lt(t),s=Ut(t);s&&(e["content-type"]=s);const i=await Jn(t);i&&(e["x-first-bytes"]=i),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function Kn(t){if(!t.ok)throw await Zn(t)}async function Zn(t){const e=Yn(t.url);let n=`Failed to fetch resource (${t.status}) ${t.statusText}: ${e}`;n=n.length>100?`${n.slice(0,100)}...`:n;const r={reason:t.statusText,url:t.url,response:t};try{const s=t.headers.get("Content-Type");r.reason=!t.bodyUsed&&s?.includes("application/json")?await t.json():await t.text()}catch{}return new Vn(n,r)}async function Jn(t){if(typeof t=="string")return`data:,${t.slice(0,5)}`;if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const s=new FileReader;s.onload=i=>r(i?.target?.result),s.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5);return`data:base64,${Xn(n)}`}return null}function Xn(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}function tr(t){return!er(t)&&!nr(t)}function er(t){return t.startsWith("http:")||t.startsWith("https:")}function nr(t){return t.startsWith("data:")}async function ee(t,e){if(typeof t=="string"){const n=$n(t);return tr(n)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(n,e):await fetch(n,e)}return await Se(t)}const ne=new Bt({id:"loaders.gl"});class rr{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class sr{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const xe={fetch:null,mimeType:void 0,nothrow:!1,log:new sr,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Ot,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},ir={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Re(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state||(t._state={}),t._state}function Ne(){const t=Re();return t.globalOptions=t.globalOptions||{...xe},t.globalOptions}function or(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],cr(t,n),fr(e,t,r)}function cr(t,e){re(t,null,xe,ir,e);for(const n of e){const r=t&&t[n.id]||{},s=n.options&&n.options[n.id]||{},i=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};re(r,n.id,s,i,e)}}function re(t,e,n,r,s){const i=e||"Top level",o=e?`${e}.`:"";for(const c in t){const a=!e&&X(t[c]),f=c==="baseUri"&&!e,h=c==="workerUrl"&&e;if(!(c in n)&&!f&&!h){if(c in r)ne.warn(`${i} loader option '${o}${c}' no longer supported, use '${r[c]}'`)();else if(!a){const l=ar(c,s);ne.warn(`${i} loader option '${o}${c}' not recognized. ${l}`)()}}}}function ar(t,e){const n=t.toLowerCase();let r="";for(const s of e)for(const i in s.options){if(t===i)return`Did you mean '${s.id}.${i}'?`;const o=i.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||`Did you mean '${s.id}.${i}'?`)}return r}function fr(t,e,n){const s={...t.options||{}};return hr(s,n),s.log===null&&(s.log=new rr),se(s,Ne()),se(s,e),s}function se(t,e){for(const n in e)if(n in e){const r=e[n];Jt(r)&&Jt(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function hr(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function It(t){return t?(Array.isArray(t)&&(t=t[0]),Array.isArray(t?.extensions)):!1}function vt(t){ot(t,"null loader"),ot(It(t),"invalid loader");let e;return Array.isArray(t)&&(e=t[1],t=t[0],t={...t,options:{...t.options,...e}}),(t?.parseTextSync||t?.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const Oe=()=>{const t=Re();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function wi(t){const e=Oe();t=Array.isArray(t)?t:[t];for(const n of t){const r=vt(n);e.find(s=>r===s)||e.unshift(r)}}function lr(){return Oe()}const ur=/\.([^.]+)$/;async function gr(t,e=[],n,r){if(!Pe(t))return null;let s=ie(t,e,{...n,nothrow:!0},r);if(s)return s;if(D(t)&&(t=await t.slice(0,10).arrayBuffer(),s=ie(t,e,n,r)),!s&&!n?.nothrow)throw new Error(Be(t));return s}function ie(t,e=[],n,r){if(!Pe(t))return null;if(e&&!Array.isArray(e))return vt(e);let s=[];e&&(s=s.concat(e)),n?.ignoreRegisteredLoaders||s.push(...lr()),dr(s);const i=mr(t,s,n,r);if(!i&&!n?.nothrow)throw new Error(Be(t));return i}function mr(t,e,n,r){const s=lt(t),i=Ut(t),o=$t(s)||r?.url;let c=null,a="";return n?.mimeType&&(c=yt(e,n?.mimeType),a=`match forced by supplied MIME type ${n?.mimeType}`),c=c||yr(e,o),a=a||(c?`matched url ${o}`:""),c=c||yt(e,i),a=a||(c?`matched MIME type ${i}`:""),c=c||wr(e,t),a=a||(c?`matched initial data ${$e(t)}`:""),n?.fallbackMimeType&&(c=c||yt(e,n?.fallbackMimeType),a=a||(c?`matched fallback MIME type ${i}`:"")),a&&un.log(1,`selectLoader selected ${c?.name}: ${a}.`),c}function Pe(t){return!(t instanceof Response&&t.status===204)}function Be(t){const e=lt(t),n=Ut(t);let r="No valid loader found (";r+=e?`${Le(e)}, `:"no url provided, ",r+=`MIME type: ${n?`"${n}"`:"not provided"}, `;const s=t?$e(t):"";return r+=s?` first bytes: "${s}"`:"first bytes: not available",r+=")",r}function dr(t){for(const e of t)vt(e)}function yr(t,e){const n=e&&ur.exec(e),r=n&&n[1];return r?pr(t,r):null}function pr(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function yt(t,e){for(const n of t)if(n.mimeTypes?.some(r=>Xt(e,r))||Xt(e,`application/x.${n.id}`))return n;return null}function wr(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(br(e,n))return n}else if(ArrayBuffer.isView(e)){if(oe(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&oe(e,0,n))return n;return null}function br(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function oe(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(s=>Er(t,e,n,s))}function Er(t,e,n,r){if(r instanceof ArrayBuffer)return Rn(r,t,r.byteLength);switch(typeof r){case"function":return r(t);case"string":const s=Mt(t,e,r.length);return r===s;default:return!1}}function $e(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?Mt(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?Mt(t,0,e):""}function Mt(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let s="";for(let i=0;i<n;i++)s+=String.fromCharCode(r.getUint8(e+i));return s}const Tr=256*1024;function*Mr(t,e){const n=e?.chunkSize||Tr;let r=0;const s=new TextEncoder;for(;r<t.length;){const i=Math.min(t.length-r,n),o=t.slice(r,r+i);r+=i,yield s.encode(o)}}const Ar=256*1024;function*Lr(t,e={}){const{chunkSize:n=Ar}=e;let r=0;for(;r<t.byteLength;){const s=Math.min(t.byteLength-r,n),i=new ArrayBuffer(s),o=new Uint8Array(t,r,s);new Uint8Array(i).set(o),r+=s,yield i}}const _r=1024*1024;async function*kr(t,e){const n=e?.chunkSize||_r;let r=0;for(;r<t.size;){const s=r+n,i=await t.slice(r,s).arrayBuffer();r=s,yield i}}function ce(t,e){return Ot?Sr(t,e):xr(t)}async function*Sr(t,e){const n=t.getReader();let r;try{for(;;){const s=r||n.read();e?._streamReadAhead&&(r=n.read());const{done:i,value:o}=await s;if(i)return;yield Ae(o)}}catch{n.releaseLock()}}async function*xr(t,e){for await(const n of t)yield Ae(n)}function Rr(t,e){if(typeof t=="string")return Mr(t,e);if(t instanceof ArrayBuffer)return Lr(t,e);if(D(t))return kr(t,e);if(_e(t))return ce(t,e);if(C(t))return ce(t.body,e);throw new Error("makeIterator")}const Ue="Cannot convert supplied data type";function Nr(t,e,n){if(e.text&&typeof t=="string")return t;if(Cn(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const s=t.byteLength||t.length;return(t.byteOffset!==0||s!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+s)),r}throw new Error(Ue)}async function Or(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return Nr(t,e);if(D(t)&&(t=await Se(t)),C(t)){const s=t;return await Kn(s),e.binary?await s.arrayBuffer():await s.text()}if(_e(t)&&(t=Rr(t,n)),Fn(t)||Wn(t))return Pn(t);throw new Error(Ue)}function Ie(t,e){const n=Ne(),r=t||n;return typeof r.fetch=="function"?r.fetch:X(r.fetch)?s=>ee(s,r.fetch):e?.fetch?e?.fetch:ee}function Pr(t,e,n){if(n)return n;const r={fetch:Ie(e,t),...t};if(r.url){const s=$t(r.url);r.baseUrl=s,r.queryString=qn(r.url),r.filename=Le(s),r.baseUrl=In(s)}return Array.isArray(r.loaders)||(r.loaders=null),r}function Br(t,e){if(t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:void 0}async function at(t,e,n,r){e&&!Array.isArray(e)&&!It(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const s=lt(t),o=Br(e,r),c=await gr(t,o,n);return c?(n=or(n,c,o,s),r=Pr({url:s,_parse:at,loaders:o},n,r||null),await $r(c,t,n,r)):null}async function $r(t,e,n,r){if(_n(t),n=gn(t.options,n),C(e)){const i=e,{ok:o,redirected:c,status:a,statusText:f,type:h,url:l}=i,u=Object.fromEntries(i.headers.entries());r.response={headers:u,ok:o,redirected:c,status:a,statusText:f,type:h,url:l}}e=await Or(e,t,n);const s=t;if(s.parseTextSync&&typeof e=="string")return s.parseTextSync(e,n,r);if(kn(t,n))return await Sn(t,e,n,r,at);if(s.parseText&&typeof e=="string")return await s.parseText(e,n,r);if(s.parse)return await s.parse(e,n,r);throw F(!s.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}async function bi(t,e,n,r){let s,i;!Array.isArray(e)&&!It(e)?(s=[],i=e):(s=e,i=n);const o=Ie(i);let c=t;return typeof t=="string"&&(c=await o(t)),D(t)&&(c=await o(t)),Array.isArray(s)?await at(c,s,i):await at(c,s,i)}const Ur="4.3.3",Ir=globalThis.loaders?.parseImageNode,At=typeof Image<"u",Lt=typeof ImageBitmap<"u",vr=!!Ir,_t=Ot?!0:vr;function Fr(t){switch(t){case"auto":return Lt||At||_t;case"imagebitmap":return Lt;case"image":return At;case"data":return _t;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function Wr(){if(Lt)return"imagebitmap";if(At)return"image";if(_t)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function Cr(t){const e=zr(t);if(!e)throw new Error("Not an image");return e}function Dr(t){switch(Cr(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function zr(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const Vr=/^data:image\/svg\+xml/,Gr=/\.svg((\?|#).*)?$/;function Ft(t){return t&&(Vr.test(t)||Gr.test(t))}function jr(t,e){if(Ft(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(i){throw new Error(i.message)}return`data:image/svg+xml;base64,${btoa(r)}`}return ve(t,e)}function ve(t,e){if(Ft(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Fe(t,e,n){const r=jr(t,n),s=self.URL||self.webkitURL,i=typeof r!="string"&&s.createObjectURL(r);try{return await Hr(i||r,e)}finally{i&&s.revokeObjectURL(i)}}async function Hr(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,s)=>{try{n.onload=()=>r(n),n.onerror=i=>{const o=i instanceof Error?i.message:"error";s(new Error(o))}}catch(i){s(i)}})}const qr={};let ae=!0;async function Yr(t,e,n){let r;Ft(n)?r=await Fe(t,e,n):r=ve(t,n);const s=e&&e.imagebitmap;return await Qr(r,s)}async function Qr(t,e=null){if((Kr(e)||!ae)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),ae=!1}return await createImageBitmap(t)}function Kr(t){for(const e in t||qr)return!1;return!0}function Zr(t){return!es(t,"ftyp",4)||(t[8]&96)===0?null:Jr(t)}function Jr(t){switch(Xr(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Xr(t,e,n){return String.fromCharCode(...t.slice(e,n))}function ts(t){return[...t].map(e=>e.charCodeAt(0))}function es(t,e,n=0){const r=ts(e);for(let s=0;s<r.length;++s)if(r[s]!==t[s+n])return!1;return!0}const U=!1,Z=!0;function We(t){const e=tt(t);return rs(e)||os(e)||ss(e)||is(e)||ns(e)}function ns(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=Zr(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function rs(t){const e=tt(t);return e.byteLength>=24&&e.getUint32(0,U)===2303741511?{mimeType:"image/png",width:e.getUint32(16,U),height:e.getUint32(20,U)}:null}function ss(t){const e=tt(t);return e.byteLength>=10&&e.getUint32(0,U)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Z),height:e.getUint16(8,Z)}:null}function is(t){const e=tt(t);return e.byteLength>=14&&e.getUint16(0,U)===16973&&e.getUint32(2,Z)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Z),height:e.getUint32(22,Z)}:null}function os(t){const e=tt(t);if(!(e.byteLength>=3&&e.getUint16(0,U)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:s}=cs();let i=2;for(;i+9<e.byteLength;){const o=e.getUint16(i,U);if(s.has(o))return{mimeType:"image/jpeg",height:e.getUint16(i+5,U),width:e.getUint16(i+7,U)};if(!r.has(o))return null;i+=2,i+=e.getUint16(i,U)}return null}function cs(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function tt(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function as(t,e){const{mimeType:n}=We(t)||{},r=globalThis.loaders?.parseImageNode;return ot(r),await r(t,n)}async function fs(t,e,n){e=e||{};const s=(e.image||{}).type||"auto",{url:i}=n||{},o=hs(s);let c;switch(o){case"imagebitmap":c=await Yr(t,e,i);break;case"image":c=await Fe(t,e,i);break;case"data":c=await as(t);break;default:ot(!1)}return s==="data"&&(c=Dr(c)),c}function hs(t){switch(t){case"auto":case"data":return Wr();default:return Fr(t),t}}const ls=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],us=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],gs={image:{type:"auto",decode:!0}},Ei={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:Ur,mimeTypes:us,extensions:ls,parse:fs,tests:[t=>!!We(new DataView(t))],options:gs},ms={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...ms}};const R=globalThis.mathgl.config;function ds(t,{precision:e=R.precision}={}){return t=ps(t),`${parseFloat(t.toPrecision(e))}`}function H(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Ti(t,e,n){return bs(t,r=>Math.max(e,Math.min(n,r)))}function ys(t,e,n){return H(t)?t.map((r,s)=>ys(r,e[s],n)):n*e+(1-n)*t}function Ce(t,e,n){const r=R.EPSILON;try{if(t===e)return!0;if(H(t)&&H(e)){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(!Ce(t[s],e[s]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=R.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{R.EPSILON=r}}function ps(t){return Math.round(t/R.EPSILON)*R.EPSILON}function ws(t){return t.clone?t.clone():new Array(t.length)}function bs(t,e,n){if(H(t)){const r=t;n=n||ws(r);for(let s=0;s<n.length&&s<r.length;++s){const i=typeof t=="number"?t:t[s];n[s]=e(i,s,n)}return n}return e(t)}class De extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:H(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(R)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+ds(this[r],e);return`${e.printTypes?this.constructor.name:""}[${n}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Ce(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let s=0;s<this.ELEMENTS;++s){const i=e[s],o=typeof n=="number"?n:n[s];this[s]=i+r*(o-i)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(R.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function Es(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function x(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function pt(t,e,n=""){if(R.debug&&!Es(t,e))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return t}function fe(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}class Ts extends De{get x(){return this[0]}set x(e){this[0]=x(e)}get y(){return this[1]}set y(e){this[1]=x(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const s=this[r]-e[r];n+=s*s}return x(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return x(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return fe(e>=0&&e<this.ELEMENTS,"index is out of range"),x(this[e])}setComponent(e,n){return fe(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}const it=1e-6;let q=typeof Float32Array<"u"?Float32Array:Array;function Ms(){const t=new q(2);return q!=Float32Array&&(t[0]=0,t[1]=0),t}function Mi(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Ai(t,e){return t[0]=-e[0],t[1]=-e[1],t}function ze(t,e,n,r){const s=e[0],i=e[1];return t[0]=s+r*(n[0]-s),t[1]=i+r*(n[1]-i),t}function As(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[4]*s+n[12],t[1]=n[1]*r+n[5]*s+n[13],t}(function(){const t=Ms();return function(e,n,r,s,i,o){let c,a;for(n||(n=2),r||(r=0),s?a=Math.min(s*n+r,e.length):a=e.length,c=r;c<a;c+=n)t[0]=e[c],t[1]=e[c+1],i(t,t,o),e[c]=t[0],e[c+1]=t[1];return e}})();function Ls(t,e,n){const r=e[0],s=e[1],i=n[3]*r+n[7]*s||1;return t[0]=(n[0]*r+n[4]*s)/i,t[1]=(n[1]*r+n[5]*s)/i,t}function Ve(t,e,n){const r=e[0],s=e[1],i=e[2],o=n[3]*r+n[7]*s+n[11]*i||1;return t[0]=(n[0]*r+n[4]*s+n[8]*i)/o,t[1]=(n[1]*r+n[5]*s+n[9]*i)/o,t[2]=(n[2]*r+n[6]*s+n[10]*i)/o,t}function _s(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s,t[1]=n[1]*r+n[3]*s,t[2]=e[2],t}function ks(){const t=new q(3);return q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Ss(t){const e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function xs(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Rs(t){const e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Ns(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Os(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ps(t,e,n){const r=e[0],s=e[1],i=e[2],o=n[0],c=n[1],a=n[2];return t[0]=s*a-i*c,t[1]=i*o-r*a,t[2]=r*c-s*o,t}function Li(t,e,n,r){const s=e[0],i=e[1],o=e[2];return t[0]=s+r*(n[0]-s),t[1]=i+r*(n[1]-i),t[2]=o+r*(n[2]-o),t}function Ge(t,e,n){const r=e[0],s=e[1],i=e[2];let o=n[3]*r+n[7]*s+n[11]*i+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*s+n[8]*i+n[12])/o,t[1]=(n[1]*r+n[5]*s+n[9]*i+n[13])/o,t[2]=(n[2]*r+n[6]*s+n[10]*i+n[14])/o,t}function Bs(t,e,n){const r=e[0],s=e[1],i=e[2];return t[0]=r*n[0]+s*n[3]+i*n[6],t[1]=r*n[1]+s*n[4]+i*n[7],t[2]=r*n[2]+s*n[5]+i*n[8],t}function $s(t,e,n){const r=n[0],s=n[1],i=n[2],o=n[3],c=e[0],a=e[1],f=e[2];let h=s*f-i*a,l=i*c-r*f,u=r*a-s*c,g=s*u-i*l,m=i*h-r*u,d=r*l-s*h;const y=o*2;return h*=y,l*=y,u*=y,g*=2,m*=2,d*=2,t[0]=c+h+g,t[1]=a+l+m,t[2]=f+u+d,t}function Us(t,e,n,r){const s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0],i[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),i[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Is(t,e,n,r){const s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),i[1]=s[1],i[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function vs(t,e,n,r){const s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),i[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),i[2]=s[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Fs(t,e){const n=t[0],r=t[1],s=t[2],i=e[0],o=e[1],c=e[2],a=Math.sqrt((n*n+r*r+s*s)*(i*i+o*o+c*c)),f=a&&Os(t,e)/a;return Math.acos(Math.min(Math.max(f,-1),1))}const _i=xs,ki=Ss,Si=Rs;(function(){const t=ks();return function(e,n,r,s,i,o){let c,a;for(n||(n=3),r||(r=0),s?a=Math.min(s*n+r,e.length):a=e.length,c=r;c<a;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],i(t,t,o),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2];return e}})();const wt=[0,0,0];let et;class je extends Ts{static get ZERO(){return et||(et=new je(0,0,0),Object.freeze(et)),et}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&H(e)?this.copy(e):(R.debug&&(x(e),x(n),x(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return R.debug&&(x(e.x),x(e.y),x(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=x(e)}angle(e){return Fs(this,e)}cross(e){return Ps(this,this,e),this.check()}rotateX({radians:e,origin:n=wt}){return Us(this,this,n,e),this.check()}rotateY({radians:e,origin:n=wt}){return Is(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=wt}){return vs(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Ge(this,this,e),this.check()}transformAsVector(e){return Ve(this,this,e),this.check()}transformByMatrix3(e){return Bs(this,this,e),this.check()}transformByMatrix2(e){return _s(this,this,e),this.check()}transformByQuaternion(e){return $s(this,this,e),this.check()}}class Ws extends De{toString(){let e="[";if(R.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=` ${this[r*this.RANK+n]}`}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=` ${this[n]}`}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=x(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)n[s]=this[r+s];return n}setColumn(e,n){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)this[r+s]=n[s];return this}}function Cs(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ds(t,e){if(t===e){const n=e[1],r=e[2],s=e[3],i=e[6],o=e[7],c=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=s,t[13]=o,t[14]=c}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function zs(t,e){const n=e[0],r=e[1],s=e[2],i=e[3],o=e[4],c=e[5],a=e[6],f=e[7],h=e[8],l=e[9],u=e[10],g=e[11],m=e[12],d=e[13],y=e[14],T=e[15],M=n*c-r*o,p=n*a-s*o,E=n*f-i*o,w=r*a-s*c,b=r*f-i*c,L=s*f-i*a,_=h*d-l*m,k=h*y-u*m,S=h*T-g*m,O=l*y-u*d,P=l*T-g*d,B=u*T-g*y;let A=M*B-p*P+E*O+w*S-b*k+L*_;return A?(A=1/A,t[0]=(c*B-a*P+f*O)*A,t[1]=(s*P-r*B-i*O)*A,t[2]=(d*L-y*b+T*w)*A,t[3]=(u*b-l*L-g*w)*A,t[4]=(a*S-o*B-f*k)*A,t[5]=(n*B-s*S+i*k)*A,t[6]=(y*E-m*L-T*p)*A,t[7]=(h*L-u*E+g*p)*A,t[8]=(o*P-c*S+f*_)*A,t[9]=(r*S-n*P-i*_)*A,t[10]=(m*b-d*E+T*M)*A,t[11]=(l*E-h*b-g*M)*A,t[12]=(c*k-o*O-a*_)*A,t[13]=(n*O-r*k+s*_)*A,t[14]=(d*p-m*w-y*M)*A,t[15]=(h*w-l*p+u*M)*A,t):null}function Vs(t){const e=t[0],n=t[1],r=t[2],s=t[3],i=t[4],o=t[5],c=t[6],a=t[7],f=t[8],h=t[9],l=t[10],u=t[11],g=t[12],m=t[13],d=t[14],y=t[15],T=e*o-n*i,M=e*c-r*i,p=n*c-r*o,E=f*m-h*g,w=f*d-l*g,b=h*d-l*m,L=e*b-n*w+r*E,_=i*b-o*w+c*E,k=f*p-h*M+l*T,S=g*p-m*M+d*T;return a*L-s*_+y*k-u*S}function he(t,e,n){const r=e[0],s=e[1],i=e[2],o=e[3],c=e[4],a=e[5],f=e[6],h=e[7],l=e[8],u=e[9],g=e[10],m=e[11],d=e[12],y=e[13],T=e[14],M=e[15];let p=n[0],E=n[1],w=n[2],b=n[3];return t[0]=p*r+E*c+w*l+b*d,t[1]=p*s+E*a+w*u+b*y,t[2]=p*i+E*f+w*g+b*T,t[3]=p*o+E*h+w*m+b*M,p=n[4],E=n[5],w=n[6],b=n[7],t[4]=p*r+E*c+w*l+b*d,t[5]=p*s+E*a+w*u+b*y,t[6]=p*i+E*f+w*g+b*T,t[7]=p*o+E*h+w*m+b*M,p=n[8],E=n[9],w=n[10],b=n[11],t[8]=p*r+E*c+w*l+b*d,t[9]=p*s+E*a+w*u+b*y,t[10]=p*i+E*f+w*g+b*T,t[11]=p*o+E*h+w*m+b*M,p=n[12],E=n[13],w=n[14],b=n[15],t[12]=p*r+E*c+w*l+b*d,t[13]=p*s+E*a+w*u+b*y,t[14]=p*i+E*f+w*g+b*T,t[15]=p*o+E*h+w*m+b*M,t}function kt(t,e,n){const r=n[0],s=n[1],i=n[2];let o,c,a,f,h,l,u,g,m,d,y,T;return e===t?(t[12]=e[0]*r+e[4]*s+e[8]*i+e[12],t[13]=e[1]*r+e[5]*s+e[9]*i+e[13],t[14]=e[2]*r+e[6]*s+e[10]*i+e[14],t[15]=e[3]*r+e[7]*s+e[11]*i+e[15]):(o=e[0],c=e[1],a=e[2],f=e[3],h=e[4],l=e[5],u=e[6],g=e[7],m=e[8],d=e[9],y=e[10],T=e[11],t[0]=o,t[1]=c,t[2]=a,t[3]=f,t[4]=h,t[5]=l,t[6]=u,t[7]=g,t[8]=m,t[9]=d,t[10]=y,t[11]=T,t[12]=o*r+h*s+m*i+e[12],t[13]=c*r+l*s+d*i+e[13],t[14]=a*r+u*s+y*i+e[14],t[15]=f*r+g*s+T*i+e[15]),t}function He(t,e,n){const r=n[0],s=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Gs(t,e,n,r){let s=r[0],i=r[1],o=r[2],c=Math.sqrt(s*s+i*i+o*o),a,f,h,l,u,g,m,d,y,T,M,p,E,w,b,L,_,k,S,O,P,B,A,Q;return c<it?null:(c=1/c,s*=c,i*=c,o*=c,f=Math.sin(n),a=Math.cos(n),h=1-a,l=e[0],u=e[1],g=e[2],m=e[3],d=e[4],y=e[5],T=e[6],M=e[7],p=e[8],E=e[9],w=e[10],b=e[11],L=s*s*h+a,_=i*s*h+o*f,k=o*s*h-i*f,S=s*i*h-o*f,O=i*i*h+a,P=o*i*h+s*f,B=s*o*h+i*f,A=i*o*h-s*f,Q=o*o*h+a,t[0]=l*L+d*_+p*k,t[1]=u*L+y*_+E*k,t[2]=g*L+T*_+w*k,t[3]=m*L+M*_+b*k,t[4]=l*S+d*O+p*P,t[5]=u*S+y*O+E*P,t[6]=g*S+T*O+w*P,t[7]=m*S+M*O+b*P,t[8]=l*B+d*A+p*Q,t[9]=u*B+y*A+E*Q,t[10]=g*B+T*A+w*Q,t[11]=m*B+M*A+b*Q,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function qe(t,e,n){const r=Math.sin(n),s=Math.cos(n),i=e[4],o=e[5],c=e[6],a=e[7],f=e[8],h=e[9],l=e[10],u=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*s+f*r,t[5]=o*s+h*r,t[6]=c*s+l*r,t[7]=a*s+u*r,t[8]=f*s-i*r,t[9]=h*s-o*r,t[10]=l*s-c*r,t[11]=u*s-a*r,t}function js(t,e,n){const r=Math.sin(n),s=Math.cos(n),i=e[0],o=e[1],c=e[2],a=e[3],f=e[8],h=e[9],l=e[10],u=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s-f*r,t[1]=o*s-h*r,t[2]=c*s-l*r,t[3]=a*s-u*r,t[8]=i*r+f*s,t[9]=o*r+h*s,t[10]=c*r+l*s,t[11]=a*r+u*s,t}function Ye(t,e,n){const r=Math.sin(n),s=Math.cos(n),i=e[0],o=e[1],c=e[2],a=e[3],f=e[4],h=e[5],l=e[6],u=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s+f*r,t[1]=o*s+h*r,t[2]=c*s+l*r,t[3]=a*s+u*r,t[4]=f*s-i*r,t[5]=h*s-o*r,t[6]=l*s-c*r,t[7]=u*s-a*r,t}function Hs(t,e){const n=e[0],r=e[1],s=e[2],i=e[3],o=n+n,c=r+r,a=s+s,f=n*o,h=r*o,l=r*c,u=s*o,g=s*c,m=s*a,d=i*o,y=i*c,T=i*a;return t[0]=1-l-m,t[1]=h+T,t[2]=u-y,t[3]=0,t[4]=h-T,t[5]=1-f-m,t[6]=g+d,t[7]=0,t[8]=u+y,t[9]=g-d,t[10]=1-f-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function qs(t,e,n,r,s,i,o){const c=1/(n-e),a=1/(s-r),f=1/(i-o);return t[0]=i*2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i*2*a,t[6]=0,t[7]=0,t[8]=(n+e)*c,t[9]=(s+r)*a,t[10]=(o+i)*f,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*f,t[15]=0,t}function Ys(t,e,n,r,s){const i=1/Math.tan(e/2);if(t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0){const o=1/(r-s);t[10]=(s+r)*o,t[14]=2*s*r*o}else t[10]=-1,t[14]=-2*r;return t}const Qs=Ys;function Ks(t,e,n,r,s,i,o){const c=1/(e-n),a=1/(r-s),f=1/(i-o);return t[0]=-2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*f,t[11]=0,t[12]=(e+n)*c,t[13]=(s+r)*a,t[14]=(o+i)*f,t[15]=1,t}const Zs=Ks;function Js(t,e,n,r){let s,i,o,c,a,f,h,l,u,g;const m=e[0],d=e[1],y=e[2],T=r[0],M=r[1],p=r[2],E=n[0],w=n[1],b=n[2];return Math.abs(m-E)<it&&Math.abs(d-w)<it&&Math.abs(y-b)<it?Cs(t):(l=m-E,u=d-w,g=y-b,s=1/Math.sqrt(l*l+u*u+g*g),l*=s,u*=s,g*=s,i=M*g-p*u,o=p*l-T*g,c=T*u-M*l,s=Math.sqrt(i*i+o*o+c*c),s?(s=1/s,i*=s,o*=s,c*=s):(i=0,o=0,c=0),a=u*c-g*o,f=g*i-l*c,h=l*o-u*i,s=Math.sqrt(a*a+f*f+h*h),s?(s=1/s,a*=s,f*=s,h*=s):(a=0,f=0,h=0),t[0]=i,t[1]=a,t[2]=l,t[3]=0,t[4]=o,t[5]=f,t[6]=u,t[7]=0,t[8]=c,t[9]=h,t[10]=g,t[11]=0,t[12]=-(i*m+o*d+c*y),t[13]=-(a*m+f*d+h*y),t[14]=-(l*m+u*d+g*y),t[15]=1,t)}function Xs(){const t=new q(4);return q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function ti(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Qe(t,e,n){const r=e[0],s=e[1],i=e[2],o=e[3];return t[0]=n[0]*r+n[4]*s+n[8]*i+n[12]*o,t[1]=n[1]*r+n[5]*s+n[9]*i+n[13]*o,t[2]=n[2]*r+n[6]*s+n[10]*i+n[14]*o,t[3]=n[3]*r+n[7]*s+n[11]*i+n[15]*o,t}(function(){const t=Xs();return function(e,n,r,s,i,o){let c,a;for(n||(n=4),r||(r=0),s?a=Math.min(s*n+r,e.length):a=e.length,c=r;c<a;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],t[3]=e[c+3],i(t,t,o),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2],e[c+3]=t[3];return e}})();var St;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(St||(St={}));const ei=45*Math.PI/180,ni=1,bt=.1,Et=500,ri=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Ke extends Ws{static get IDENTITY(){return ii()}static get ZERO(){return si()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return St}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,s,i,o,c,a,f,h,l,u,g,m,d,y){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this[4]=i,this[5]=o,this[6]=c,this[7]=a,this[8]=f,this[9]=h,this[10]=l,this[11]=u,this[12]=g,this[13]=m,this[14]=d,this[15]=y,this.check()}setRowMajor(e,n,r,s,i,o,c,a,f,h,l,u,g,m,d,y){return this[0]=e,this[1]=i,this[2]=f,this[3]=g,this[4]=n,this[5]=o,this[6]=h,this[7]=m,this[8]=r,this[9]=c,this[10]=l,this[11]=d,this[12]=s,this[13]=a,this[14]=u,this[15]=y,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(ri)}fromObject(e){return this.check()}fromQuaternion(e){return Hs(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:s,top:i,near:o=bt,far:c=Et}=e;return c===1/0?oi(this,n,r,s,i,o):qs(this,n,r,s,i,o,c),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:s=[0,1,0]}=e;return Js(this,n,r,s),this.check()}ortho(e){const{left:n,right:r,bottom:s,top:i,near:o=bt,far:c=Et}=e;return Zs(this,n,r,s,i,o,c),this.check()}orthographic(e){const{fovy:n=ei,aspect:r=ni,focalDistance:s=1,near:i=bt,far:o=Et}=e;le(n);const c=n/2,a=s*Math.tan(c),f=a*r;return this.ortho({left:-f,right:f,bottom:-a,top:a,near:i,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:s=.1,far:i=500}=e;return le(n),Qs(this,n,r,s,i),this.check()}determinant(){return Vs(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),s=1/r[0],i=1/r[1],o=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*i,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*s,e[5]=this[5]*i,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*s,e[9]=this[9]*i,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),s=1/r[0],i=1/r[1],o=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*i,e[2]=this[2]*o,e[3]=this[4]*s,e[4]=this[5]*i,e[5]=this[6]*o,e[6]=this[8]*s,e[7]=this[9]*i,e[8]=this[10]*o,e}transpose(){return Ds(this,this),this.check()}invert(){return zs(this,this),this.check()}multiplyLeft(e){return he(this,e,this),this.check()}multiplyRight(e){return he(this,this,e),this.check()}rotateX(e){return qe(this,this,e),this.check()}rotateY(e){return js(this,this,e),this.check()}rotateZ(e){return Ye(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return Gs(this,this,e,n),this.check()}scale(e){return He(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return kt(this,this,e),this.check()}transform(e,n){return e.length===4?(n=Qe(n||[-0,-0,-0,-0],e,this),pt(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let s;switch(r){case 2:s=As(n||[-0,-0],e,this);break;case 3:s=Ge(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return pt(s,e.length),s}transformAsVector(e,n){let r;switch(e.length){case 2:r=Ls(n||[-0,-0],e,this);break;case 3:r=Ve(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return pt(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let nt,rt;function si(){return nt||(nt=new Ke([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(nt)),nt}function ii(){return rt||(rt=new Ke,Object.freeze(rt)),rt}function le(t){if(t>Math.PI*2)throw Error("expected radians")}function oi(t,e,n,r,s,i){const o=2*i/(n-e),c=2*i/(s-r),a=(n+e)/(n-e),f=(s+r)/(s-r),h=-1,l=-1,u=-2*i;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=a,t[9]=f,t[10]=h,t[11]=l,t[12]=0,t[13]=0,t[14]=u,t[15]=0,t}function ci(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function j(t,e){const n=Qe([],e,t);return ti(n,n,1/n[3]),n}function ue(t,e){const n=t%e;return n<0?e+n:n}function xt(t,e,n){return t<e?e:t>n?n:t}function ai(t){return Math.log(t)*Math.LOG2E}const Wt=Math.log2||ai;function I(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const $=Math.PI,Ze=$/4,N=$/180,Rt=180/$,Y=512,ft=4003e4,st=85.051129,fi=1.5;function hi(t){return Wt(t)}function Nt(t){const[e,n]=t;I(Number.isFinite(e)),I(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*N,s=n*N,i=Y*(r+$)/(2*$),o=Y*($+Math.log(Math.tan(Ze+s*.5)))/(2*$);return[i,o]}function J(t){const[e,n]=t,r=e/Y*(2*$)-$,s=2*(Math.atan(Math.exp(n/Y*(2*$)-$))-Ze);return[r*Rt,s*Rt]}function xi(t){const{latitude:e}=t;I(Number.isFinite(e));const n=Math.cos(e*N);return hi(ft*n)-9}function Ri(t){const e=Math.cos(t*N);return Y/ft/e}function li(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;I(Number.isFinite(e)&&Number.isFinite(n));const s=Y,i=Math.cos(e*N),o=s/360,c=o/i,a=s/ft/i,f={unitsPerMeter:[a,a,a],metersPerUnit:[1/a,1/a,1/a],unitsPerDegree:[o,c,a],degreesPerUnit:[1/o,1/c,1/a]};if(r){const h=N*Math.tan(e*N)/i,l=o*h/2,u=s/ft*h,g=u/c*a;f.unitsPerDegree2=[0,l,u],f.unitsPerMeter2=[g,0,g]}return f}function Ni(t,e){const[n,r,s]=t,[i,o,c]=e,{unitsPerMeter:a,unitsPerMeter2:f}=li({longitude:n,latitude:r,highPrecision:!0}),h=Nt(t);h[0]+=i*(a[0]+f[0]*o),h[1]+=o*(a[1]+f[1]*o);const l=J(h),u=(s||0)+(c||0);return Number.isFinite(s)||Number.isFinite(c)?[l[0],l[1],u]:l}function Oi(t){const{height:e,pitch:n,bearing:r,altitude:s,scale:i,center:o}=t,c=ci();kt(c,c,[0,0,-s]),qe(c,c,-n*N),Ye(c,c,r*N);const a=i/e;return He(c,c,[a,a,a]),o&&kt(c,c,Ns([],o)),c}function Pi(t){const{width:e,height:n,altitude:r,pitch:s=0,offset:i,center:o,scale:c,nearZMultiplier:a=1,farZMultiplier:f=1}=t;let{fovy:h=ge(fi)}=t;r!==void 0&&(h=ge(r));const l=h*N,u=s*N,g=ui(h);let m=g;o&&(m+=o[2]*c/Math.cos(u)/n);const d=l*(.5+(i?i[1]:0)/n),y=Math.sin(d)*m/Math.sin(xt(Math.PI/2-u-d,.01,Math.PI-.01)),T=Math.sin(u)*y+m,M=m*10,p=Math.min(T*f,M);return{fov:l,aspect:e/n,focalDistance:g,near:a,far:p}}function ge(t){return 2*Math.atan(.5/t)*Rt}function ui(t){return .5/Math.tan(.5*t*N)}function Bi(t,e){const[n,r,s=0]=t;return I(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(s)),j(e,[n,r,s,1])}function $i(t,e,n=0){const[r,s,i]=t;if(I(Number.isFinite(r)&&Number.isFinite(s),"invalid pixel coordinate"),Number.isFinite(i))return j(e,[r,s,i,1]);const o=j(e,[r,s,0,1]),c=j(e,[r,s,1,1]),a=o[2],f=c[2],h=a===f?0:((n||0)-a)/(f-a);return ze([],o,c,h)}function Ui(t){const{width:e,height:n,bounds:r,minExtent:s=0,maxZoom:i=24,offset:o=[0,0]}=t,[[c,a],[f,h]]=r,l=gi(t.padding),u=Nt([c,xt(h,-st,st)]),g=Nt([f,xt(a,-st,st)]),m=[Math.max(Math.abs(g[0]-u[0]),s),Math.max(Math.abs(g[1]-u[1]),s)],d=[e-l.left-l.right-Math.abs(o[0])*2,n-l.top-l.bottom-Math.abs(o[1])*2];I(d[0]>0&&d[1]>0);const y=d[0]/m[0],T=d[1]/m[1],M=(l.right-l.left)/2/y,p=(l.top-l.bottom)/2/T,E=[(g[0]+u[0])/2+M,(g[1]+u[1])/2+p],w=J(E),b=Math.min(i,Wt(Math.abs(Math.min(y,T))));return I(Number.isFinite(b)),{longitude:w[0],latitude:w[1],zoom:b}}function gi(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(I(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const me=Math.PI/180;function Ii(t,e=0){const{width:n,height:r,unproject:s}=t,i={targetZ:e},o=s([0,r],i),c=s([n,r],i);let a,f;const h=t.fovy?.5*t.fovy*me:Math.atan(.5/t.altitude),l=(90-t.pitch)*me;return h>l-.01?(a=de(t,0,e),f=de(t,n,e)):(a=s([0,0],i),f=s([n,0],i)),[o,c,f,a]}function de(t,e,n){const{pixelUnprojectionMatrix:r}=t,s=j(r,[e,0,1,1]),i=j(r,[e,t.height,1,1]),c=(n*t.distanceScales.unitsPerMeter[2]-s[2])/(i[2]-s[2]),a=ze([],s,i,c),f=J(a);return f.push(n),f}const ye=512;function vi(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:s,latitude:i,zoom:o,bearing:c=0}=t;(s<-180||s>180)&&(s=ue(s+180,360)-180),(c<-180||c>180)&&(c=ue(c+180,360)-180);const a=Wt(n/ye);if(o<=a)o=a,i=0;else{const f=n/2/Math.pow(2,o),h=J([0,f])[1];if(i<h)i=h;else{const l=J([0,ye-f])[1];i>l&&(i=l)}}return{width:e,height:n,longitude:s,latitude:i,zoom:o,pitch:r,bearing:c}}function mi(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function di(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":!1}function Fi(t){return mi(t)||di(t)}export{ys as A,vi as B,st as C,Si as D,Li as E,ki as F,ti as G,ht as H,Ei as I,Fi as J,yi as K,Bt as L,Ke as M,pi as S,je as V,J as a,xi as b,Ti as c,kt as d,Ce as e,ui as f,li as g,Pi as h,zs as i,Oi as j,Ni as k,Nt as l,he as m,Mi as n,Ai as o,$i as p,Ii as q,wi as r,He as s,Qe as t,Ri as u,Ui as v,Bi as w,ge as x,_i as y,bi as z};
//# sourceMappingURL=DAFR70n4.js.map
